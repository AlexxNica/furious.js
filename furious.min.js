!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.furious=e()}}(function(){var e;return function f(e,o,n){function d(t,u){if(!o[t]){if(!e[t]){var l="function"==typeof require&&require;if(!u&&l)return l(t,!0);if(i)return i(t,!0);throw new Error("Cannot find module '"+t+"'")}var p=o[t]={exports:{}};e[t][0].call(p.exports,function(f){var o=e[t][1][f];return d(o?o:f)},p,p.exports,f,e,o,n)}return o[t].exports}for(var i="function"==typeof require&&require,t=0;t<n.length;t++)d(n[t]);return d}({1:[function(e,f){"use strict";function o(e){if(!(["f32","f64"].indexOf(e)>=0))throw new RangeError("Type "+e+" is not supported");this.type=e,this.size={f32:4,f64:8}[e],this.epsilon={f32:1.1920928955078125e-7,f64:2.220446049250313e-16}[e],this.arrayType={f32:Float32Array,f64:Float64Array}[e]}o.prototype.equals=function(e){return e instanceof o&&this.arrayType===e.arrayType},f.exports=o},{}],2:[function(e,f){"use strict";function o(e,f,o){if("undefined"==typeof o)throw new Error("Context not defined");if(!n.isPositiveIntArray(e)&&!n.isPositiveInt(e))throw new TypeError(e+" is not a valid array shape");if("undefined"==typeof f)f=new d("f64");else if(!(f instanceof d))throw new TypeError(f+" is not an instance of DataType");this.shape=e,this.dataType=f,this._context=o,this.length=n.computeLength(this.shape),this._lockCount=0,this._refCount=1,this._isValid=!0}var n=e("./util"),d=e("./DataType");o.prototype.lock=function(){if(!this.isValid())throw new Error("Attempted to lock an invalidated array");return this._lockCount++,this},o.prototype.unlock=function(){if(!this.isLocked())throw new Error("Attempted to lock a unlocked array");return this._lockCount--,this},o.prototype.isLocked=function(){return this._lockCount>0},o.prototype.retain=function(){if(!this.isValid())throw new Error("Attempted to release an invalidated array");if(this.isLocked())throw new Error("Attempted to retain a locked array");return this._refCount++,this},o.prototype.release=function(){if(!this.isValid())throw new Error("Attempted to release an invalidated array");if(this.isLocked())throw new Error("Attempted to release a locked array");return 0===--this._refCount&&this._context._invalidate(this),this},o.prototype.tryRelease=function(){if(!this.isValid())throw new Error("Attempted to release an invalidated array");return this.isLocked()||0===--this._refCount&&this._context._invalidate(this),this},o.prototype._tryRelease=function(){return this.isLocked()||0===--this._refCount&&this._context._invalidate(this),this},o.prototype.invalidate=function(){return this.isValid()&&(this._context._invalidate(this),this._isValid=!1,this._refCount=0,this._lockCount=0),this},o.prototype.isValid=function(){return this._isValid},o.prototype._decRef=function(){return 0===this._lockCount&&--this._refCount,0!==this._refCount},o.prototype._incRef=function(){return 0===this._lockCount&&++this._refCount,this},o.prototype._hasRefs=function(){return 0!==this._lockCount||0!==this._refCount},o.prototype._tryInvalidate=function(){return this.isValid()&&!this._hasRefs()?(this._context._invalidate(this),this._isValid=!1,!0):!1},o.prototype.add=function(e){return this._context.add(this,e)},o.prototype.sub=function(e){return this._context.sub(this,e)},o.prototype.mul=function(e){return this._context.mul(this,e)},o.prototype.div=function(e){return this._context.div(this,e)},o.prototype.min=function(e){return this._context.min(this,e)},o.prototype.max=function(e){return this._context.max(this,e)},o.prototype.sum=function(e){return this._context.sum(this,e)},o.prototype.reshape=function(e){return this._context.reshape(this,e)},o.prototype.repeat=function(e,f){return this._context.repeat(this,e,f)},o.prototype.get=function(e){this._context.get(this,e)},f.exports=o},{"./DataType":1,"./util":12}],3:[function(e,f){"use strict";function o(e,f,o){var n=this;this._postMessage=f,this._callbacks={},this._callbacks[0]=function(e){o(n,e)}}var n=e("./NDArray"),d=e("./DataType"),i=e("./allocator"),t=e("./util"),u=e("./requests.pb"),l=u.Request,p=u.EmptyArrayRequest,s=u.DataArrayRequest,y=u.ConstArrayRequest,c=u.LinspaceRequest,r=u.ReshapeRequest,a=u.RepeatRequest,w=u.DeallocateRequest,b=u.FetchRequest,m=u.BinaryOperationRequest,g=u.BinaryConstOperationRequest,x=u.UnaryOperationRequest,j=u.ReductionRequest,v=u.AxisReductionRequest,h=u.DotOperationRequest,k=u.CholeskyDecompositionRequest,q=u.SolveTriangularRequest,z=e("./responses.pb").Response,A={f32:u.DataType.FLOAT32,f64:u.DataType.FLOAT64};o.prototype._onMessage=function(e){var f=z.decode(e.data),o=f.id,n=this._callbacks[o];switch(delete this._callbacks[o],f.type){case z.Type.INIT:var d={},i=f.initResponse;null!==i.concurrency&&(d.concurrency=i.concurrency),n(d);break;case z.Type.BARRIER:n();break;case z.Type.FETCH:n(f.fetchResponse.dataBuffer.toArrayBuffer());break;case z.Type.ERROR:break;case z.Type.INFO:}},o.prototype.empty=function(e,f){if(e=t.checkShape(e),"undefined"==typeof f)f=new d("f64");else if(!(f instanceof d))throw new TypeError(f+" is not an instance of DataType");var o=new n(e,f,this);o._id=i.newArrayId();var u=new l;u.id=i.newMessageId(),u.type=l.Type.EMPTY_ARRAY;var s=new p;return s.idOut=o._id,s.shape=e,s.dataType=A[f.type],u.emptyArrayRequest=s,this._postMessage(u.encodeAB()),o},o.prototype.zeros=function(e,f){if(e=t.checkShape(e),"undefined"==typeof f)f=new d("f64");else if(!(f instanceof d))throw new TypeError(f+" is not an instance of DataType");var o=new n(e,f,this);o._id=i.newArrayId();var u=new l;u.id=i.newMessageId(),u.type=l.Type.CONST_ARRAY;var p=new y;return p.idOut=o._id,p.shape=e,p.dataType=A[f.type],p.fillValue=0,u.constArrayRequest=p,this._postMessage(u.encodeAB()),o},o.prototype.ones=function(e,f){if(e=t.checkShape(e),"undefined"==typeof f)f=new d("f64");else if(!(f instanceof d))throw new TypeError(f+" is not an instance of DataType");var o=new n(e,f,this);o._id=i.newArrayId();var u=new l;u.id=i.newMessageId(),u.type=l.Type.CONST_ARRAY;var p=new y;return p.idOut=o._id,p.shape=e,p.dataType=A[f.type],p.fillValue=1,u.constArrayRequest=p,this._postMessage(u.encodeAB()),o},o.prototype.array=function(e,f){var o=[];if(t.discoverArrayShapeRecursive(e,o,0),"undefined"==typeof f)f=new d("f64");else if(!(f instanceof d))throw new TypeError(f+" is not an instance of DataType");var u=new n(o,f,this);u._id=i.newArrayId();var p=new f.arrayType(u.length);t.copyArrayDataRecursive(p,e,o,0,0);var y=new l;y.id=i.newMessageId(),y.type=l.Type.DATA_ARRAY;var c=new s;return c.idOut=u._id,c.shape=o,c.dataType=A[f.type],c.dataBuffer=p.buffer,y.dataArrayRequest=c,this._postMessage(y.encodeAB()),u},o.prototype.linspace=function(e,f,o,u){if(!t.isReal(e))throw new TypeError(e+" is not a real number");if(!t.isReal(f))throw new TypeError(f+" is not a real number");if("undefined"==typeof o)o=50;else{if(!t.isInt(o))throw new TypeError(o+" is not an integer");if(0>=o)throw new RangeError("The number of samples must be positive")}if("undefined"==typeof u&&(u=!0),u&&1===o)throw new RangeError("The number of samples must be a least 2 (for start and end points)");var p=new d("f64"),s=new n([o],p,this);s._id=i.newArrayId();var y=new l;y.id=i.newMessageId(),y.type=l.Type.LINSPACE;var r=new c;return r.idOut=s._id,r.start=e,r.stop=f,r.samples=o,r.closed=u,r.dataType=A[p.type],y.linspaceRequest=r,this._postMessage(y.encodeAB()),s},o.prototype.reshape=function(e,f){if(t.checkNDArray(e,"a"),f=t.checkShape(f),t.computeLength(f)!==e.length)throw new RangeError("The shape is not compatible with the array");var o=e._id,d=!e._decRef(),u=new n(f,e.dataType,this);d?(u._id=o,e._id=0,d=!1):u._id=i.newArrayId();var p=new l;p.id=i.newMessageId(),p.type=l.Type.RESHAPE;var s=new r;return s.idA=o,s.idOut=u._id,s.shapeOut=f,p.reshapeRequest=s,this._postMessage(p.encodeAB()),e._tryInvalidate(),u},o.prototype.repeat=function(e,f,o,d){t.checkNDArray(e,"a"),f=t.checkRepeats(f),o=t.checkAxis(o,e.shape.length);var u=e.shape,p=u.slice(0);p[o]*=f,"undefined"==typeof d?(d=new n(p,e.dataType,this),d._id=i.newArrayId()):(t.checkNDArray(d,"out"),t.checkShapesCompatibility(d.shape,p),t.checkDataTypesCompatibility(e.dataType,d.dataType),d._incRef());var s=e._id;e._decRef()||(s=-s,e._id=0);var y=new l;y.id=i.newMessageId(),y.type=l.Type.REPEAT;var c=new a;return c.idA=s,c.idOut=d._id,c.axis=o,c.repeats=f,y.repeatRequest=c,this._postMessage(y.encodeAB()),e._tryInvalidate(),d},o.prototype._invalidate=function(e){if(0!==e._id){var f=new l;f.id=i.newMessageId(),f.type=l.Type.DEALLOCATE;var o=new w;o.idA=e._id,f.deallocateRequest=o,this._postMessage(f.encodeAB())}},o.prototype.fetch=function(){if(0===arguments.length)throw new Error("Callback argument missing");var e=arguments[arguments.length-1];if(1===arguments.length)throw new Error("At least one NDArray argument expected");for(var f=0;f<arguments.length-1;++f)t.checkNDArray(arguments[f],"argument "+f);for(var o=new Array(arguments.length-1),f=0;f<arguments.length-1;++f)o[f]=!arguments[f]._decRef();for(var n=arguments.length-1,d=new Array(n),f=0;n>f;f++){var u=arguments[f],p=i.newMessageId();this._callbacks[p]=function(f,o){return function(i){d[f]=new o(i),0===--n&&e.apply(null,d)}}(f,u.dataType.arrayType);var s=u._id;o[f]&&(u._id=0,s=-s,u._tryInvalidate());var y=new l;y.id=p,y.type=l.Type.FETCH;var c=new b;c.idA=s,y.fetchRequest=c,this._postMessage(y.encodeAB())}},o.prototype.get=function(){if(0===arguments.length)throw new Error("Callback argument missing");var e=arguments[arguments.length-1];if(1===arguments.length)throw new Error("At least one NDArray argument expected");for(var f=0;f<arguments.length-1;++f)t.checkNDArray(arguments[f],"argument "+f);for(var o=new Array(arguments.length-1),f=0;f<arguments.length-1;++f)o[f]=!arguments[f]._decRef();for(var n=arguments.length-1,d=new Array(n),f=0;n>f;f++){var u=arguments[f],p=i.newMessageId();this._callbacks[p]=0===u.shape.length?function(f,o){return function(i){var t=new o(i);d[f]=t[0],0===--n&&e.apply(null,d)}}(f,u.dataType.arrayType):function(f,o,i){return function(u){var l=new Array(i[0]);t.createArrayRecursive(new o(u),l,i,0,0),d[f]=l,0===--n&&e.apply(null,d)}}(f,u.dataType.arrayType,u.shape);var s=u._id;o[f]&&(u._id=0,s=-s,u._tryInvalidate());var y=new l;y.id=p,y.type=l.Type.FETCH;var c=new b;c.idA=s,y.fetchRequest=c,this._postMessage(y.encodeAB())}},o.prototype.info=function(){throw new Error("Not implemented")},o.prototype.barrier=function(e){var f=i.newMessageId();this._callbacks[f]=e;var o=new l;o.id=f,o.type=l.Type.BARRIER,this._postMessage(o.encodeAB())};var B=function(e,f,o,d,u,p,s){var y=null,c=null,r=!1,a=!1,w=0,b=0;if(e instanceof n){if(w=e._id,y=e.shape,c=e.dataType,f instanceof n)b=f._id,t.checkShapesCompatibility(e.shape,f.shape),t.checkDataTypesCompatibility(e.dataType,f.dataType);else if(!t.isNumber(f))throw new TypeError("Unsupported type of b")}else{if(!t.isNumber(e))throw new TypeError("Unsupported type of a");b=f._id,y=f.shape,c=f.dataType,t.checkNDArray(f,"b")}0!==w&&(r=!e._decRef(),r&&(e._id=0)),0!==b&&(a=!f._decRef(),a&&(f._id=0));try{"undefined"==typeof o?(o=new n(y,c,d),r?(o._id=w,r=!1):a?(o._id=b,a=!1):o._id=i.newArrayId()):(t.checkNDArray(o,"out"),t.checkShapesCompatibility(y,o.shape),t.checkDataTypesCompatibility(c,o.dataType),o._incRef());var x=new l;if(x.id=i.newMessageId(),0!==w)if(0!==b){x.type=l.Type.BINARY_OPERATION;var j=new m;j.type=u,j.idA=r?-w:w,j.idB=a?-b:b,j.idOut=o._id,x.binaryOperationRequest=j,d._postMessage(x.encodeAB())}else{x.type=l.Type.BINARY_CONST_OPERATION;var v=new g;v.type=p,v.idA=r?-w:w,v.valueB=f,v.idOut=o._id,x.binaryConstOperationRequest=v,d._postMessage(x.encodeAB())}else{x.type=l.Type.BINARY_CONST_OPERATION;var v=new g;v.type=s,v.idA=a?-b:b,v.valueB=e,v.idOut=o._id,x.binaryConstOperationRequest=v,d._postMessage(x.encodeAB())}}catch(h){throw 0!==w&&(e._id=w,e._incRef()),0!==b&&(f._id=b,f._incRef()),h}return 0!==w&&e._tryInvalidate(),0!==b&&f._tryInvalidate(),o},C=function(e,f,o,d){t.checkNDArray(e,"a");var u=e._id,p=!e._decRef();p&&(e._id=0);try{"undefined"==typeof f?(f=new n(e.shape,e.dataType,o),p?(f._id=u,p=!1):f._id=i.newArrayId()):(t.checkNDArray(f,"out"),t.checkShapesCompatibility(e.shape,f.shape),t.checkDataTypesCompatibility(e.dataType,f.dataType),f._incRef())}catch(s){throw e._id=u,e._incRef(),s}var y=new l;y.id=i.newMessageId(),y.type=l.Type.UNARY_OPERATION;var c=new x;return c.type=d,c.idA=p?-u:u,c.idOut=f._id,y.unaryOperationRequest=c,o._postMessage(y.encodeAB()),e._tryInvalidate(),f},D=function(e,f,o,d){t.checkNDArray(e,"a");var u=e._id,p=!e._decRef();p&&(e._id=0);try{"undefined"==typeof f?(f=new n([],e.dataType,o),f._id=i.newArrayId()):(t.checkNDArray(f,"out"),t.checkShapesCompatibility(f.shape,[]),t.checkDataTypesCompatibility(e.dataType,f.dataType),f._incRef())}catch(s){throw e._id=u,e._incRef(),s}var y=new l;y.id=i.newMessageId(),y.type=l.Type.REDUCTION_OPERATION;var c=new j;return c.type=d,c.idA=p?-u:u,c.idOut=f._id,y.reductionRequest=c,o._postMessage(y.encodeAB()),e._tryInvalidate(),f},E=function(e,f,o,d,u){t.checkNDArray(e,"a");var p=e._id,s=!e._decRef();s&&(e._id=0);try{t.checkAxis(f),"undefined"==typeof o?(o=new n(t.computeAxisReductionOutShape(e.shape,f),e.dataType,d),o._id=i.newArrayId()):(t.checkNDArray(o,"out"),t.checkShapesCompatibility(o.shape,[]),t.checkDataTypesCompatibility(e.dataType,o.dataType),o._incRef())}catch(y){throw e._id=p,e._incRef(),y}var c=new l;c.id=i.newMessageId(),c.type=l.Type.AXIS_REDUCTION_OPERATION;var r=new v;return r.type=u,r.idA=s?-p:p,r.axis=f,r.idOut=o._id,c.axisReductionRequest=r,d._postMessage(c.encodeAB()),e._tryInvalidate(),o},F=function(e,f,o,d){t.checkNDArray(e,"a"),t.checkNDArray(f,"b"),t.checkDataTypesCompatibility(e.dataType,f.dataType);var u=e._id,p=!e._decRef();p&&(e._id=0);var s=f._id,y=!f._decRef();y&&(f._id=0);try{if("undefined"==typeof o){var c=e.shape,r=f.shape,a=Math.max(c.length-1,0),w=Math.max(r.length-2,0);if(c[a]!=r[w])throw new TypeError("Mismatch in reduction dimensions");for(var b=[],m=0;a>m;m++)b.push(c[m]);if(r.length>1){for(var m=0;w>m;m++)b.push(r[m]);b.push(r[r.length-1])}o=new n(b,e.dataType,d),o._id=i.newArrayId()}else if(o instanceof n)throw t.checkNDArray(o,"out"),t.checkDataTypesCompatibility(e.dataType,o.dataType),new Error("Not implemented")}catch(g){throw e._id=u,e._incRef(),f._id=s,f._incRef(),g}var x=new l;x.id=i.newMessageId(),x.type=l.Type.DOT_OPERATION;var j=new h;return j.idA=p?-u:u,j.idB=y?-s:s,j.idOut=o._id,x.dotOperationRequest=j,d._postMessage(x.encodeAB()),e._tryInvalidate(),f._tryInvalidate(),o};o.prototype.add=function(e,f,o){return B(e,f,o,this,m.Type.ADD,g.Type.ADDC,g.Type.ADDC)},o.prototype.sub=function(e,f,o){return B(e,f,o,this,m.Type.SUB,g.Type.SUBC,g.Type.SUBRC)},o.prototype.mul=function(e,f,o){return B(e,f,o,this,m.Type.MUL,g.Type.MULC,g.Type.MULC)},o.prototype.div=function(e,f,o){return B(e,f,o,this,m.Type.DIV,g.Type.DIVC,g.Type.DIVRC)},o.prototype.neg=function(e,f){return C(e,f,this,x.Type.NEG)},o.prototype.abs=function(e,f){return C(e,f,this,x.Type.ABS)},o.prototype.exp=function(e,f){return C(e,f,this,x.Type.EXP)},o.prototype.log=function(e,f){return C(e,f,this,x.Type.LOG)},o.prototype.sqrt=function(e,f){return C(e,f,this,x.Type.SQRT)},o.prototype.square=function(e,f){return C(e,f,this,x.Type.SQUARE)},o.prototype.min=function(e,f){if("undefined"==typeof f)return D(e,void 0,this,j.Type.MIN);if(t.isInt(f))return E(e,f,void 0,this,v.Type.MIN);throw new TypeError("Unsupported axis type")},o.prototype.max=function(e,f){if("undefined"==typeof f)return D(e,void 0,this,j.Type.MAX);if(t.isInt(f))return E(e,f,void 0,this,v.Type.MAX);throw new TypeError("Unsupported axis type")},o.prototype.sum=function(e,f){if("undefined"==typeof f)return D(e,void 0,this,j.Type.SUM);if(t.isInt(f))return E(e,f,void 0,this,v.Type.SUM);throw new TypeError("Unsupported axis type")},o.prototype.dot=function(e,f,o){return F(e,f,o,this)},o.prototype.solveTriangular=function(e,f,o,d,p,s){if(t.checkSquare2DArray(e,"a"),t.checkNDArray(f,"b"),t.checkDataTypesCompatibility(e.dataType,f.dataType),1!==f.shape.length&&2!==f.shape.length)throw new Error("The right-hand must be a 1D or 2D array");if(e.shape[0]!=f.shape[0])throw new Error("The arrays have incompatible shapes");d=t.checkTransposeKind(d,"N"),o=t.checkTriangularKind(o,"U"),p="undefined"==typeof p?!1:!!p;var y=e._id,c=f._id,r=!e._decRef();r&&(e._id=0);var a=!f._decRef();a&&(f._id=0);try{"undefined"==typeof s?(s=new n(f.shape,f.dataType,this),a?(s._id=c,a=!1):s._id=i.newArrayId()):(t.checkNDArray(s,"out"),t.checkShapesCompatibility(f.shape,s.shape),t.checkDataTypesCompatibility(f.dataType,s.dataType),s._incRef())}catch(w){throw e._incRef(),f._incRef(),w}var b=new l;b.id=i.newMessageId(),b.type=l.Type.SOLVE_TRIANGULAR;var m=new q;return m.idA=r?-y:y,m.aType={U:u.TriangularMatrixType.UPPER,L:u.TriangularMatrixType.LOWER}[o],m.aTransposition={N:u.TranspositionType.NORMAL,T:u.TranspositionType.TRANSPOSE}[d],m.unitDiagonal=p,m.idY=a?-c:c,m.idX=s._id,b.solveTriangularRequest=m,this._postMessage(b.encodeAB()),e._tryInvalidate(),f._tryInvalidate(),s},o.prototype.cholesky=function(e,f,o){t.checkSquare2DArray(e,"a"),f=t.checkTriangularKind(f,"U");var d=e._id,p=!e._decRef();p&&(e._id=0);try{"undefined"==typeof o?(o=new n(e.shape,e.dataType,this),p?(o._id=d,p=!1):o._id=i.newArrayId()):(t.checkSquare2DArray(o,"out"),t.checkShapesCompatibility(o.shape,e.shape),t.checkDataTypesCompatibility(o.dataType,e.dataType),o._incRef())}catch(s){throw e._incRef(),s}var y=new l;y.id=i.newMessageId(),y.type=l.Type.CHOLESKY_DECOMPOSITION;var c=new k;return c.idA=p?-d:d,c.aType={U:u.TriangularMatrixType.UPPER,L:u.TriangularMatrixType.LOWER}[f],c.idOut=o._id,y.choleskyDecompositionRequest=c,this._postMessage(y.encodeAB()),e._tryInvalidate(),o},f.exports=o},{"./DataType":1,"./NDArray":2,"./allocator":5,"./requests.pb":10,"./responses.pb":11,"./util":12}],4:[function(e,f){"use strict";function o(e,f){var d=this;this._pnaclObject=document.createElement("object"),this._pnaclObject.width=0,this._pnaclObject.height=0,this._pnaclObject.data=o.getManifestURL(e.baseUrl),this._pnaclObject.type="application/x-pnacl",this._pnaclObject.addEventListener("message",function(e){d._messagingContext._onMessage(e)},!0),this._messagingContext=new n(e,function(e){d._pnaclObject.postMessage(e)},f),document.body.appendChild(this._pnaclObject)}var n=e("./PBContext");o.isSupported=function(){try{return"undefined"!=typeof navigator.mimeTypes["application/x-pnacl"]}catch(e){}return!1},o.getManifestURL=function(e){return e?e+"furious.nmf":"furious.nmf"},o.prototype.empty=function(e,f){return this._messagingContext.empty(e,f)},o.prototype.zeros=function(e,f){return this._messagingContext.zeros(e,f)},o.prototype.ones=function(e,f){return this._messagingContext.ones(e,f)},o.prototype.array=function(e,f){return this._messagingContext.array(e,f)},o.prototype.linspace=function(e,f,o,n){return this._messagingContext.linspace(e,f,o,n)},o.prototype.reshape=function(e,f){return this._messagingContext.reshape(e,f)},o.prototype.repeat=function(e,f,o,n){return this._messagingContext.repeat(e,f,o,n)},o.prototype._invalidate=function(e){return this._messagingContext._invalidate(e)},o.prototype.fetch=function(){this._messagingContext.fetch.apply(this._messagingContext,arguments)},o.prototype.get=function(){this._messagingContext.get.apply(this._messagingContext,arguments)},o.prototype.info=function(e){this._messagingContext.info(e)},o.prototype.barrier=function(e){this._messagingContext.barrier(e)},o.prototype.add=function(e,f,o){return this._messagingContext.add(e,f,o)},o.prototype.sub=function(e,f,o){return this._messagingContext.sub(e,f,o)},o.prototype.mul=function(e,f,o){return this._messagingContext.mul(e,f,o)},o.prototype.div=function(e,f,o){return this._messagingContext.div(e,f,o)},o.prototype.neg=function(e,f){return this._messagingContext.neg(e,f)},o.prototype.abs=function(e,f){return this._messagingContext.abs(e,f)},o.prototype.exp=function(e,f){return this._messagingContext.exp(e,f)},o.prototype.log=function(e,f){return this._messagingContext.log(e,f)},o.prototype.sqrt=function(e,f){return this._messagingContext.sqrt(e,f)},o.prototype.square=function(e,f){return this._messagingContext.square(e,f)},o.prototype.min=function(e,f){return this._messagingContext.min(e,f)},o.prototype.max=function(e,f){return this._messagingContext.max(e,f)},o.prototype.sum=function(e,f){return this._messagingContext.sum(e,f)},o.prototype.dot=function(e,f,o){return this._messagingContext.dot(e,f,o)},o.prototype.solveTriangular=function(e,f,o,n,d,i){return this._messagingContext.solveTriangular(e,f,o,n,d,i)},o.prototype.cholesky=function(e,f,o){return this._messagingContext.cholesky(e,f,o)},f.exports=o},{"./PBContext":3}],5:[function(e,f,o){"use strict";var n=1,d=1;o.newMessageId=function(){var e=n;return n=n+1|0,e},o.newArrayId=function(){var e=d;return d=d+1|0,e}},{}],6:[function(e,f,o){"use strict";var n=e("./DataType"),d=e("./js/JSContext"),i=e("./js/WebWorkerContext"),t=e("./PNaClContext"),u=e("./webcl/WebCLContext"),l=null;try{l=document.currentScript.src}catch(p){try{var s=document.getElementsByTagName("script");l=s[s.length-1].src}catch(p){}}var y=null;if(null!==l)var c=l.lastIndexOf("/"),y=l.substr(0,c+1);var r=function(e,f,o){if("undefined"==typeof o&&("undefined"==typeof f?(o=e,f=void 0,e=void 0):(o=f,f=void 0)),"undefined"==typeof e&&(e=a()),"undefined"==typeof f&&(f={}),"javascript"===e){var n=f.async;return"undefined"==typeof n&&(n=i.isSupported()),n?(f.baseUrl=y,new i(f,o)):new d(f,o)}if("pnacl"===e)return f.baseUrl=y,new t(f,o);if("webcl"===e)return new u(f,o);throw new Error("Unsupported backend: "+e)},a=function(){return u.isUsable()?"webcl":t.isSupported()?"pnacl":"javascript"},w=function(){var e=[];return u.isUsable()&&e.push("webcl"),t.isSupported()&&e.push("pnacl"),g("asm.js")&&e.push("asm.js"),e.push("javascript"),e},b=function(e){if("javascript"===e)return i.isSupported()?{async:[!0,!1]}:{};if("pnacl"===e)return{};if("webcl"===e)return{device:u.getAvailableDevices()};throw new Error("Unsupported backend: "+e)},m=function(e){if("javascript"===e)return{async:!0};if("pnacl"===e)return t.isSupported()?{manifest:t.getDefaultManifestURL()}:{};if("webcl"===e)return{device:u.getDefaultDevice()};throw new Error("Unsupported backend: "+e)},g=function(e){switch(e){case"asm.js":try{for(var f=window.navigator.userAgent,o=f.split(/\s+/),n=/[Ff]irefox\/(\d+)/g,d=0;d<o.length;++d){var i=o[d],l=n.exec(i);if(null!==l){var p=parseInt(l[1]);return p>=29}}return!1}catch(s){}return!1;case"simd.js":return"undefined"!=typeof SIMD&&"undefined"!=typeof Float32x4Array&&"undefined"!=typeof Int32x4Array;case"webworkers":return"undefined"!=typeof Worker;case"webgl":try{var y=document.createElement("canvas");try{if(null!==y.getContext("webgl"))return!0}catch(s){}try{if(null!==y.getContext("experimental-webgl"))return!0}catch(s){}}catch(s){}return!1;case"webcl":return u.isSupported();case"pnacl":return t.isSupported();case"nacl":try{return"undefined"!=typeof navigator.mimeTypes["application/x-nacl"]}catch(s){}return!1;default:throw new Error("Unknown feature: "+e)}};o.init=r,o.hasFeature=g,o.getDefaultBackend=a,o.getSupportedBackends=w,o.getBackendOptions=b,o.getDefaultBackendOptions=m,o.DataType=n},{"./DataType":1,"./PNaClContext":4,"./js/JSContext":7,"./js/WebWorkerContext":8,"./webcl/WebCLContext":13}],7:[function(e,f){"use strict";function o(e,f){f(this)}var n=e("./../NDArray"),d=e("./../DataType"),i=e("./../util"),t=e("./jsmath");o.prototype.empty=function(e,f){return this.zeros(e,f)},o.prototype.zeros=function(e,f){e=i.checkShape(e),f="undefined"==typeof f?new d("f64"):i.checkDataType(f);var o=new n(e,f,this);return o._data=new f.arrayType(o.length),o},o.prototype.ones=function(e,f){var o=this.zeros(e,f);return t.fill(o._data,1),o},o.prototype.eye=function(e,f,o,n){e=i.checkDimension(e,"rows"),f="undefined"==typeof f?e:i.checkDimension(f,"columns"),o="undefined"==typeof o?0:i.checkInt(o);var u=Math.max(e,f);if(o>u||-u>o)throw new RangeError("diagonal is out of range");n="undefined"==typeof n?new d("f64"):i.checkDataType(n);var l=this.zeros([e,f],n);return t.fillDiagonal(l._data,e,f,o,1),l},o.prototype.array=function(e,f){f="undefined"==typeof f?new d("f64"):i.checkDataType(f);var o=[];i.discoverArrayShapeRecursive(e,o,0);var n=this.empty(o,f);return i.copyArrayDataRecursive(n._data,e,o,0,0),n},o.prototype._invalidate=function(e){i.checkNDArray(e,"array"),e._data=null},o.prototype.fetch=function(){if(0===arguments.length)throw new Error("Callback argument missing");var e=arguments[arguments.length-1];if(1===arguments.length)throw new Error("At least one NDArray argument expected");for(var f=0;f<arguments.length-1;++f)i.checkNDArray(arguments[f],"argument "+f);for(var f=0;f<arguments.length-1;++f)arguments[f]._decRef();for(var o=new Array(arguments.length-1),f=0;f<o.length;++f){var n=arguments[f];o[f]=new n.dataType.arrayType(n._data)}for(var f=0;f<arguments.length-1;++f)arguments[f]._tryInvalidate();e.apply(null,o)},o.prototype.get=function(){if(0===arguments.length)throw new Error("Callback argument missing");var e=arguments[arguments.length-1];if(1===arguments.length)throw new Error("At least one NDArray argument expected");for(var f=0;f<arguments.length-1;++f)i.checkNDArray(arguments[f],"argument "+f);for(var f=0;f<arguments.length-1;++f)arguments[f]._decRef();for(var o=new Array(arguments.length-1),f=0;f<o.length;++f){var n=arguments[f];if(0===n.shape.length)o[f]=n._data[0];else{var d=new Array(n.shape[0]);i.createArrayRecursive(n._data,d,n.shape,0,0),o[f]=d}}for(var f=0;f<arguments.length-1;++f)arguments[f]._tryInvalidate();e.apply(null,o)},o.prototype.barrier=function(e){e()},o.prototype.reshape=function(e,f){if(f=i.checkShape(f),i.computeLength(f)!==e.length)throw new RangeError("The shape is not compatible with the array");var o=new n(f,e.dataType,this);return e._decRef()?(o._data=new o.dataType.arrayType(o.length),o._data.set(e._data)):(o._data=e._data,e._tryInvalidate()),o},o.prototype.repeat=function(e,f,o,n){i.checkNDArray(e,"a"),f=i.checkRepeats(f),o=i.checkAxis(o,e.shape.length);var d=e.shape,u=d.slice(0);u[o]*=f,e._decRef();try{"undefined"==typeof n?n=this.empty(u,e.dataType):(i.checkNDArray(n,"out"),i.checkShapesCompatibility(n.shape,u),i.checkDataTypesCompatibility(e.dataType,n.dataType),n._incRef());var l=i.computeOuterStride(d,o),p=i.computeInnerStride(d,o);t.repeat(e._data,n._data,l,p,d[o],f)}catch(s){throw e._incRef(),s}return e._tryInvalidate(),n};var u=function(e,f,o,d,t,u,l){var p=null,s=null;if(e instanceof n){if(p=e.shape,s=e.dataType,f instanceof n)i.checkShapesCompatibility(e.shape,f.shape),i.checkDataTypesCompatibility(e.dataType,f.dataType);else if(!i.isNumber(f))throw new TypeError("Unsupported type of b")}else{if(!i.isNumber(e))throw new TypeError("Unsupported type of a");p=f.shape,s=f.dataType,i.checkNDArray(f,"b")}e instanceof n&&e._decRef(),f instanceof n&&f._decRef();try{"undefined"==typeof o?(o=new n(p,s,d),o._data=e instanceof n&&!e._hasRefs()?e._data:f instanceof n&&!f._hasRefs()?f._data:new s.arrayType(o.length)):(i.checkNDArray(o,"out"),i.checkShapesCompatibility(p,o.shape),i.checkDataTypesCompatibility(s,o.dataType),o._incRef()),e instanceof n?f instanceof n?t(e._data,f._data,o._data):u(e._data,+f,o._data):l(f._data,+e,o._data)}catch(y){throw e instanceof n&&e._incRef(),f instanceof n&&f._incRef(),y}return e instanceof n&&e._tryInvalidate(),f instanceof n&&f._tryInvalidate(),o},l=function(e,f,o,d){i.checkNDArray(e,"a"),e._decRef();try{"undefined"==typeof f?(f=new n(e.shape,e.dataType,o),f._data=e instanceof n&&!e._hasRefs()?e._data:new e.dataType.arrayType(f.length)):(i.checkNDArray(f,"out"),i.checkShapesCompatibility(e.shape,f.shape),i.checkDataTypesCompatibility(e.dataType,f.dataType),f._incRef()),d(e._data,f._data)}catch(t){throw e._incRef(),t}return e._tryInvalidate(),f},p=function(e,f,o,n,d,t){if(i.checkNDArray(e,"a"),"undefined"==typeof f)return"undefined"==typeof o?o=n.empty([],e.dataType):(i.checkNDArray(o,"out"),i.checkShapesCompatibility([],o.shape),i.checkDataTypesCompatibility(e.dataType,o.dataType),o._incRef()),d(e._data,o._data),e._tryRelease(),o;f=i.checkAxis(f,e.shape.length);var u=i.computeAxisReductionOutShape(e.shape,f);return"undefined"==typeof o?o=n.empty(u,e.dataType):(i.checkNDArray(o,"out"),i.checkShapesCompatibility([],o.shape),i.checkDataTypesCompatibility(e.dataType,o.dataType),o._incRef()),t(e._data,o._data,i.computeOuterStride(e.shape,f),i.computeInnerStride(e.shape,f),e.shape[f]),e._tryRelease(),o};o.prototype.add=function(e,f,o){return u(e,f,o,this,t.add,t.addConst,t.addConst)},o.prototype.sub=function(e,f,o){return u(e,f,o,this,t.sub,t.subConst,t.subRevConst)},o.prototype.mul=function(e,f,o){return u(e,f,o,this,t.mul,t.mulConst,t.mulConst)},o.prototype.div=function(e,f,o){return u(e,f,o,this,t.div,t.divConst,t.divRevConst)},o.prototype.min=function(e,f,o){return p(e,f,o,this,t.min,t.axisMin)},o.prototype.max=function(e,f,o){return p(e,f,o,this,t.max,t.axisMax)},o.prototype.sum=function(e,f,o){return p(e,f,o,this,t.sum,t.axisSum)},o.prototype.neg=function(e,f){return l(e,f,this,t.neg)},o.prototype.abs=function(e,f){return l(e,f,this,t.abs)},o.prototype.exp=function(e,f){return l(e,f,this,t.exp)},o.prototype.log=function(e,f){return l(e,f,this,t.log)},o.prototype.sqrt=function(e,f){return l(e,f,this,t.sqrt)},o.prototype.square=function(e,f){return l(e,f,this,t.square)},o.prototype.dot=function(e,f,o){i.checkNDArray(e,"a"),i.checkNDArray(f,"b"),i.checkDataTypesCompatibility(e.dataType,f.dataType);var n=Math.max(e.shape.length-1,0),d=Math.max(f.shape.length-2,0),u=e.shape[n];if(u!==f.shape[d])throw new RangeError("Arrays have incompatible reduction dimensions");for(var l=[],p=1,s=1,y=1,c=0;n>c;c++)l.push(e.shape[c]),p*=e.shape[c];for(var c=0;c<f.shape.length;c++){var r=f.shape[c];d>c?(s*=r,l.push(r)):c>d&&(y*=r,l.push(r))}return"undefined"==typeof o?o=this.empty(l,e.dataType):(i.checkNDArray(o,"out"),i.checkShapesCompatibility(o.shape,l),i.checkDataTypesCompatibility(o.dataType,e.dataType),i.checkDifferentNDArrays(e,o,"a","out"),i.checkDifferentNDArrays(f,o,"b","out"),o._incRef()),t.dot(e._data,f._data,o._data,p,s,y,u),e._tryRelease(),f._tryRelease(),o},o.prototype.solveTriangular=function(e,f,o,d,u,l){if(i.checkSquare2DArray(e,"a"),i.checkNDArray(f,"b"),i.checkDataTypesCompatibility(e.dataType,f.dataType),1!==f.shape.length&&2!==f.shape.length)throw new Error("The right-hand must be a 1D or 2D array");if(e.shape[0]!=f.shape[0])throw new Error("The arrays have incompatible shapes");d=i.checkTransposeKind(d,"N"),o=i.checkTriangularKind(o,"U"),u="undefined"==typeof u?!1:!!u,e._decRef(),f._decRef();try{"undefined"==typeof l?(l=new n(f.shape,f.dataType,this),l._data=f._hasRefs()?new l.dataType.arrayType(f._data):f._data):(i.checkNDArray(l,"out"),i.checkShapesCompatibility(f.shape,l.shape),i.checkDataTypesCompatibility(f.dataType,l.dataType),l._data.set(f._data),l._incRef())}catch(p){throw e._incRef(),f._incRef(),p}return t.solveTriangular(e._data,l._data,f.shape[0],f.shape[1]||1,"T"===d,"L"===o,u),e._tryInvalidate(),f._tryInvalidate(),l},o.prototype.cholesky=function(e,f,o){i.checkSquare2DArray(e,"a"),f=i.checkTriangularKind(f,"U"),e._decRef();try{"undefined"==typeof o?(o=new n(e.shape,e.dataType,this),o._data=e._hasRefs()?new o.dataType.arrayType(e._data):e._data):(i.checkSquare2DArray(o,"out"),i.checkShapesCompatibility(o.shape,e.shape),i.checkDataTypesCompatibility(o.dataType,e.dataType),o._data.set(e._data),o._incRef())}catch(d){throw e._incRef(),d}return t.cholesky(o._data,e.shape[0],"L"===f),e._tryInvalidate(),o},o.prototype.linspace=function(e,f,o,n){if(!i.isReal(e))throw new TypeError(e+" is not a real number");if(!i.isReal(f))throw new TypeError(f+" is not a real number");if("undefined"==typeof o)o=50;else{if(!i.isInt(o))throw new TypeError(o+" is not an integer");if(0>=o)throw new RangeError("The number of samples must be positive")
}if("undefined"==typeof n&&(n=!0),n&&1===o)throw new RangeError("The number of samples must be a least 2 (for start and end points)");for(var t=this.empty(o,new d("f64")),u=t._data,l=f-e,p=n?o-1:o,s=l/p,y=0;o>y;y++)u[y]=e+s*y;return t},f.exports=o},{"./../DataType":1,"./../NDArray":2,"./../util":12,"./jsmath":9}],8:[function(e,f){"use strict";function o(e,f){var d=this;this._worker=new Worker(o.getWorkerURL(e.baseUrl)),this._worker.addEventListener("message",function(e){d._messagingContext._onMessage(e)},!0),this._messagingContext=new n(e,function(e){d._worker.postMessage(e,[e])},f)}var n=e("./../PBContext.js");o.isSupported=function(){return"undefined"!=typeof Worker},o.getWorkerURL=function(e){return e?e+"furious-worker.js":"furious-worker.js"},o.prototype.empty=function(e,f){return this._messagingContext.empty(e,f)},o.prototype.zeros=function(e,f){return this._messagingContext.zeros(e,f)},o.prototype.ones=function(e,f){return this._messagingContext.ones(e,f)},o.prototype.array=function(e,f){return this._messagingContext.array(e,f)},o.prototype.linspace=function(e,f,o,n){return this._messagingContext.linspace(e,f,o,n)},o.prototype.reshape=function(e,f){return this._messagingContext.reshape(e,f)},o.prototype.repeat=function(e,f,o,n){return this._messagingContext.repeat(e,f,o,n)},o.prototype._invalidate=function(e){return this._messagingContext._invalidate(e)},o.prototype.fetch=function(){this._messagingContext.fetch.apply(this._messagingContext,arguments)},o.prototype.get=function(){this._messagingContext.get.apply(this._messagingContext,arguments)},o.prototype.info=function(e){this._messagingContext.info(e)},o.prototype.barrier=function(e){this._messagingContext.barrier(e)},o.prototype.add=function(e,f,o){return this._messagingContext.add(e,f,o)},o.prototype.sub=function(e,f,o){return this._messagingContext.sub(e,f,o)},o.prototype.mul=function(e,f,o){return this._messagingContext.mul(e,f,o)},o.prototype.div=function(e,f,o){return this._messagingContext.div(e,f,o)},o.prototype.neg=function(e,f){return this._messagingContext.neg(e,f)},o.prototype.abs=function(e,f){return this._messagingContext.abs(e,f)},o.prototype.exp=function(e,f){return this._messagingContext.exp(e,f)},o.prototype.log=function(e,f){return this._messagingContext.log(e,f)},o.prototype.sqrt=function(e,f){return this._messagingContext.sqrt(e,f)},o.prototype.square=function(e,f){return this._messagingContext.square(e,f)},o.prototype.min=function(e,f){return this._messagingContext.min(e,f)},o.prototype.max=function(e,f){return this._messagingContext.max(e,f)},o.prototype.sum=function(e,f){return this._messagingContext.sum(e,f)},o.prototype.dot=function(e,f,o){return this._messagingContext.dot(e,f,o)},o.prototype.solveTriangular=function(e,f,o,n,d,i){return this._messagingContext.solveTriangular(e,f,o,n,d,i)},o.prototype.cholesky=function(e,f,o){return this._messagingContext.cholesky(e,f,o)},f.exports=o},{"./../PBContext.js":3}],9:[function(e,f,o){"use strict";o.fill=function(e,f){for(var o=e.length,n=0;o>n;++n)e[n]=f},o.fillDiagonal=function(e,f,o,n,d){if(0===n)for(var i=Math.min(f,o),t=0;i>t;++t)e[t*o+t]=d;else if(n>0)for(var i=Math.min(f,o-n),t=0;i>t;++t)e[t*o+t+n]=d;else for(var i=Math.min(f+n,o),t=0;i>t;++t)e[(t-n)*o+t]=d},o.add=function(e,f,o){for(var n=o.length,d=0;n>d;++d)o[d]=e[d]+f[d]},o.addConst=function(e,f,o){for(var n=o.length,d=0;n>d;++d)o[d]=e[d]+f},o.sub=function(e,f,o){for(var n=o.length,d=0;n>d;++d)o[d]=e[d]-f[d]},o.subConst=function(e,f,o){for(var n=o.length,d=0;n>d;++d)o[d]=e[d]-f},o.subRevConst=function(e,f,o){for(var n=o.length,d=0;n>d;++d)o[d]=f-e[d]},o.mul=function(e,f,o){for(var n=o.length,d=0;n>d;++d)o[d]=e[d]*f[d]},o.mulConst=function(e,f,o){for(var n=o.length,d=0;n>d;++d)o[d]=e[d]*f},o.div=function(e,f,o){for(var n=o.length,d=0;n>d;++d)o[d]=e[d]/f[d]},o.divConst=function(e,f,o){for(var n=o.length,d=0;n>d;++d)o[d]=e[d]/f},o.divRevConst=function(e,f,o){for(var n=o.length,d=0;n>d;++d)o[d]=f/e[d]},o.neg=function(e,f){for(var o=f.length,n=0;o>n;++n)f[n]=-e[n]},o.abs=function(e,f){for(var o=f.length,n=0;o>n;++n)f[n]=Math.abs(e[n])},o.exp=function(e,f){for(var o=f.length,n=0;o>n;++n)f[n]=Math.exp(e[n])},o.log=function(e,f){for(var o=f.length,n=0;o>n;++n)f[n]=Math.log(e[n])},o.sqrt=function(e,f){for(var o=f.length,n=0;o>n;++n)f[n]=Math.sqrt(e[n])},o.square=function(e,f){for(var o=f.length,n=0;o>n;++n){var d=e[n];f[n]=d*d}},o.min=function(e,f){for(var o=e.length,n=e[0],d=1;o>d;++d)n=Math.min(n,e[d]);f[0]=n},o.max=function(e,f){for(var o=e.length,n=e[0],d=1;o>d;++d)n=Math.max(n,e[d]);f[0]=n},o.sum=function(e,f){for(var o=e.length,n=0,d=0;o>d;++d)n+=e[d];f[0]=n},o.axisMin=function(e,f,o,n,d){for(var i=0;o>i;++i)for(var t=0;n>t;++t){for(var u=i*d*n+t,l=e[u],p=1;d>p;++p)u+=n,l=Math.min(l,e[u]);f[i*n+t]=l}},o.axisMax=function(e,f,o,n,d){for(var i=0;o>i;++i)for(var t=0;n>t;++t){for(var u=i*d*n+t,l=e[u],p=1;d>p;++p)u+=n,l=Math.max(l,e[u]);f[i*n+t]=l}},o.axisSum=function(e,f,o,n,d){for(var i=0;o>i;++i)for(var t=0;n>t;++t){for(var u=i*d*n+t,l=e[u],p=1;d>p;++p)u+=n,l+=e[u];f[i*n+t]=l}},o.dot=function(e,f,o,n,d,i,t){for(var u=0;n>u;++u)for(var l=0;t>l;++l)for(var p=0;d>p;++p)for(var s=0;i>s;++s)o[(u*d+p)*i+s]+=e[u*t+l]*f[(p*t+l)*i+s]},o.repeat=function(e,f,o,n,d,i){if(i>n)for(var t=0;o>t;++t)for(var u=0;d>u;++u)for(var l=0;n>l;++l)for(var p=e[(t*d+u)*n+l],s=0;i>s;++s)f[((t*d+u)*i+s)*n+l]=p;else for(var t=0;o>t;++t)for(var u=0;d>u;++u)for(var y=e.subarray((t*d+u)*n,(t*d+u+1)*n),s=0;i>s;++s)f.set(y,((t*d+u)*i+s)*n)},o.solveTriangular=function(e,f,o,n,d,i,t){if(i)if(d)for(var u=o-1;u>=0;--u)for(var l=0;n>l;++l){for(var p=f[u*n+l],s=o-1;s>u;--s)p-=e[s*o+u]*f[s*n+l];f[u*n+l]=t?p:p/e[u*o+u]}else for(var u=0;o>u;++u)for(var l=0;n>l;++l){for(var p=f[u*n+l],s=0;u>s;++s)p-=e[u*o+s]*f[s*n+l];f[u*n+l]=t?p:p/e[u*o+u]}else if(d)for(var u=0;o>u;++u)for(var l=0;n>l;++l){for(var p=f[u*n+l],s=0;u>s;++s)p-=e[s*o+u]*f[s*n+l];f[u*n+l]=t?p:p/e[u*o+u]}else for(var u=o-1;u>=0;--u)for(var l=0;n>l;++l){for(var p=f[u*n+l],s=o-1;s>u;--s)p-=e[u*o+s]*f[s*n+l];f[u*n+l]=t?p:p/e[u*o+u]}},o.cholesky=function(e,f,o){for(var n=0;f>n;++n){var d=Math.sqrt(e[n*f+n]);e[n*f+n]=d;for(var i=n+1;f>i;++i)e[i*f+n]/=d;for(var i=n+1;f>i;++i)e[n*f+i]/=d;for(var i=n+1;f>i;++i)for(var t=n+1;f>t;++t)e[i*f+t]-=e[i*f+n]*e[n*f+t]}if(o)for(var n=0;f>n;++n)for(var i=n+1;f>i;++i)e[n*f+i]=0;else for(var n=0;f>n;++n)for(var i=0;n>i;++i)e[n*f+i]=0}},{}],10:[function(e,f){var o=e("protobufjs");o.convertFieldsToCamelCase=!0;var n="package furious;\n\noption optimize_for = LITE_RUNTIME;\n\nenum DataType {\n	FLOAT64 = 0;\n	FLOAT32 = 1;\n}\n\nenum TriangularMatrixType {\n	UPPER = 0;\n	LOWER = 1;\n}\n\nenum TranspositionType {\n	NORMAL    = 0;\n	TRANSPOSE = 1;\n}\n\nmessage Request {\n	enum Type {\n		EMPTY_ARRAY              =  0;\n		DATA_ARRAY               =  1;\n		CONST_ARRAY              =  2;\n		LINSPACE                 =  3;\n		RESHAPE                  =  4;\n		REPEAT                   =  5;\n		DEALLOCATE               =  6;\n		FETCH                    =  7;\n		BARRIER                  =  8;\n		INFO                     =  9;\n		BINARY_OPERATION         = 10;\n		BINARY_CONST_OPERATION   = 11;\n		UNARY_OPERATION          = 12;\n		REDUCTION_OPERATION      = 13;\n		AXIS_REDUCTION_OPERATION = 14;\n		DOT_OPERATION            = 15;\n		CHOLESKY_DECOMPOSITION   = 16;\n		SOLVE_TRIANGULAR         = 17;\n	}\n	required fixed32                      id                             =  1;\n	required Type                         type                           =  2;\n\n	optional EmptyArrayRequest            empty_array_request            =  3;\n	optional DataArrayRequest             data_array_request             =  4;\n	optional ConstArrayRequest            const_array_request            =  5;\n	optional LinspaceRequest              linspace_request               =  6;\n	optional ReshapeRequest               reshape_request                =  7;\n	optional RepeatRequest                repeat_request                 =  8;\n	optional DeallocateRequest            deallocate_request             =  9;\n	optional FetchRequest                 fetch_request                  = 10;\n	optional BinaryOperationRequest       binary_operation_request       = 11;\n	optional BinaryConstOperationRequest  binary_const_operation_request = 12;\n	optional UnaryOperationRequest        unary_operation_request        = 13;\n	optional ReductionRequest             reduction_request              = 14;\n	optional AxisReductionRequest         axis_reduction_request         = 15;\n	optional DotOperationRequest          dot_operation_request          = 16;\n	optional CholeskyDecompositionRequest cholesky_decomposition_request = 17;\n	optional SolveTriangularRequest       solve_triangular_request       = 18;\n}\n\nmessage EmptyArrayRequest {\n	required fixed32  id_out      = 1;\n	repeated uint32   shape       = 2 [packed=true];\n	required DataType data_type   = 3;\n}\n\nmessage DataArrayRequest {\n	required fixed32  id_out      = 1;\n	repeated uint32   shape       = 2 [packed=true];\n	required DataType data_type   = 3;\n	required bytes    data_buffer = 4;\n}\n\nmessage ConstArrayRequest {\n	required fixed32  id_out      = 1;\n	repeated uint32   shape       = 2 [packed=true];\n	required DataType data_type   = 3;\n	required double   fill_value  = 4;\n}\n\nmessage LinspaceRequest {\n	required sfixed32  id_out     = 1;\n	required double    start      = 2;\n	required double    stop       = 3;\n	required uint32    samples    = 4;\n	required bool      closed     = 5;\n	required DataType  data_type  = 6;\n}\n\nmessage ReshapeRequest {\n	required sfixed32  id_a      = 1;\n	required fixed32   id_out    = 2;\n	repeated uint32    shape_out = 3 [packed=true];\n}\n\nmessage RepeatRequest {\n	required sfixed32 id_a    = 1;\n	required fixed32  id_out  = 2;\n	required uint32   axis    = 3;\n	required uint32   repeats = 4;\n}\n\nmessage DeallocateRequest {\n	required fixed32 id_a = 1;\n}\n\nmessage FetchRequest {\n	required sfixed32 id_a = 1;\n}\n\nmessage BinaryOperationRequest {\n	enum Type {\n		ADD = 0;\n		SUB = 1;\n		MUL = 2;\n		DIV = 3;\n	}\n	required Type     type   = 1;\n	required sfixed32 id_a   = 2;\n	required sfixed32 id_b   = 3;\n	required fixed32  id_out = 4;\n}\n\nmessage BinaryConstOperationRequest {\n	enum Type {\n		ADDC  = 0;\n		SUBC  = 1;\n		SUBRC = 2;\n		MULC  = 3;\n		DIVC  = 4;\n		DIVRC = 5;\n	}\n	required Type     type    = 1;\n	required sfixed32 id_a    = 2;\n	required double   value_b = 3;\n	required fixed32  id_out  = 4;\n}\n\nmessage UnaryOperationRequest {\n	enum Type {\n		NEG    = 0;\n		ABS    = 1;\n		EXP    = 2;\n		LOG    = 3;\n		SQRT   = 4;\n		SQUARE = 5;\n	}\n	required Type     type   = 1;\n	required sfixed32 id_a   = 2;\n	required fixed32  id_out = 3;\n}\n\nmessage ReductionRequest {\n	enum Type {\n		SUM = 0;\n		MIN = 1;\n		MAX = 2;\n	}\n	required Type     type   = 1;\n	required sfixed32 id_a   = 2;\n	required fixed32  id_out = 3;\n}\n\nmessage AxisReductionRequest {\n	enum Type {\n		SUM = 0;\n		MIN = 1;\n		MAX = 2;\n	}\n	required Type     type   = 1;\n	required sfixed32 id_a   = 2;\n	required uint32   axis   = 3;\n	required fixed32  id_out = 4;\n}\n\nmessage DotOperationRequest {\n	required sfixed32 id_a   = 1;\n	required sfixed32 id_b   = 2;\n	required fixed32  id_out = 3;\n}\n\nmessage CholeskyDecompositionRequest {\n	required sfixed32             id_a   = 1;\n	required TriangularMatrixType a_type = 2;\n	required fixed32              id_out = 3;\n}\n\nmessage SolveTriangularRequest {\n	required sfixed32             id_a            = 1;\n	required TriangularMatrixType a_type          = 2;\n	required TranspositionType    a_transposition = 3;\n	required bool                 unit_diagonal   = 4;\n	required sfixed32             id_y            = 5;\n	required fixed32              id_x            = 6;\n}\n";f.exports=o.loadProto(n).build("furious")},{protobufjs:18}],11:[function(e,f){var o=e("protobufjs");o.convertFieldsToCamelCase=!0;var n="package furious;\n\noption optimize_for = LITE_RUNTIME;\n\nmessage Response {\n	enum Type {\n		FETCH   = 0;\n		ERROR   = 1;\n		INIT    = 2;\n		BARRIER = 3;\n		INFO    = 4;\n	}\n	required fixed32         id               = 1;\n	required Type            type             = 2;\n\n	optional FetchResponse   fetch_response   = 3;\n	optional ErrorResponse   error_response   = 4;\n	optional InitResponse    init_response    = 5;\n	optional InfoResponse    info_response    = 7;\n}\n\nmessage FetchResponse {\n	required bytes data_buffer = 1;\n}\n\nmessage ErrorResponse {\n	enum Type {\n		RUNTIME  = 0;\n		ARGUMENT = 1;\n		PARSE    = 2;\n	}\n	required Type   type        = 1;\n	optional string description = 2;\n}\n\nmessage InitResponse {\n	optional uint32 concurrency = 1;\n}\n\nmessage InfoResponse {\n}\n";f.exports=o.loadProto(n).build("furious")},{protobufjs:18}],12:[function(e,f,o){"use strict";var n=function(e){return e===+e};o.isNumber=n;var d=function(e){return e===+e&&isFinite(e)};o.isReal=d;var i=function(e){return e===(0|e)};o.isInt=i,o.isPositiveInt=function(e){return e===+e&&e===(0|e)&&e>0};var t=function(e){return e instanceof Array};o.isArray=t,o.isIntArray=function(e){if(o.isArray(e)){for(var f=0;f<e.length;f++)if(!o.isInt(e[f]))return!1;return!0}return!1},o.isPositiveIntArray=function(e){if(o.isArray(e)){for(var f=0;f<e.length;f++)if(!o.isPositiveInt(e[f]))return!1;return!0}return!1},o.asIntArray=function(e){if(o.isInt(e))return[e];if(o.isIntArray(e))return e;throw new TypeError(e+" can not be converted to integer array")},o.arrayEquals=function(e,f){if(e===f)return!0;if(e.length!==f.length)return!1;for(var o=e.length,n=0;o>n;++n)if(e[n]!==f[n])return!1;return!0},o.roundUp=function(e,f){return Math.ceil(e/f)*f};var u=function(e,f){if(!n(e))throw new TypeError(f+" must be a number");if(!i(e))throw new Error(f+" must be an integer");return 0|e};o.checkInt=u;var l=function(e,f){if(e=u(e,f),1>e)throw new RangeError(e+" must be positive");return 0|e};o.checkDimension=l;var p=function(e){if(n(e))return p([e]);if(t(e)){for(var f=e.length,o=new Array(f),d=0;f>d;d++){if(!n(e[d]))throw new Error("Shape has non-numeric dimensions");if(!i(e[d]))throw new Error("Shape must have integer dimensions");if(e[d]<1)throw new Error("Degenerate shape");o[d]=0|e[d]}return o}throw new Error("Shape must be an integer or integer array")};o.checkShape=p,o.checkShapesCompatibility=function(e,f){if(e.length!=f.length)throw new Error("The shapes have different dimensions");for(var o=e.length,n=0;o>n;n++)if(e[n]!=f[n])throw new Error("The shapes are different")},o.computeLength=function(e){for(var f=1,o=0;o<e.length;++o)f*=e[o];return f},o.checkDataType=function(f){var o=e("./DataType");if(!(f instanceof o))throw new TypeError("dataType is not an instance of DataType");return f},o.checkDataTypesCompatibility=function(e,f){if(!e.equals(f))throw new Error("The data types are not compatible")},o.checkNDArray=function(f,o){var n=e("./NDArray");if(!(f instanceof n))throw new TypeError(o+" is not an NDArray");if(!f.isValid())throw new Error(o+" is an invalidated array")},o.check2DArray=function(e,f){if(o.checkNDArray(e,f),2!==e.shape.length)throw new Error(f+" is not a 2-dimensional array")},o.checkSquare2DArray=function(e,f){if(o.check2DArray(e,f),e.shape[0]!==e.shape[1])throw new Error(f+" has different number of rows and columns")},o.checkDifferentNDArrays=function(e,f,o,n){if(e===f)throw new Error("The arrays "+o+" and "+n+" must be different")},o.checkRepeats=function(e){if(!i(e))throw new TypeError("Repeats is not an integer");if(1>=e)throw new RangeError("Repeats should be greater than 1");return 0|e},o.checkAxis=function(e,f){if(!i(e))throw new TypeError("Axis is not an integer");if(0>e)throw new RangeError("Axis is negative");if(e>=f)throw new RangeError("Axis out of range");return 0|e},o.checkTransposeKind=function(e,f){if("undefined"==typeof e)return f;if("N"===e||"T"===e)return e;throw new Error("The kind of transposition is neither N(normal) nor T(ranspose)")},o.checkTriangularKind=function(e,f){if("undefined"==typeof e)return f;if("L"===e||"U"===e)return e;throw new Error("The kind of a triangular matrix is neither L(ower) nor U(pper)")},o.checkAxisReductionOutShape=function(e,f,o){if(e.length!==f.length+1)throw new Error("Output array has invalid number of dimensions for this operation");for(var n=0;o>n;++n)if(e[n]!==f[n])throw new Error("Output array has invalid shape for this operation");for(var n=o+1;n<e.length;++n)if(e[n]!==f[n-1])throw new Error("Output array has invalid shape for this operation")},o.computeAxisReductionOutShape=function(e,f){for(var o=[],n=0;n<e.length;++n)n!==f&&o.push(e[n]);return o},o.computeOuterStride=function(e,f){for(var o=1,n=0;f>n;++n)o*=e[n];return o},o.computeInnerStride=function(e,f){for(var o=1,n=f+1;n<e.length;++n)o*=e[n];return o};var s=function(e,f,o){if(t(e)){if(f.length<=o)f.push(e.length);else if(f[o]!=e.length)throw new RangeError("Sub-array "+e+" does not match the expected dimension of "+f[o]);for(var d=0;d<e.length;d++)s(e[d],f,o+1)}else{if(o!=f.length)throw new RangeError("Sub-array ["+e+"] does not match the expected dimension of "+f[o]);if(!n(e))throw new TypeError("Non-numeric element: "+e)}};o.discoverArrayShapeRecursive=s;var y=function(e,f,o,n,d){var i=o[n];if(n===o.length-1)e.set(f,d*i);else for(var t=0;i>t;t++)y(e,f[t],o,n+1,d*i+t)};o.copyArrayDataRecursive=y;var c=function(e,f,o,n,d){var i=o[n];if(n===o.length-1)for(var t=0;i>t;t++)f[t]=e[d*i+t];else for(var t=0;i>t;t++)f[t]=new Array(o[n+1]),c(e,f[t],o,n+1,d*i+t)};o.createArrayRecursive=c},{"./DataType":1,"./NDArray":2}],13:[function(e,f){"use strict";function o(e,f){c();var o="kernel void add_f32(\n	uint length,\n	global float* a,\n	global float* b,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] + b[id];\n	}\n}\nkernel void add_f64(\n	uint length,\n	global double* a,\n	global double* b,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] + b[id];\n	}\n}\nkernel void sub_f32(\n	uint length,\n	global float* a,\n	global float* b,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] - b[id];\n	}\n}\nkernel void sub_f64(\n	uint length,\n	global double* a,\n	global double* b,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] - b[id];\n	}\n}\nkernel void mul_f32(\n	uint length,\n	global float* a,\n	global float* b,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] * b[id];\n	}\n}\nkernel void mul_f64(\n	uint length,\n	global double* a,\n	global double* b,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] * b[id];\n	}\n}\nkernel void div_f32(\n	uint length,\n	global float* a,\n	global float* b,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] / b[id];\n	}\n}\nkernel void div_f64(\n	uint length,\n	global double* a,\n	global double* b,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] / b[id];\n	}\n}\nkernel void addc_f32(\n	uint length,\n	global float* a,\n	float b,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] + b;\n	}\n}\nkernel void addc_f64(\n	uint length,\n	global double* a,\n	double b,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] + b;\n	}\n}\nkernel void subc_f32(\n	uint length,\n	global float* a,\n	float b,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] - b;\n	}\n}\nkernel void subc_f64(\n	uint length,\n	global double* a,\n	double b,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] - b;\n	}\n}\nkernel void subrc_f32(\n	uint length,\n	global float* a,\n	float b,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = b / a[id];\n	}\n}\nkernel void subrc_f64(\n	uint length,\n	global double* a,\n	double b,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = b / a[id];\n	}\n}\nkernel void mulc_f32(\n	uint length,\n	global float* a,\n	float b,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] * b;\n	}\n}\nkernel void mulc_f64(\n	uint length,\n	global double* a,\n	double b,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] * b;\n	}\n}\nkernel void divc_f32(\n	uint length,\n	global float* a,\n	float b,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] / b;\n	}\n}\nkernel void divc_f64(\n	uint length,\n	global double* a,\n	double b,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = a[id] / b;\n	}\n}\nkernel void divrc_f32(\n	uint length,\n	global float* a,\n	float b,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = b / a[id];\n	}\n}\nkernel void divrc_f64(\n	uint length,\n	global double* a,\n	double b,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = b / a[id];\n	}\n}\n",n="kernel void neg_f32(\n	uint length,\n	global float* a,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = -a[id];\n	}\n}\nkernel void neg_f64(\n	uint length,\n	global double* a,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = -a[id];\n	}\n}\nkernel void abs_f32(\n	uint length,\n	global float* a,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = fabs(a[id]);\n	}\n}\nkernel void abs_f64(\n	uint length,\n	global double* a,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = fabs(a[id]);\n	}\n}\nkernel void exp_f32(\n	uint length,\n	global float* a,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = exp(a[id]);\n	}\n}\nkernel void exp_f64(\n	uint length,\n	global double* a,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = exp(a[id]);\n	}\n}\nkernel void log_f32(\n	uint length,\n	global float* a,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = log(a[id]);\n	}\n}\nkernel void log_f64(\n	uint length,\n	global double* a,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = log(a[id]);\n	}\n}\nkernel void sqrt_f32(\n	uint length,\n	global float* a,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = sqrt(a[id]);\n	}\n}\nkernel void sqrt_f64(\n	uint length,\n	global double* a,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = sqrt(a[id]);\n	}\n}\nkernel void square_f32(\n	uint length,\n	global float* a,\n	global float* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		const float aVal = a[id]; \n		out[id] = aVal * aVal;\n	}\n}\nkernel void square_f64(\n	uint length,\n	global double* a,\n	global double* out)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		const double aVal = a[id];\n		out[id] = aVal * aVal;\n	}\n}\n",d="kernel void sum_f32_gpu(\n	uint length,\n	global float* a,\n	local float* scratch,\n	global float* out)\n{\n	const uint globalSize = get_global_size(0);\n	uint globalIndex = get_global_id(0);\n	float accumulator = 0.0f;\n	while (globalIndex < length) {\n		accumulator += a[globalIndex];\n		globalIndex += globalSize;\n	}\n\n	uint localIndex = get_local_id(0);\n	scratch[localIndex] = accumulator;\n	barrier(CLK_LOCAL_MEM_FENCE);\n	for (uint offset = get_local_size(0) / 2; offset != 0; offset >>= 1) {\n		if (localIndex < offset) {\n			scratch[localIndex] += scratch[localIndex + offset];\n		}\n		barrier(CLK_LOCAL_MEM_FENCE);\n	}\n	if (localIndex == 0) {\n		out[get_group_id(0)] = scratch[0];\n	}\n}\n\nkernel void sum_f64_gpu(\n	uint length,\n	global double* a,\n	local double* scratch,\n	global double* out)\n{\n	const uint globalSize = get_global_size(0);\n	uint globalIndex = get_global_id(0);\n	double accumulator = 0.0;\n	while (globalIndex < length) {\n		accumulator += a[globalIndex];\n		globalIndex += globalSize;\n	}\n\n	uint localIndex = get_local_id(0);\n	scratch[localIndex] = accumulator;\n	barrier(CLK_LOCAL_MEM_FENCE);\n	for (uint offset = get_local_size(0) / 2; offset != 0; offset >>= 1) {\n		if (localIndex < offset) {\n			scratch[localIndex] += scratch[localIndex + offset];\n		}\n		barrier(CLK_LOCAL_MEM_FENCE);\n	}\n	if (localIndex == 0) {\n		out[get_group_id(0)] = scratch[0];\n	}\n}\n\nkernel void min_f32_gpu(\n	uint length,\n	global float* a,\n	local float* scratch,\n	global float* out)\n{\n	const uint globalSize = get_global_size(0);\n	uint globalIndex = get_global_id(0);\n	float accumulator = INFINITY;\n	while (globalIndex < length) {\n		accumulator = min(accumulator, a[globalIndex]);\n		globalIndex += globalSize;\n	}\n\n	uint localIndex = get_local_id(0);\n	scratch[localIndex] = accumulator;\n	barrier(CLK_LOCAL_MEM_FENCE);\n	for (uint offset = get_local_size(0) / 2; offset != 0; offset >>= 1) {\n		if (localIndex < offset) {\n			scratch[localIndex] = min(scratch[localIndex], scratch[localIndex + offset]);\n		}\n		barrier(CLK_LOCAL_MEM_FENCE);\n	}\n	if (localIndex == 0) {\n		out[get_group_id(0)] = scratch[0];\n	}\n}\n\nkernel void min_f64_gpu(\n	uint length,\n	global double* a,\n	local double* scratch,\n	global double* out)\n{\n	const uint globalSize = get_global_size(0);\n	uint globalIndex = get_global_id(0);\n	double accumulator = INFINITY;\n	while (globalIndex < length) {\n		accumulator = min(accumulator, a[globalIndex]);\n		globalIndex += globalSize;\n	}\n\n	uint localIndex = get_local_id(0);\n	scratch[localIndex] = accumulator;\n	barrier(CLK_LOCAL_MEM_FENCE);\n	for (uint offset = get_local_size(0) / 2; offset != 0; offset >>= 1) {\n		if (localIndex < offset) {\n			scratch[localIndex] = min(scratch[localIndex], scratch[localIndex + offset]);\n		}\n		barrier(CLK_LOCAL_MEM_FENCE);\n	}\n	if (localIndex == 0) {\n		out[get_group_id(0)] = scratch[0];\n	}\n}\n\nkernel void max_f32_gpu(\n	uint length,\n	global float* a,\n	local float* scratch,\n	global float* out)\n{\n	const uint globalSize = get_global_size(0);\n	uint globalIndex = get_global_id(0);\n	float accumulator = -INFINITY;\n	while (globalIndex < length) {\n		accumulator = max(accumulator, a[globalIndex]);\n		globalIndex += globalSize;\n	}\n\n	uint localIndex = get_local_id(0);\n	scratch[localIndex] = accumulator;\n	barrier(CLK_LOCAL_MEM_FENCE);\n	for (uint offset = get_local_size(0) / 2; offset != 0; offset >>= 1) {\n		if (localIndex < offset) {\n			scratch[localIndex] = max(scratch[localIndex], scratch[localIndex + offset]);\n		}\n		barrier(CLK_LOCAL_MEM_FENCE);\n	}\n	if (localIndex == 0) {\n		out[get_group_id(0)] = scratch[0];\n	}\n}\n\nkernel void max_f64_gpu(\n	uint length,\n	global double* a,\n	local double* scratch,\n	global double* out)\n{\n	const uint globalSize = get_global_size(0);\n	uint globalIndex = get_global_id(0);\n	double accumulator = -INFINITY;\n	while (globalIndex < length) {\n		accumulator = max(accumulator, a[globalIndex]);\n		globalIndex += globalSize;\n	}\n\n	uint localIndex = get_local_id(0);\n	scratch[localIndex] = accumulator;\n	barrier(CLK_LOCAL_MEM_FENCE);\n	for (uint offset = get_local_size(0) / 2; offset != 0; offset >>= 1) {\n		if (localIndex < offset) {\n			scratch[localIndex] = max(scratch[localIndex], scratch[localIndex + offset]);\n		}\n		barrier(CLK_LOCAL_MEM_FENCE);\n	}\n	if (localIndex == 0) {\n		out[get_group_id(0)] = scratch[0];\n	}\n}\n",i="kernel void asum_f32(\n	uint reductionDim,\n	global float* a,\n	global float* out)\n{\n	const uint innerStride = get_global_size(1);\n	const uint i = get_global_id(0);\n	const uint k = get_global_id(1);\n	a += i * reductionDim * innerStride + k;\n	float accumulator = *a;\n	while (--reductionDim) {\n		a += innerStride;\n		accumulator += *a;\n	}\n	out[i * innerStride + k] = accumulator;\n}\n\nkernel void asum_f64(\n	uint reductionDim,\n	global double* a,\n	global double* out)\n{\n	const uint innerStride = get_global_size(1);\n	const uint i = get_global_id(0);\n	const uint k = get_global_id(1);\n	a += i * reductionDim * innerStride + k;\n	double accumulator = *a;\n	while (--reductionDim) {\n		a += innerStride;\n		accumulator += *a;\n	}\n	out[i * innerStride + k] = accumulator;\n}\n\nkernel void amin_f32(\n	uint reductionDim,\n	global float* a,\n	global float* out)\n{\n	const uint innerStride = get_global_size(1);\n	const uint i = get_global_id(0);\n	const uint k = get_global_id(1);\n	a += i * reductionDim * innerStride + k;\n	float accumulator = *a;\n	while (--reductionDim) {\n		a += innerStride;\n		accumulator = min(accumulator, *a);\n	}\n	out[i * innerStride + k] = accumulator;\n}\n\nkernel void amin_f64(\n	uint reductionDim,\n	global double* a,\n	global double* out)\n{\n	const uint innerStride = get_global_size(1);\n	const uint i = get_global_id(0);\n	const uint k = get_global_id(1);\n	a += i * reductionDim * innerStride + k;\n	double accumulator = *a;\n	while (--reductionDim) {\n		a += innerStride;\n		accumulator = min(accumulator, *a);\n	}\n	out[i * innerStride + k] = accumulator;\n}\n\nkernel void amax_f32(\n	uint reductionDim,\n	global float* a,\n	global float* out)\n{\n	const uint innerStride = get_global_size(1);\n	const uint i = get_global_id(0);\n	const uint k = get_global_id(1);\n	a += i * reductionDim * innerStride + k;\n	float accumulator = *a;\n	while (--reductionDim) {\n		a += innerStride;\n		accumulator = max(accumulator, *a);\n	}\n	out[i * innerStride + k] = accumulator;\n}\n\nkernel void amax_f64(\n	uint reductionDim,\n	global double* a,\n	global double* out)\n{\n	const uint innerStride = get_global_size(1);\n	const uint i = get_global_id(0);\n	const uint k = get_global_id(1);\n	a += i * reductionDim * innerStride + k;\n	double accumulator = *a;\n	while (--reductionDim) {\n		a += innerStride;\n		accumulator = max(accumulator, *a);\n	}\n	out[i * innerStride + k] = accumulator;\n}\n",t="kernel void dot_f32(\n	uint reductionDim,\n	global float* a,\n	global float* b,\n	global float* out)\n{\n	const uint i = get_global_id(0);\n	const uint k = get_global_id(1);\n	const uint l = get_global_id(2);\n	const uint outerStrideB = get_global_size(1);\n	const uint innerStrideB = get_global_size(2);\n\n	float accumulator = 0.0f;\n	for (uint j = 0; j < reductionDim; ++j) {\n		accumulator += a[i*reductionDim+j] * b[(k*reductionDim+j)*innerStrideB+l];\n	}\n	out[(i*outerStrideB + k) * innerStrideB + l] = accumulator;\n}\n\nkernel void dot_f64(\n	uint reductionDim,\n	global double* a,\n	global double* b,\n	global double* out)\n{\n	const uint i = get_global_id(0);\n	const uint k = get_global_id(1);\n	const uint l = get_global_id(2);\n	const uint outerStrideB = get_global_size(1);\n	const uint innerStrideB = get_global_size(2);\n\n	double accumulator = 0.0;\n	for (uint j = 0; j < reductionDim; ++j) {\n		accumulator += a[i*reductionDim+j] * b[(k*reductionDim+j)*innerStrideB+l];\n	}\n	out[(i*outerStrideB + k) * innerStrideB + l] = accumulator;\n}\n",y="kernel void set_f32(\n	uint length,\n	global float* out,\n	float value)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = value;\n	}\n}\nkernel void set_f64(\n	uint length,\n	global double* out,\n	double value)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = value;\n	}\n}\n\nkernel void linspace_f32(\n	uint length,\n	global float* out,\n	float start,\n	float step)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = start + step * ((float) id);\n	}\n}\nkernel void linspace_f64(\n	uint length,\n	global double* out,\n	double start,\n	double step)\n{\n	const uint id = get_global_id(0);\n	if (id < length) {\n		out[id] = start + step * ((double) id);\n	}\n}\n\nkernel void repeat_f32(\n	uint expansionDim,\n	uint innerStride,\n	uint repeats,\n	global float *restrict a,\n	global float *restrict out)\n{\n	const uint i = get_global_id(0);\n	const uint j = get_global_id(1);\n	const uint k = get_global_id(2);\n	const float value = a[(i * expansionDim + j) * innerStride + k];\n	uint offsetOut = (i * expansionDim + j) * repeats * innerStride + k;\n	for (uint c = 0; c < repeats; ++c) {\n		out[offsetOut] = value;\n		offsetOut += innerStride;\n	}\n}\nkernel void repeat_f64(\n	uint expansionDim,\n	uint innerStride,\n	uint repeats,\n	global double *restrict a,\n	global double *restrict out)\n{\n	const uint i = get_global_id(0);\n	const uint j = get_global_id(1);\n	const uint k = get_global_id(2);\n	const double value = a[(i * expansionDim + j) * innerStride + k];\n	uint offsetOut = (i * expansionDim + j) * repeats * innerStride + k;\n	for (uint c = 0; c < repeats; ++c) {\n		out[offsetOut] = value;\n		offsetOut += innerStride;\n	}\n}\n",r=o+n+d+i+t+y,a=e.asyncCallbacks;
this.asyncCallbacks="undefined"==typeof a?u:!!a;var w=e.device;if(w){var b=s.indexOf(w);if(-1===b)throw new Error("Invalid WebCL device name: "+w);this.device=p[b]}else{var b=x();if(0>b)throw new Error("No suitable WebCL device found");this.device=p[b]}this.device.enableExtension("KHR_fp64"),this.deviceInfo={deviceClass:g(this.device),localMemorySize:this.device.getInfo(l.DEVICE_LOCAL_MEM_SIZE),maxComputeUnits:this.device.getInfo(l.DEVICE_MAX_COMPUTE_UNITS),maxWorkGroupSize:this.device.getInfo(l.DEVICE_MAX_WORK_GROUP_SIZE),maxWorkItemSizes:this.device.getInfo(l.DEVICE_MAX_WORK_ITEM_SIZES)},this.context=l.createContext(this.device),this.queue=this.context.createCommandQueue(this.device),this.program=this.context.createProgram(r);try{this.program.build([this.device])}catch(m){if("INVALID_DEVICE"!==m.name)throw m;this.program.build()}this.kernels=j(this.program),f(this)}var n=e("../NDArray"),d=e("../DataType"),i=e("../util"),t=!1,u=!1,l=void 0,p=null,s=null,y=-1,c=function(){if("undefined"==typeof l)if("object"==typeof window)l="undefined"!=typeof window.webcl?window.webcl:null;else try{l=e("node-webcl"),u=!0}catch(f){l=null}return l},r=function(){return u?new l.WebCLEvent:new WebCLEvent},a=function(e){if(null!==e)try{return e.release(),!0}catch(f){}return!1},w=function(e){var f=e.getSupportedExtensions();if(-1===f.indexOf("KHR_fp64"))return!1;var o="kernel void foo(global double* bar) { }",n=null,d=null;try{return n=l.createContext(e),d=n.createProgram(o),d.build(),!0}catch(i){return!1}finally{a(d),a(n)}},b=function(){if(null===p){p=[];var e=c();if(null!==e)for(var f=l.getPlatforms(),o=0;o<f.length;++o)for(var n=f[o],d=n.getDevices(l.DEVICE_TYPE_ALL),i=0;i<d.length;++i){var t=d[i];w(t)&&p.push(t)}m()}return p},m=function(){s=[];for(var e=!0,f=0;f<p.length;++f){var o=p[f],n=o.getInfo(l.DEVICE_NAME);if(null===n||""===n){e=!1;break}s[f]=n}if(!e){for(var d=0,i=0,t=0,f=0;f<p.length;++f){var o=p[f],u=g(o);if("cpu"===u)++d,s[f]="CPU";else if("igpu"===u)++i,s[f]="iGPU";else{if("dgpu"!==u)throw new Error("Impossible device classification: "+u);++t,s[f]="dGPU"}}if(d>1||i>1||t>1)for(var y=0,c=0,r=0,f=0;f<p.length;++f){var o=p[f],u=g(o);if("cpu"===u)d>1&&(++y,s[f]="CPU #"+y);else if("igpu"===u)i>1&&(++c,s[f]="iGPU #"+c);else{if("dgpu"!==u)throw new Error("Impossible device classification: "+u);t>1&&(++t,s[f]="dGPU #"+r)}}}},g=function(e){try{var f=e.getInfo(l.DEVICE_TYPE);if(f===l.DEVICE_TYPE_CPU)return"cpu";if(f===l.DEVICE_TYPE_GPU){var o=e.getInfo(l.DEVICE_HOST_UNIFIED_MEMORY);return o?"igpu":"dgpu"}}catch(n){}return"unknown"},x=function(){if(-1===y){var e=b();if(0===e.length)return y=-2;for(var f=[],o=0;o<e.length;++o){var n=e[o],d=g(n);if("dgpu"===d)return y=o,o;f.push(d)}for(var o=0;o<e.length;++o)if("igpu"===f[o])return y=o,o;for(var o=0;o<e.length;++o)if("cpu"===f[o])return y=o,o}return y},j=function(e){var f={set:{f32:e.createKernel("set_f32"),f64:e.createKernel("set_f64")},linspace:{f32:e.createKernel("linspace_f32"),f64:e.createKernel("linspace_f64")},repeat:{f32:e.createKernel("repeat_f32"),f64:e.createKernel("repeat_f64")},add:{f32:e.createKernel("add_f32"),f64:e.createKernel("add_f64")},sub:{f32:e.createKernel("sub_f32"),f64:e.createKernel("sub_f64")},mul:{f32:e.createKernel("mul_f32"),f64:e.createKernel("mul_f64")},div:{f32:e.createKernel("div_f32"),f64:e.createKernel("div_f64")},addc:{f32:e.createKernel("addc_f32"),f64:e.createKernel("addc_f64")},subc:{f32:e.createKernel("subc_f32"),f64:e.createKernel("subc_f64")},subrc:{f32:e.createKernel("subrc_f32"),f64:e.createKernel("subrc_f64")},mulc:{f32:e.createKernel("mulc_f32"),f64:e.createKernel("mulc_f64")},divc:{f32:e.createKernel("divc_f32"),f64:e.createKernel("divc_f64")},divrc:{f32:e.createKernel("divrc_f32"),f64:e.createKernel("divrc_f64")},neg:{f32:e.createKernel("neg_f32"),f64:e.createKernel("neg_f64")},abs:{f32:e.createKernel("abs_f32"),f64:e.createKernel("abs_f64")},exp:{f32:e.createKernel("exp_f32"),f64:e.createKernel("exp_f64")},log:{f32:e.createKernel("log_f32"),f64:e.createKernel("log_f64")},sqrt:{f32:e.createKernel("sqrt_f32"),f64:e.createKernel("sqrt_f64")},square:{f32:e.createKernel("square_f32"),f64:e.createKernel("square_f64")},sum:{f32:e.createKernel("sum_f32_gpu"),f64:e.createKernel("sum_f64_gpu")},min:{f32:e.createKernel("min_f32_gpu"),f64:e.createKernel("min_f64_gpu")},max:{f32:e.createKernel("max_f32_gpu"),f64:e.createKernel("max_f64_gpu")},asum:{f32:e.createKernel("asum_f32"),f64:e.createKernel("asum_f64")},amin:{f32:e.createKernel("amin_f32"),f64:e.createKernel("amin_f64")},amax:{f32:e.createKernel("amax_f32"),f64:e.createKernel("amax_f64")},dot:{f32:e.createKernel("dot_f32"),f64:e.createKernel("dot_f64")}};return f};o.getAvailableDevices=function(){return o.isUsable()?s:[]},o.getDefaultDevice=function(){var e=x();return 0>e?null:s[e]},o.isSupported=function(){return null!==c()},o.isUsable=function(){var e=c();if(null===e)return!1;var f=b();return 0!==f.length},o.prototype.empty=function(e,f){if(e=i.checkShape(e),"undefined"==typeof f)f=new d("f64");else if(!(f instanceof d))throw new TypeError(f+" is not an instance of DataType");var o=new n(e,f,this);return o._buffer=this.context.createBuffer(l.MEM_READ_WRITE,o.length*f.size),o},o.prototype.zeros=function(e,f){if(e=i.checkShape(e),"undefined"==typeof f)f=new d("f64");else if(!(f instanceof d))throw new TypeError(f+" is not an instance of DataType");var o=new n(e,f,this);o._buffer=this.context.createBuffer(l.MEM_READ_WRITE,o.length*f.size);var t=this.kernels.set[f.type];return t.setArg(0,new Uint32Array([o.length])),t.setArg(1,o._buffer),t.setArg(2,new f.arrayType([0])),this.queue.enqueueNDRangeKernel(t,1,[0],[o.length],t.getWorkGroupInfo(this.device,l.KERNEL_WORK_GROUP_SIZE)),o},o.prototype.ones=function(e,f){if(e=i.checkShape(e),"undefined"==typeof f)f=new d("f64");else if(!(f instanceof d))throw new TypeError(f+" is not an instance of DataType");var o=new n(e,f,this);o._buffer=this.context.createBuffer(l.MEM_READ_WRITE,o.length*f.size);var t=this.kernels.set[f.type];return t.setArg(0,new Uint32Array([o.length])),t.setArg(1,o._buffer),t.setArg(2,new f.arrayType([1])),this.queue.enqueueNDRangeKernel(t,1,[0],[o.length],t.getWorkGroupInfo(this.device,l.KERNEL_WORK_GROUP_SIZE)),o},o.prototype.array=function(e,f){f="undefined"==typeof f?new d("f64"):i.checkDataType(f);var o=[];i.discoverArrayShapeRecursive(e,o,0);var u=new n(o,f,this),p=new f.arrayType(u.length);return i.copyArrayDataRecursive(p,e,o,0,0),t?u._buffer=this.context.createBuffer(l.MEM_READ_WRITE,p.byteLength,p):(u._buffer=this.context.createBuffer(l.MEM_READ_WRITE,p.byteLength),this.queue.enqueueWriteBuffer(u._buffer,!1,0,p.byteLength,p)),u},o.prototype.linspace=function(e,f,o,t){if(!i.isReal(e))throw new TypeError(e+" is not a real number");if(!i.isReal(f))throw new TypeError(f+" is not a real number");if("undefined"==typeof o)o=50;else{if(!i.isInt(o))throw new TypeError(o+" is not an integer");if(0>=o)throw new RangeError("The number of samples must be positive")}if("undefined"==typeof t&&(t=!0),t&&1===o)throw new RangeError("The number of samples must be a least 2 (for start and end points)");var u=new d("f64"),p=new n([o],u,this);p._buffer=this.context.createBuffer(l.MEM_READ_WRITE,o*u.size);var s=f-e,y=t?o-1:o,c=s/y,r=this.kernels.linspace[u.type];return r.setArg(0,new Uint32Array([p.length])),r.setArg(1,p._buffer),r.setArg(2,new u.arrayType([e])),r.setArg(3,new u.arrayType([c])),this.queue.enqueueNDRangeKernel(r,1,[0],[p.length],r.getWorkGroupInfo(this.device,l.KERNEL_WORK_GROUP_SIZE)),p},o.prototype._invalidate=function(e){null!==e._buffer&&("undefined"!=typeof e._buffer.release&&e._buffer.release(),e._buffer=null)},o.prototype.fetch=function(){if(0===arguments.length)throw new Error("Callback argument missing");var e=arguments[arguments.length-1];if(1===arguments.length)throw new Error("At least one NDArray argument expected");for(var f=0;f<arguments.length-1;f++)if(!(arguments[f]instanceof n))throw new TypeError("Argument "+f+" is not an NDArray");var o=arguments.length-1,d=new Array(o);if(this.asyncCallbacks)for(var i=[],f=0;o>f;f++){var t=arguments[f];!function(f,n,u,p){var s=new p(t.length),y=r();i.push(y),f.enqueueReadBuffer(t._buffer,!1,0,s.byteLength,s,null,y),y.setCallback(l.COMPLETE,function(){y.release(),d[n]=s,0===--o&&(e.apply(null,d),f.flush())})}(this.queue,f,t.shape,t.dataType.arrayType),l.waitForEvents(i)}else{for(var f=0;o>f;f++){var t=arguments[f],u=new t.dataType.arrayType(t.length);this.queue.enqueueReadBuffer(t._buffer,!0,0,u.byteLength,u),d[f]=u}e.apply(null,d)}},o.prototype.get=function(){if(0===arguments.length)throw new Error("Callback argument missing");var e=arguments[arguments.length-1];if(1===arguments.length)throw new Error("At least one NDArray argument expected");for(var f=0;f<arguments.length-1;f++)if(!(arguments[f]instanceof n))throw new TypeError("Argument "+f+" is not an NDArray");var o=arguments.length-1,d=new Array(o);if(this.asyncCallbacks)for(var t=[],f=0;o>f;f++){var u=arguments[f];!function(f,n,p,s){var y=new s(u.length),c=r();t.push(c),f.enqueueReadBuffer(u._buffer,!1,0,y.byteLength,y,null,c),0===p.length?c.setCallback(l.COMPLETE,function(){c.release(),d[n]=y[0],0===--o&&(e.apply(null,d),f.flush())}):c.setCallback(l.COMPLETE,function(){c.release();var t=new Array(p[0]);i.createArrayRecursive(new s(y),t,p,0,0),d[n]=t,0===--o&&(e.apply(null,d),f.flush())})}(this.queue,f,u.shape,u.dataType.arrayType),l.waitForEvents(t)}else{for(var f=0;o>f;f++){var u=arguments[f],p=new u.dataType.arrayType(u.length);if(this.queue.enqueueReadBuffer(u._buffer,!0,0,p.byteLength,p),0===u.shape.length)d[f]=p[0];else{var s=new Array(u.shape[0]);i.createArrayRecursive(new u.dataType.arrayType(p),s,u.shape,0,0),d[f]=s}}e.apply(null,d)}},o.prototype.barrier=function(e){var f=r();if(this.queue.enqueueMarker(f),this.asyncCallbacks){var o=this.queue;f.setCallback(l.COMPLETE,function(){f.release(),e(),o.flush()}),l.waitForEvents([f])}else l.waitForEvents([f]),e()},o.prototype.reshape=function(e,f){if(f=i.checkShape(f),i.computeLength(f)!==e.length)throw new RangeError("The shape is not compatible with the array");var o=new n(f,e.dataType,this);return e._decRef()?(o._buffer=this.context.createBuffer(webcl.MEM_READ_WRITE,o.length*o.dataType.size),this.queue.enqueueCopyBuffer(e._buffer,o._buffer,0,0,o.length*o.dataType.size)):(o._buffer=e._buffer,e._buffer=null),o},o.prototype.repeat=function(e,f,o,d){i.checkNDArray(e,"a"),f=i.checkRepeats(f),o=i.checkAxis(o,e.shape.length);var t=e.shape,u=t.slice(0);u[o]*=f,e._decRef();try{"undefined"==typeof d?(d=new n(u,e.dataType,this),d._buffer=this.context.createBuffer(l.MEM_READ_WRITE,d.length*d.dataType.size)):(i.checkNDArray(d,"out"),i.checkShapesCompatibility(d.shape,u),i.checkDataTypesCompatibility(e.dataType,d.dataType),d._incRef());var p=i.computeOuterStride(t,o),s=t[o],y=i.computeInnerStride(t,o),c=this.kernels.repeat[e.dataType.type];c.setArg(0,new Uint32Array([s])),c.setArg(1,new Uint32Array([y])),c.setArg(2,new Uint32Array([f])),c.setArg(3,e._buffer),c.setArg(4,d._buffer),this.queue.enqueueNDRangeKernel(c,3,[0,0,0],[p,s,y],c.getWorkGroupInfo(this.device,l.KERNEL_WORK_GROUP_SIZE))}catch(r){throw e._incRef(),r}return e._tryInvalidate(),d};var v=function(e,f,o,d,t,u,p){var s=null,y=null,c=null,r=null;if(e instanceof n){if(c=e._buffer,s=e.shape,y=e.dataType,f instanceof n)r=f._buffer,i.checkShapesCompatibility(e.shape,f.shape),i.checkDataTypesCompatibility(e.dataType,f.dataType);else if(!i.isNumber(f))throw new TypeError("Unsupported type of b")}else{if(!i.isNumber(e))throw new TypeError("Unsupported type of a");i.checkNDArray(f,"b"),r=f._buffer,s=f.shape,y=f.dataType}e instanceof n&&e._decRef(),f instanceof n&&f._decRef();try{if("undefined"==typeof o?(o=new n(s,y,d),e instanceof n&&!e._hasRefs()?(o._buffer=e._buffer,e._buffer=null):f instanceof n&&!f._hasRefs()?(o._buffer=f._buffer,f._buffer=null):o._buffer=d.context.createBuffer(l.MEM_READ_WRITE,o.length*o.dataType.size)):(i.checkNDArray(o,"out"),i.checkShapesCompatibility(s,o.shape),i.checkDataTypesCompatibility(y,o.dataType),o._incRef()),e instanceof n)if(f instanceof n){var a=t[y.type];a.setArg(0,new Uint32Array([o.length])),a.setArg(1,c),a.setArg(2,r),a.setArg(3,o._buffer),d.queue.enqueueNDRangeKernel(a,1,[0],[o.length],a.getWorkGroupInfo(d.device,l.KERNEL_WORK_GROUP_SIZE))}else{var a=u[y.type];a.setArg(0,new Uint32Array([o.length])),a.setArg(1,c),a.setArg(2,new y.arrayType([f])),a.setArg(3,o._buffer),d.queue.enqueueNDRangeKernel(a,1,[0],[o.length],a.getWorkGroupInfo(d.device,l.KERNEL_WORK_GROUP_SIZE))}else{var a=p[y.type];a.setArg(0,new Uint32Array([o.length])),a.setArg(1,r),a.setArg(2,new y.arrayType([e])),a.setArg(3,o._buffer),d.queue.enqueueNDRangeKernel(a,1,[0],[o.length],a.getWorkGroupInfo(d.device,l.KERNEL_WORK_GROUP_SIZE))}}catch(w){throw e instanceof n&&e._incRef(),f instanceof n&&f._incRef(),w}return e instanceof n&&e._tryInvalidate(),f instanceof n&&f._tryInvalidate(),o},h=function(e,f,o,d){i.checkNDArray(e,"a"),e._decRef();var t=e._buffer;try{"undefined"==typeof f?(f=new n(e.shape,e.dataType,o),e instanceof n&&!e._hasRefs()?(f._buffer=e._buffer,e._buffer=null):f._buffer=o.context.createBuffer(l.MEM_READ_WRITE,f.length*f.dataType.size)):(i.checkNDArray(f,"out"),i.checkShapesCompatibility(e.shape,f.shape),i.checkDataTypesCompatibility(e.dataType,f.dataType),f._incRef());var u=d[e.dataType.type];u.setArg(0,new Uint32Array([f.length])),u.setArg(1,t),u.setArg(2,f._buffer),o.queue.enqueueNDRangeKernel(u,1,[0],[f.length],u.getWorkGroupInfo(o.device,l.KERNEL_WORK_GROUP_SIZE))}catch(p){throw e._incRef(),p}return e._tryInvalidate(),f},k=function(e,f,o,d,t,u){if(i.checkNDArray(e,"a"),"undefined"==typeof f){"undefined"==typeof o?(o=new n([],e.dataType,d),o._buffer=d.context.createBuffer(l.MEM_READ_WRITE,e.dataType.size)):(i.checkNDArray(o,"out"),i.checkShapesCompatibility([],o.shape),i.checkDataTypesCompatibility(e.dataType,o.dataType),o._incRef());var p=e.length,s=Math.min(Math.min(d.deviceInfo.maxWorkGroupSize,d.deviceInfo.maxWorkItemSizes[0]),d.deviceInfo.localMemorySize/e.dataType.size),y=16,c=t[e.dataType.type];if(s*y>p)c.setArg(0,new Uint32Array([p])),c.setArg(1,e._buffer),c.setArg(2,new Uint32Array([s*e.dataType.size])),c.setArg(3,o._buffer),d.queue.enqueueNDRangeKernel(c,1,[0],[s],[s]);else{var r=d.deviceInfo.maxComputeUnits,a=c.getWorkGroupInfo(d.device,l.KERNEL_PREFERRED_WORK_GROUP_SIZE_MULTIPLE),w=d.context.createBuffer(l.MEM_READ_WRITE,r*e.dataType.size);c.setArg(0,new Uint32Array([p])),c.setArg(1,e._buffer),c.setArg(2,new Uint32Array([s*e.dataType.size])),c.setArg(3,w),d.queue.enqueueNDRangeKernel(c,1,[0],[s*r],[s]);var b=Math.min(s,i.roundUp(r,a));c.setArg(0,new Uint32Array([r])),c.setArg(1,w),c.setArg(2,new Uint32Array([b*e.dataType.size])),c.setArg(3,o._buffer),d.queue.enqueueNDRangeKernel(c,1,[0],[b],[b]),w.release()}return e._tryRelease(),o}f=i.checkAxis(f,e.shape.length);var m=i.computeAxisReductionOutShape(e.shape,f);"undefined"==typeof o?(o=new n(m,e.dataType,d),o._buffer=d.context.createBuffer(l.MEM_READ_WRITE,e.dataType.size*o.length)):(i.checkNDArray(o,"out"),i.checkShapesCompatibility([],o.shape),i.checkDataTypesCompatibility(e.dataType,o.dataType),o._incRef());var g=i.computeOuterStride(e.shape,f),x=e.shape[f],j=i.computeInnerStride(e.shape,f),c=u[e.dataType.type];return c.setArg(0,new Uint32Array([x])),c.setArg(1,e._buffer),c.setArg(2,o._buffer),d.queue.enqueueNDRangeKernel(c,2,[0,0],[g,j],c.getWorkGroupInfo(d.device,l.KERNEL_WORK_GROUP_SIZE)),e._tryRelease(),o};o.prototype.add=function(e,f,o){return v(e,f,o,this,this.kernels.add,this.kernels.addc,this.kernels.addc)},o.prototype.sub=function(e,f,o){return v(e,f,o,this,this.kernels.sub,this.kernels.subc,this.kernels.subrc)},o.prototype.mul=function(e,f,o){return v(e,f,o,this,this.kernels.mul,this.kernels.mulc,this.kernels.mulc)},o.prototype.div=function(e,f,o){return v(e,f,o,this,this.kernels.div,this.kernels.divc,this.kernels.divrc)},o.prototype.neg=function(e,f){return h(e,f,this,this.kernels.neg)},o.prototype.abs=function(e,f){return h(e,f,this,this.kernels.abs)},o.prototype.exp=function(e,f){return h(e,f,this,this.kernels.exp)},o.prototype.log=function(e,f){return h(e,f,this,this.kernels.log)},o.prototype.sqrt=function(e,f){return h(e,f,this,this.kernels.sqrt)},o.prototype.square=function(e,f){return h(e,f,this,this.kernels.square)},o.prototype.min=function(e,f,o){return k(e,f,o,this,this.kernels.min,this.kernels.amin)},o.prototype.max=function(e,f,o){return k(e,f,o,this,this.kernels.max,this.kernels.amax)},o.prototype.sum=function(e,f,o){return k(e,f,o,this,this.kernels.sum,this.kernels.asum)},o.prototype.dot=function(e,f,o){i.checkNDArray(e,"a"),i.checkNDArray(f,"b"),i.checkDataTypesCompatibility(e.dataType,f.dataType);var d=Math.max(e.shape.length-1,0),t=Math.max(f.shape.length-2,0),u=e.shape[d];if(u!==f.shape[t])throw new RangeError("Arrays have incompatible reduction dimensions");for(var p=[],s=1,y=1,c=1,r=0;d>r;r++)p.push(e.shape[r]),s*=e.shape[r];for(var r=0;r<f.shape.length;r++){var a=f.shape[r];t>r?(y*=a,p.push(a)):r>t&&(c*=a,p.push(a))}"undefined"==typeof o?o=this.empty(p,e.dataType):o instanceof n&&(i.checkNDArray(o,"out"),i.checkShapesCompatibility(o.shape,p),i.checkDataTypesCompatibility(o.dataType,e.dataType),i.checkDifferentNDArrays(e,o,"a","out"),i.checkDifferentNDArrays(f,o,"b","out"),o._incRef());var w=this.kernels.dot[o.dataType.type];return w.setArg(0,new Uint32Array([u])),w.setArg(1,e._buffer),w.setArg(2,f._buffer),w.setArg(3,o._buffer),this.queue.enqueueNDRangeKernel(w,3,[0,0,0],[s,y,c],w.getWorkGroupInfo(this.device,l.KERNEL_WORK_GROUP_SIZE)),e._tryRelease(),f._tryRelease(),o},f.exports=o},{"../DataType":1,"../NDArray":2,"../util":12}],14:[function(){},{}],15:[function(e,f,o){(function(e){function f(e,f){for(var o=0,n=e.length-1;n>=0;n--){var d=e[n];"."===d?e.splice(n,1):".."===d?(e.splice(n,1),o++):o&&(e.splice(n,1),o--)}if(f)for(;o--;o)e.unshift("..");return e}function n(e,f){if(e.filter)return e.filter(f);for(var o=[],n=0;n<e.length;n++)f(e[n],n,e)&&o.push(e[n]);return o}var d=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return d.exec(e).slice(1)};o.resolve=function(){for(var o="",d=!1,i=arguments.length-1;i>=-1&&!d;i--){var t=i>=0?arguments[i]:e.cwd();if("string"!=typeof t)throw new TypeError("Arguments to path.resolve must be strings");t&&(o=t+"/"+o,d="/"===t.charAt(0))}return o=f(n(o.split("/"),function(e){return!!e}),!d).join("/"),(d?"/":"")+o||"."},o.normalize=function(e){var d=o.isAbsolute(e),i="/"===t(e,-1);return e=f(n(e.split("/"),function(e){return!!e}),!d).join("/"),e||d||(e="."),e&&i&&(e+="/"),(d?"/":"")+e},o.isAbsolute=function(e){return"/"===e.charAt(0)},o.join=function(){var e=Array.prototype.slice.call(arguments,0);return o.normalize(n(e,function(e){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},o.relative=function(e,f){function n(e){for(var f=0;f<e.length&&""===e[f];f++);for(var o=e.length-1;o>=0&&""===e[o];o--);return f>o?[]:e.slice(f,o-f+1)}e=o.resolve(e).substr(1),f=o.resolve(f).substr(1);for(var d=n(e.split("/")),i=n(f.split("/")),t=Math.min(d.length,i.length),u=t,l=0;t>l;l++)if(d[l]!==i[l]){u=l;break}for(var p=[],l=u;l<d.length;l++)p.push("..");return p=p.concat(i.slice(u)),p.join("/")},o.sep="/",o.delimiter=":",o.dirname=function(e){var f=i(e),o=f[0],n=f[1];return o||n?(n&&(n=n.substr(0,n.length-1)),o+n):"."},o.basename=function(e,f){var o=i(e)[2];return f&&o.substr(-1*f.length)===f&&(o=o.substr(0,o.length-f.length)),o},o.extname=function(e){return i(e)[3]};var t="b"==="ab".substr(-1)?function(e,f,o){return e.substr(f,o)}:function(e,f,o){return 0>f&&(f=e.length+f),e.substr(f,o)}}).call(this,e("JkpR2F"))},{JkpR2F:16}],16:[function(e,f){function o(){}var n=f.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,f="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(f){var o=[];return window.addEventListener("message",function(e){var f=e.source;if((f===window||null===f)&&"process-tick"===e.data&&(e.stopPropagation(),o.length>0)){var n=o.shift();n()}},!0),function(e){o.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=o,n.addListener=o,n.once=o,n.off=o,n.removeListener=o,n.removeAllListeners=o,n.emit=o,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],17:[function(f,o){!function(n){"use strict";function d(e){var o={};return o.VERSION="3.2.2",o.WIRE_TYPES={},o.WIRE_TYPES.VARINT=0,o.WIRE_TYPES.BITS64=1,o.WIRE_TYPES.LDELIM=2,o.WIRE_TYPES.STARTGROUP=3,o.WIRE_TYPES.ENDGROUP=4,o.WIRE_TYPES.BITS32=5,o.PACKABLE_WIRE_TYPES=[o.WIRE_TYPES.VARINT,o.WIRE_TYPES.BITS64,o.WIRE_TYPES.BITS32],o.TYPES={int32:{name:"int32",wireType:o.WIRE_TYPES.VARINT},uint32:{name:"uint32",wireType:o.WIRE_TYPES.VARINT},sint32:{name:"sint32",wireType:o.WIRE_TYPES.VARINT},int64:{name:"int64",wireType:o.WIRE_TYPES.VARINT},uint64:{name:"uint64",wireType:o.WIRE_TYPES.VARINT},sint64:{name:"sint64",wireType:o.WIRE_TYPES.VARINT},bool:{name:"bool",wireType:o.WIRE_TYPES.VARINT},"double":{name:"double",wireType:o.WIRE_TYPES.BITS64},string:{name:"string",wireType:o.WIRE_TYPES.LDELIM},bytes:{name:"bytes",wireType:o.WIRE_TYPES.LDELIM},fixed32:{name:"fixed32",wireType:o.WIRE_TYPES.BITS32},sfixed32:{name:"sfixed32",wireType:o.WIRE_TYPES.BITS32},fixed64:{name:"fixed64",wireType:o.WIRE_TYPES.BITS64},sfixed64:{name:"sfixed64",wireType:o.WIRE_TYPES.BITS64},"float":{name:"float",wireType:o.WIRE_TYPES.BITS32},"enum":{name:"enum",wireType:o.WIRE_TYPES.VARINT},message:{name:"message",wireType:o.WIRE_TYPES.LDELIM},group:{name:"group",wireType:o.WIRE_TYPES.STARTGROUP}},o.ID_MIN=1,o.ID_MAX=536870911,o.ByteBuffer=e,o.Long=e.Long||null,o.convertFieldsToCamelCase=!1,o.Util=function(){Object.create||(Object.create=function(e){function f(){}if(arguments.length>1)throw Error("Object.create polyfill only accepts the first parameter.");return f.prototype=e,new f});var e={};e.IS_NODE=!1;try{e.IS_NODE="function"==typeof f&&"function"==typeof f("fs").readFileSync&&"function"==typeof f("path").resolve}catch(o){}return e.XHR=function(){for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],f=null,o=0;o<e.length;o++){try{f=e[o]()}catch(n){continue}break}if(!f)throw Error("XMLHttpRequest is not supported");return f},e.fetch=function(o,n){if(n&&"function"!=typeof n&&(n=null),e.IS_NODE)if(n)f("fs").readFile(o,function(e,f){n(e?null:""+f)});else try{return f("fs").readFileSync(o)}catch(d){return null}else{var i=e.XHR();if(i.open("GET",o,n?!0:!1),i.setRequestHeader("Accept","text/plain"),"function"==typeof i.overrideMimeType&&i.overrideMimeType("text/plain"),!n)return i.send(null),200==i.status||0==i.status&&"string"==typeof i.responseText?i.responseText:null;if(i.onreadystatechange=function(){4==i.readyState&&n(200==i.status||0==i.status&&"string"==typeof i.responseText?i.responseText:null)},4==i.readyState)return;i.send(null)}},e.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},e}(),o.Lang={OPEN:"{",CLOSE:"}",OPTOPEN:"[",OPTCLOSE:"]",OPTEND:",",EQUAL:"=",END:";",STRINGOPEN:'"',STRINGCLOSE:'"',STRINGOPEN_SQ:"'",STRINGCLOSE_SQ:"'",COPTOPEN:"(",COPTCLOSE:")",DELIM:/[\s\{\}=;\[\],'"\(\)]/g,RULE:/^(?:required|optional|repeated)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+|([0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?))$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0x[0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^[0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?$/,ID:/^(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/['"]([^'"\\]*(\\.[^"\\]*)*)['"]/g,BOOL:/^(?:true|false)$/i},o.DotProto=function(e,f){var o={},n=function(e){this.source=""+e,this.index=0,this.line=1,this.stack=[],this.readingString=!1,this.stringEndsWith=f.STRINGCLOSE};n.prototype._readString=function(){f.STRING.lastIndex=this.index-1;var e;if(null!==(e=f.STRING.exec(this.source))){var o=e[1];return this.index=f.STRING.lastIndex,this.stack.push(this.stringEndsWith),o}throw Error("Illegal string value at line "+this.line+", index "+this.index)},n.prototype.next=function(){if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(this.readingString)return this.readingString=!1,this._readString();var e,o;do{for(e=!1;f.WHITESPACE.test(o=this.source.charAt(this.index));)if(this.index++,"\n"===o&&this.line++,this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if("/"===this.source.charAt(++this.index)){for(;"\n"!==this.source.charAt(this.index);)if(this.index++,this.index==this.source.length)return null;this.index++,this.line++,e=!0}else{if("*"!==this.source.charAt(this.index))throw Error("Invalid comment at line "+this.line+": /"+this.source.charAt(this.index)+" ('/' or '*' expected)");for(o="";o+(o=this.source.charAt(this.index))!=="*/";)if(this.index++,"\n"===o&&this.line++,this.index===this.source.length)return null;this.index++,e=!0}}while(e);if(this.index===this.source.length)return null;var n=this.index;f.DELIM.lastIndex=0;var d=f.DELIM.test(this.source.charAt(n));if(d)++n;else for(++n;n<this.source.length&&!f.DELIM.test(this.source.charAt(n));)n++;var i=this.source.substring(this.index,this.index=n);return i===f.STRINGOPEN?(this.readingString=!0,this.stringEndsWith=f.STRINGCLOSE):i===f.STRINGOPEN_SQ&&(this.readingString=!0,this.stringEndsWith=f.STRINGCLOSE_SQ),i},n.prototype.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},n.prototype.toString=function(){return"Tokenizer("+this.index+"/"+this.source.length+" at line "+this.line+")"},o.Tokenizer=n;var d=function(e){this.tn=new n(e)};return d.prototype.parse=function(){for(var e,f={name:"[ROOT]","package":null,messages:[],enums:[],imports:[],options:{},services:[]},o=!0;e=this.tn.next();)switch(e){case"package":if(!o||null!==f["package"])throw Error("Illegal package at line "+this.tn.line);f["package"]=this._parsePackage(e);break;case"import":if(!o)throw Error("Illegal import at line "+this.tn.line);f.imports.push(this._parseImport(e));break;case"message":this._parseMessage(f,null,e),o=!1;break;case"enum":this._parseEnum(f,e),o=!1;break;case"option":if(!o)throw Error("Illegal option at line "+this.tn.line);this._parseOption(f,e);break;case"service":this._parseService(f,e);break;case"extend":this._parseExtend(f,e);break;case"syntax":this._parseIgnoredStatement(f,e);break;default:throw Error("Illegal token at line "+this.tn.line+": "+e)}return delete f.name,f},d.prototype._parseNumber=function(e){var o=1;if("-"==e.charAt(0)&&(o=-1,e=e.substring(1)),f.NUMBER_DEC.test(e))return o*parseInt(e,10);if(f.NUMBER_HEX.test(e))return o*parseInt(e.substring(2),16);if(f.NUMBER_OCT.test(e))return o*parseInt(e.substring(1),8);if(f.NUMBER_FLT.test(e))return o*parseFloat(e);throw Error("Illegal number at line "+this.tn.line+": "+(0>o?"-":"")+e)},d.prototype._parseId=function(e,o){var n=-1,d=1;if("-"==e.charAt(0)&&(d=-1,e=e.substring(1)),f.NUMBER_DEC.test(e))n=parseInt(e);else if(f.NUMBER_HEX.test(e))n=parseInt(e.substring(2),16);else{if(!f.NUMBER_OCT.test(e))throw Error("Illegal ID at line "+this.tn.line+": "+(0>d?"-":"")+e);n=parseInt(e.substring(1),8)}if(n=d*n|0,!o&&0>n)throw Error("Illegal ID at line "+this.tn.line+": "+(0>d?"-":"")+e);return n},d.prototype._parsePackage=function(e){if(e=this.tn.next(),!f.TYPEREF.test(e))throw Error("Illegal package at line "+this.tn.line+": "+e);var o=e;if(e=this.tn.next(),e!=f.END)throw Error("Illegal end of package at line "+this.tn.line+": "+e+" ('"+f.END+"' expected)");return o},d.prototype._parseImport=function(e){if(e=this.tn.next(),"public"===e&&(e=this.tn.next()),e!==f.STRINGOPEN&&e!==f.STRINGOPEN_SQ)throw Error("Illegal import at line "+this.tn.line+": "+e+" ('"+f.STRINGOPEN+"' or '"+f.STRINGOPEN_SQ+"' expected)");var o=this.tn.next();if(e=this.tn.next(),e!==this.tn.stringEndsWith)throw Error("Illegal import at line "+this.tn.line+": "+e+" ('"+this.tn.stringEndsWith+"' expected)");if(e=this.tn.next(),e!==f.END)throw Error("Illegal import at line "+this.tn.line+": "+e+" ('"+f.END+"' expected)");return o},d.prototype._parseOption=function(e,o){o=this.tn.next();var n=!1;if(o==f.COPTOPEN&&(n=!0,o=this.tn.next()),!f.TYPEREF.test(o)&&!/google\.protobuf\./.test(o))throw Error("Illegal option in message "+e.name+" at line "+this.tn.line+": "+o);var d=o;if(o=this.tn.next(),n){if(o!==f.COPTCLOSE)throw Error("Illegal option in message "+e.name+", option "+d+" at line "+this.tn.line+": "+o+" ('"+f.COPTCLOSE+"' expected)");d="("+d+")",o=this.tn.next(),f.FQTYPEREF.test(o)&&(d+=o,o=this.tn.next())}if(o!==f.EQUAL)throw Error("Illegal option operator in message "+e.name+", option "+d+" at line "+this.tn.line+": "+o+" ('"+f.EQUAL+"' expected)");var i;if(o=this.tn.next(),o===f.STRINGOPEN||o===f.STRINGOPEN_SQ){if(i=this.tn.next(),o=this.tn.next(),o!==this.tn.stringEndsWith)throw Error("Illegal end of option value in message "+e.name+", option "+d+" at line "+this.tn.line+": "+o+" ('"+this.tn.stringEndsWith+"' expected)")}else if(f.NUMBER.test(o))i=this._parseNumber(o,!0);else if(f.BOOL.test(o))i="true"===o;else{if(!f.TYPEREF.test(o))throw Error("Illegal option value in message "+e.name+", option "+d+" at line "+this.tn.line+": "+o);i=o}if(o=this.tn.next(),o!==f.END)throw Error("Illegal end of option in message "+e.name+", option "+d+" at line "+this.tn.line+": "+o+" ('"+f.END+"' expected)");e.options[d]=i},d.prototype._parseIgnoredStatement=function(e,o){for(var n;;){if(n=this.tn.next(),null===n)throw Error("Unexpected EOF in "+e.name+", "+o+" (ignored) at line "+this.tn.line);if(n===f.END)break}},d.prototype._parseService=function(e,o){if(o=this.tn.next(),!f.NAME.test(o))throw Error("Illegal service name at line "+this.tn.line+": "+o);var n=o,d={name:n,rpc:{},options:{}};if(o=this.tn.next(),o!==f.OPEN)throw Error("Illegal OPEN after service "+n+" at line "+this.tn.line+": "+o+" ('"+f.OPEN+"' expected)");do if(o=this.tn.next(),"option"===o)this._parseOption(d,o);else if("rpc"===o)this._parseServiceRPC(d,o);else if(o!==f.CLOSE)throw Error("Illegal type for service "+n+" at line "+this.tn.line+": "+o);while(o!==f.CLOSE);e.services.push(d)},d.prototype._parseServiceRPC=function(e,o){var n=o;if(o=this.tn.next(),!f.NAME.test(o))throw Error("Illegal RPC method name in service "+e.name+" at line "+this.tn.line+": "+o);var d=o,i={request:null,response:null,options:{}};if(o=this.tn.next(),o!==f.COPTOPEN)throw Error("Illegal start of request type in RPC service "+e.name+"#"+d+" at line "+this.tn.line+": "+o+" ('"+f.COPTOPEN+"' expected)");if(o=this.tn.next(),!f.TYPEREF.test(o))throw Error("Illegal request type in RPC service "+e.name+"#"+d+" at line "+this.tn.line+": "+o);if(i.request=o,o=this.tn.next(),o!=f.COPTCLOSE)throw Error("Illegal end of request type in RPC service "+e.name+"#"+d+" at line "+this.tn.line+": "+o+" ('"+f.COPTCLOSE+"' expected)");if(o=this.tn.next(),"returns"!==o.toLowerCase())throw Error("Illegal request/response delimiter in RPC service "+e.name+"#"+d+" at line "+this.tn.line+": "+o+" ('returns' expected)");if(o=this.tn.next(),o!=f.COPTOPEN)throw Error("Illegal start of response type in RPC service "+e.name+"#"+d+" at line "+this.tn.line+": "+o+" ('"+f.COPTOPEN+"' expected)");if(o=this.tn.next(),i.response=o,o=this.tn.next(),o!==f.COPTCLOSE)throw Error("Illegal end of response type in RPC service "+e.name+"#"+d+" at line "+this.tn.line+": "+o+" ('"+f.COPTCLOSE+"' expected)");
if(o=this.tn.next(),o===f.OPEN){do if(o=this.tn.next(),"option"===o)this._parseOption(i,o);else if(o!==f.CLOSE)throw Error("Illegal start of option in RPC service "+e.name+"#"+d+" at line "+this.tn.line+": "+o+" ('option' expected)");while(o!==f.CLOSE);this.tn.peek()===f.END&&this.tn.next()}else if(o!==f.END)throw Error("Illegal method delimiter in RPC service "+e.name+"#"+d+" at line "+this.tn.line+": "+o+" ('"+f.END+"' or '"+f.OPEN+"' expected)");"undefined"==typeof e[n]&&(e[n]={}),e[n][d]=i},d.prototype._parseMessage=function(e,o,n){var d={},i="group"===n;if(n=this.tn.next(),!f.NAME.test(n))throw Error("Illegal "+(i?"group":"message")+" name"+(e?" in message "+e.name:"")+" at line "+this.tn.line+": "+n);if(d.name=n,i){if(n=this.tn.next(),n!==f.EQUAL)throw Error("Illegal id assignment after group "+d.name+" at line "+this.tn.line+": "+n+" ('"+f.EQUAL+"' expected)");n=this.tn.next();try{o.id=this._parseId(n)}catch(t){throw Error("Illegal field id value for group "+d.name+"#"+o.name+" at line "+this.tn.line+": "+n)}d.isGroup=!0}if(d.fields=[],d.enums=[],d.messages=[],d.options={},n=this.tn.next(),n===f.OPTOPEN&&o&&(this._parseFieldOptions(d,o,n),n=this.tn.next()),n!==f.OPEN)throw Error("Illegal OPEN after "+(i?"group":"message")+" "+d.name+" at line "+this.tn.line+": "+n+" ('"+f.OPEN+"' expected)");for(;;){if(n=this.tn.next(),n===f.CLOSE){n=this.tn.peek(),n===f.END&&this.tn.next();break}if(f.RULE.test(n))this._parseMessageField(d,n);else if("enum"===n)this._parseEnum(d,n);else if("message"===n)this._parseMessage(d,null,n);else if("option"===n)this._parseOption(d,n);else if("extensions"===n)d.extensions=this._parseExtensions(d,n);else{if("extend"!==n)throw Error("Illegal token in message "+d.name+" at line "+this.tn.line+": "+n+" (type or '"+f.CLOSE+"' expected)");this._parseExtend(d,n)}}return e.messages.push(d),d},d.prototype._parseMessageField=function(e,o){var n={},d=null;if(n.rule=o,n.options={},o=this.tn.next(),"group"===o){if(d=this._parseMessage(e,n,o),!/^[A-Z]/.test(d.name))throw Error("Group names must start with a capital letter");n.type=d.name,n.name=d.name.toLowerCase(),o=this.tn.peek(),o===f.END&&this.tn.next()}else{if(!f.TYPE.test(o)&&!f.TYPEREF.test(o))throw Error("Illegal field type in message "+e.name+" at line "+this.tn.line+": "+o);if(n.type=o,o=this.tn.next(),!f.NAME.test(o))throw Error("Illegal field name in message "+e.name+" at line "+this.tn.line+": "+o);if(n.name=o,o=this.tn.next(),o!==f.EQUAL)throw Error("Illegal field id assignment in message "+e.name+"#"+n.name+" at line "+this.tn.line+": "+o+" ('"+f.EQUAL+"' expected)");o=this.tn.next();try{n.id=this._parseId(o)}catch(i){throw Error("Illegal field id value in message "+e.name+"#"+n.name+" at line "+this.tn.line+": "+o)}if(o=this.tn.next(),o===f.OPTOPEN&&(this._parseFieldOptions(e,n,o),o=this.tn.next()),o!==f.END)throw Error("Illegal field delimiter in message "+e.name+"#"+n.name+" at line "+this.tn.line+": "+o+" ('"+f.END+"' expected)")}e.fields.push(n)},d.prototype._parseFieldOptions=function(e,o,n){for(var d=!0;;){if(n=this.tn.next(),n===f.OPTCLOSE)break;if(n===f.OPTEND){if(d)throw Error("Illegal start of message field options in message "+e.name+"#"+o.name+" at line "+this.tn.line+": "+n);n=this.tn.next()}this._parseFieldOption(e,o,n),d=!1}},d.prototype._parseFieldOption=function(e,o,n){var d=!1;if(n===f.COPTOPEN&&(n=this.tn.next(),d=!0),!f.TYPEREF.test(n))throw Error("Illegal field option in message "+e.name+"#"+o.name+" at line "+this.tn.line+": "+n);var i=n;if(n=this.tn.next(),d){if(n!==f.COPTCLOSE)throw Error("Illegal custom field option name delimiter in message "+e.name+"#"+o.name+" at line "+this.tn.line+": "+n+" (')' expected)");i="("+i+")",n=this.tn.next(),f.FQTYPEREF.test(n)&&(i+=n,n=this.tn.next())}if(n!==f.EQUAL)throw Error("Illegal field option operation in message "+e.name+"#"+o.name+" at line "+this.tn.line+": "+n+" ('=' expected)");var t;if(n=this.tn.next(),n===f.STRINGOPEN||n===f.STRINGOPEN_SQ){if(t=this.tn.next(),n=this.tn.next(),n!=this.tn.stringEndsWith)throw Error("Illegal end of field value in message "+e.name+"#"+o.name+", option "+i+" at line "+this.tn.line+": "+n+" ('"+this.tn.stringEndsWith+"' expected)")}else if(f.NUMBER.test(n,!0))t=this._parseNumber(n,!0);else if(f.BOOL.test(n))t="true"===n.toLowerCase();else{if(!f.TYPEREF.test(n))throw Error("Illegal field option value in message "+e.name+"#"+o.name+", option "+i+" at line "+this.tn.line+": "+n);t=n}o.options[i]=t},d.prototype._parseEnum=function(e,o){var n={};if(o=this.tn.next(),!f.NAME.test(o))throw Error("Illegal enum name in message "+e.name+" at line "+this.tn.line+": "+o);if(n.name=o,o=this.tn.next(),o!==f.OPEN)throw Error("Illegal OPEN after enum "+n.name+" at line "+this.tn.line+": "+o);for(n.values=[],n.options={};;){if(o=this.tn.next(),o===f.CLOSE){o=this.tn.peek(),o===f.END&&this.tn.next();break}if("option"==o)this._parseOption(n,o);else{if(!f.NAME.test(o))throw Error("Illegal enum value name in enum "+n.name+" at line "+this.tn.line+": "+o);this._parseEnumValue(n,o)}}e.enums.push(n)},d.prototype._parseEnumValue=function(e,o){var n={};if(n.name=o,o=this.tn.next(),o!==f.EQUAL)throw Error("Illegal enum value operator in enum "+e.name+" at line "+this.tn.line+": "+o+" ('"+f.EQUAL+"' expected)");o=this.tn.next();try{n.id=this._parseId(o,!0)}catch(d){throw Error("Illegal enum value id in enum "+e.name+" at line "+this.tn.line+": "+o)}if(e.values.push(n),o=this.tn.next(),o===f.OPTOPEN){var i={options:{}};this._parseFieldOptions(e,i,o),o=this.tn.next()}if(o!==f.END)throw Error("Illegal enum value delimiter in enum "+e.name+" at line "+this.tn.line+": "+o+" ('"+f.END+"' expected)")},d.prototype._parseExtensions=function(o,n){var d=[];if(n=this.tn.next(),d.push("min"===n?e.ID_MIN:"max"===n?e.ID_MAX:this._parseNumber(n)),n=this.tn.next(),"to"!==n)throw Error("Illegal extensions delimiter in message "+o.name+" at line "+this.tn.line+" ('to' expected)");if(n=this.tn.next(),d.push("min"===n?e.ID_MIN:"max"===n?e.ID_MAX:this._parseNumber(n)),n=this.tn.next(),n!==f.END)throw Error("Illegal extension delimiter in message "+o.name+" at line "+this.tn.line+": "+n+" ('"+f.END+"' expected)");return d},d.prototype._parseExtend=function(e,o){if(o=this.tn.next(),!f.TYPEREF.test(o))throw Error("Illegal extended message name at line "+this.tn.line+": "+o);var n={};if(n.ref=o,n.fields=[],o=this.tn.next(),o!==f.OPEN)throw Error("Illegal OPEN in extend "+n.name+" at line "+this.tn.line+": "+o+" ('"+f.OPEN+"' expected)");for(;;){if(o=this.tn.next(),o===f.CLOSE){o=this.tn.peek(),o==f.END&&this.tn.next();break}if(!f.RULE.test(o))throw Error("Illegal token in extend "+n.name+" at line "+this.tn.line+": "+o+" (rule or '"+f.CLOSE+"' expected)");this._parseMessageField(n,o)}return e.messages.push(n),n},d.prototype.toString=function(){return"Parser"},o.Parser=d,o}(o,o.Lang),o.Reflect=function(f){function o(e,n){var d=n.readVarint32(),i=7&d,t=d>>3;switch(i){case f.WIRE_TYPES.VARINT:do d=n.readUint8();while(128===(128&d));break;case f.WIRE_TYPES.BITS64:n.offset+=8;break;case f.WIRE_TYPES.LDELIM:d=n.readVarint32(),n.offset+=d;break;case f.WIRE_TYPES.STARTGROUP:o(t,n);break;case f.WIRE_TYPES.ENDGROUP:if(t===e)return!1;throw Error("Illegal GROUPEND after unknown group: "+t+" ("+e+" expected)");case f.WIRE_TYPES.BITS32:n.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+i)}return!0}function n(e,o){if(e&&"number"==typeof e.low&&"number"==typeof e.high&&"boolean"==typeof e.unsigned&&e.low===e.low&&e.high===e.high)return new f.Long(e.low,e.high,"undefined"==typeof o?e.unsigned:o);if("string"==typeof e)return f.Long.fromString(e,o||!1,10);if("number"==typeof e)return f.Long.fromNumber(e,o||!1);throw Error("not convertible to Long")}var d={},i=function(e,f){this.parent=e,this.name=f,this.className};i.prototype.fqn=function(){for(var e=this.name,f=this;;){if(f=f.parent,null==f)break;e=f.name+"."+e}return e},i.prototype.toString=function(e){return(e?this.className+" ":"")+this.fqn()},i.prototype.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},d.T=i;var t=function(e,f,o){i.call(this,e,f),this.className="Namespace",this.children=[],this.options=o||{}};t.prototype=Object.create(i.prototype),t.prototype.getChildren=function(e){if(e=e||null,null==e)return this.children.slice();for(var f=[],o=0,n=this.children.length;n>o;++o)this.children[o]instanceof e&&(e===u.Field&&this.children[o]instanceof u.ExtensionField||f.push(this.children[o]));return f},t.prototype.addChild=function(e){var f;if(f=this.getChild(e.name))if(f instanceof u.Field&&f.name!==f.originalName&&!this.hasChild(f.originalName))f.name=f.originalName;else{if(!(e instanceof u.Field&&e.name!==e.originalName)||this.hasChild(e.originalName))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},t.prototype.hasChild=function(e){return this._indexOf(e)>-1},t.prototype.getChild=function(e){var f=this._indexOf(e);return f>-1?this.children[f]:null},t.prototype._indexOf=function(e){for(var f="number"==typeof e?"id":"name",o=0;o<this.children.length;o++)if("undefined"!=typeof this.children[o][f]&&this.children[o][f]==e)return o;return-1},t.prototype.resolve=function(e,f){var o=e.split("."),n=this,i=0;if(""==o[i]){for(;null!=n.parent;)n=n.parent;i++}var t;do{do{if(t=n.getChild(o[i]),!t||!(t instanceof d.T)||f&&t instanceof d.Message.Field){n=null;break}n=t,i++}while(i<o.length);if(null!=n)break;if(null!==this.parent)return this.parent.resolve(e,f)}while(null!=n);return n},t.prototype.build=function(){for(var e,f={},o=this.getChildren(),n=0,d=o.length;d>n;++n)e=o[n],e instanceof t&&(f[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(f,"$options",{value:this.buildOpt()}),f},t.prototype.buildOpt=function(){for(var e={},f=Object.keys(this.options),o=0;o<f.length;o++){var n=f[o],d=this.options[f[o]];e[n]=d}return e},t.prototype.getOption=function(e){return"undefined"==typeof e?this.options:"undefined"!=typeof this.options[e]?this.options[e]:null},d.Namespace=t;var u=function(e,o,n,d){t.call(this,e,o,n),this.className="Message",this.extensions=[f.ID_MIN,f.ID_MAX],this.clazz=null,this.isGroup=!!d};u.prototype=Object.create(t.prototype),u.prototype.build=function(o){if(this.clazz&&!o)return this.clazz;for(var n=function(f,o){function n(f,o){var d={};for(var i in f)f.hasOwnProperty(i)&&(null===f[i]||"object"!=typeof f[i]?d[i]=f[i]:f[i]instanceof e?o&&(d[i]=f.toBuffer()):d[i]=n(f[i],o));return d}var d=o.getChildren(f.Reflect.Message.Field),i=function(o){f.Builder.Message.call(this);var n,i;for(n=0;n<d.length;n++)i=d[n],this[i.name]=i.repeated?[]:null;for(n=0;n<d.length;n++)if(i=d[n],"undefined"!=typeof i.options["default"])try{this.$set(i.name,i.options["default"])}catch(t){throw Error("[INTERNAL] "+t)}if(1!=arguments.length||"object"!=typeof o||"function"==typeof o.encode||f.Util.isArray(o)||o instanceof e||o instanceof ArrayBuffer||f.Long&&o instanceof f.Long)for(n=0;n<arguments.length;n++)n<d.length&&this.$set(d[n].name,arguments[n]);else{var u=Object.keys(o);for(n=0;n<u.length;n++)this.$set(u[n],o[u[n]])}};i.prototype=Object.create(f.Builder.Message.prototype),i.prototype.add=function(e,n,d){var i=o.getChild(e);if(!i)throw Error(this+"#"+e+" is undefined");if(!(i instanceof f.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+i.toString(!0));if(!i.repeated)throw Error(this+"#"+e+" is not a repeated field");null===this[i.name]&&(this[i.name]=[]),this[i.name].push(d?n:i.verifyValue(n,!0))},i.prototype.$add=i.prototype.add,i.prototype.set=function(e,n,d){var i=o.getChild(e);if(!i)throw Error(this+"#"+e+" is not a field: undefined");if(!(i instanceof f.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+i.toString(!0));this[i.name]=d?n:i.verifyValue(n)},i.prototype.$set=i.prototype.set,i.prototype.get=function(e){var n=o.getChild(e);if(!(n&&n instanceof f.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(n instanceof f.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+n.toString(!0));return this[n.name]},i.prototype.$get=i.prototype.get;for(var t=0;t<d.length;t++){var u=d[t];!function(e){var f=e.originalName.replace(/(_[a-zA-Z])/g,function(e){return e.toUpperCase().replace("_","")});f=f.substring(0,1).toUpperCase()+f.substring(1);var n=e.originalName.replace(/([A-Z])/g,function(e){return"_"+e});o.hasChild("set"+f)||(i.prototype["set"+f]=function(f){this.$set(e.name,f)}),o.hasChild("set_"+n)||(i.prototype["set_"+n]=function(f){this.$set(e.name,f)}),o.hasChild("get"+f)||(i.prototype["get"+f]=function(){return this.$get(e.name)}),o.hasChild("get_"+n)||(i.prototype["get_"+n]=function(){return this.$get(e.name)})}(u)}i.prototype.encode=function(f){var n=!1;f||(f=new e,n=!0);var d=f.littleEndian;try{return o.encode(this,f.LE()),(n?f.flip():f).LE(d)}catch(i){throw f.LE(d),i}},i.prototype.calculate=function(){return o.calculate(this)},i.prototype.encodeDelimited=function(f){var n=!1;f||(f=new e,n=!0);var d=(new e).LE();return o.encode(this,d).flip(),f.writeVarint32(d.remaining()),f.append(d),n?f.flip():f},i.prototype.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},i.prototype.toArrayBuffer=i.prototype.encodeAB,i.prototype.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},i.prototype.toBuffer=i.prototype.encodeNB,i.prototype.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},i.prototype.toBase64=i.prototype.encode64,i.prototype.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},i.prototype.toHex=i.prototype.encodeHex,i.prototype.toRaw=function(e){return n(this,!!e)},i.decode=function(f,n){"string"==typeof f&&(f=e.wrap(f,n?n:"base64")),f=f instanceof e?f:e.wrap(f);var d=f.littleEndian;try{var i=o.decode(f.LE());return f.LE(d),i}catch(t){throw f.LE(d),t}},i.decodeDelimited=function(f,n){if("string"==typeof f&&(f=e.wrap(f,n?n:"base64")),f=f instanceof e?f:e.wrap(f),f.remaining()<1)return null;var d=f.offset,i=f.readVarint32();if(f.remaining()<i)return f.offset=d,null;try{var t=o.decode(f.slice(f.offset,f.offset+i).LE());return f.offset+=i,t}catch(u){throw f.offset+=i,u}},i.decode64=function(e){return i.decode(e,"base64")},i.decodeHex=function(e){return i.decode(e,"hex")},i.prototype.toString=function(){return o.toString()};return Object.defineProperty&&Object.defineProperty(i,"$options",{value:o.buildOpt()}),i}(f,this),d=this.getChildren(),i=0;i<d.length;i++)if(d[i]instanceof s)n[d[i].name]=d[i].build();else if(d[i]instanceof u)n[d[i].name]=d[i].build();else if(!(d[i]instanceof u.Field))throw Error("Illegal reflect child of "+this.toString(!0)+": "+d[i].toString(!0));return this.clazz=n},u.prototype.encode=function(e,f){for(var o,n=this.getChildren(u.Field),d=null,i=0;i<n.length;i++)o=e.$get(n[i].name),n[i].required&&null===o?null===d&&(d=n[i]):n[i].encode(o,f);if(null!==d){var t=Error("Missing at least one required field for "+this.toString(!0)+": "+d);throw t.encoded=f,t}return f},u.prototype.calculate=function(e){for(var f,o=this.getChildren(u.Field),n=0,d=0;d<o.length;d++){if(f=e.$get(o[d].name),o[d].required&&null===f)throw Error("Missing at least one required field for "+this.toString(!0)+": "+o[d]);n+=o[d].calculate(f)}return n},u.prototype.decode=function(e,n,d){n="number"==typeof n?n:-1;for(var i,t,u,l=e.offset,p=new this.clazz;e.offset<l+n||-1==n&&e.remaining()>0;){if(i=e.readVarint32(),t=7&i,u=i>>3,t===f.WIRE_TYPES.ENDGROUP){if(u!==d)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+u+" ("+(d?d+" expected":"not a group")+")");break}var s=this.getChild(u);if(s)s.repeated&&!s.options.packed?p.$add(s.name,s.decode(t,e),!0):p.$set(s.name,s.decode(t,e),!0);else switch(t){case f.WIRE_TYPES.VARINT:e.readVarint32();break;case f.WIRE_TYPES.BITS32:e.offset+=4;break;case f.WIRE_TYPES.BITS64:e.offset+=8;break;case f.WIRE_TYPES.LDELIM:var y=e.readVarint32();e.offset+=y;break;case f.WIRE_TYPES.STARTGROUP:for(;o(u,e););break;default:throw Error("Illegal wire type for unknown field "+u+" in "+this.toString(!0)+"#decode: "+t)}}for(var c=this.getChildren(f.Reflect.Field),r=0;r<c.length;r++)if(c[r].required&&null===p[c[r].name]){var a=Error("Missing at least one required field for "+this.toString(!0)+": "+c[r].name);throw a.decoded=p,a}return p},d.Message=u;var l=function(e,o,n,d,t,u){i.call(this,e,d),this.className="Message.Field",this.required="required"==o,this.repeated="repeated"==o,this.type=n,this.resolvedType=null,this.id=t,this.options=u||{},this.originalName=this.name,f.convertFieldsToCamelCase&&(this.name=this.name.replace(/_([a-zA-Z])/g,function(e,f){return f.toUpperCase()}))};l.prototype=Object.create(i.prototype),l.prototype.verifyValue=function(o,d){d=d||!1;var i=function(e,f){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+f+")")}.bind(this);if(null===o)return this.required&&i(typeof o,"required"),null;var t;if(this.repeated&&!d){f.Util.isArray(o)||(o=[o]);var u=[];for(t=0;t<o.length;t++)u.push(this.verifyValue(o[t],!0));return u}switch(!this.repeated&&f.Util.isArray(o)&&i(typeof o,"no array expected"),this.type){case f.TYPES.int32:case f.TYPES.sint32:case f.TYPES.sfixed32:return("number"!=typeof o||o===o&&o%1!==0)&&i(typeof o,"not an integer"),o>4294967295?0|o:o;case f.TYPES.uint32:case f.TYPES.fixed32:return("number"!=typeof o||o===o&&o%1!==0)&&i(typeof o,"not an integer"),0>o?o>>>0:o;case f.TYPES.int64:case f.TYPES.sint64:case f.TYPES.sfixed64:if(f.Long)try{return n(o,!1)}catch(l){i(typeof o,l.message)}else i(typeof o,"requires Long.js");case f.TYPES.uint64:case f.TYPES.fixed64:if(f.Long)try{return n(o,!0)}catch(l){i(typeof o,l.message)}else i(typeof o,"requires Long.js");case f.TYPES.bool:return"boolean"!=typeof o&&i(typeof o,"not a boolean"),o;case f.TYPES["float"]:case f.TYPES["double"]:return"number"!=typeof o&&i(typeof o,"not a number"),o;case f.TYPES.string:return"string"==typeof o||o&&o instanceof String||i(typeof o,"not a string"),""+o;case f.TYPES.bytes:return o&&o instanceof e?o:e.wrap(o);case f.TYPES["enum"]:var p=this.resolvedType.getChildren(s.Value);for(t=0;t<p.length;t++){if(p[t].name==o)return p[t].id;if(p[t].id==o)return p[t].id}i(o,"not a valid enum value");case f.TYPES.group:case f.TYPES.message:return o&&"object"==typeof o||i(typeof o,"object expected"),o instanceof this.resolvedType.clazz?o:new this.resolvedType.clazz(o)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+o+" (undefined type "+this.type+")")},l.prototype.encode=function(o,n){if(o=this.verifyValue(o),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===o||this.repeated&&0==o.length)return n;try{if(this.repeated){var d;if(this.options.packed&&f.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){n.writeVarint32(this.id<<3|f.WIRE_TYPES.LDELIM),n.ensureCapacity(n.offset+=1);var i=n.offset;for(d=0;d<o.length;d++)this.encodeValue(o[d],n);var t=n.offset-i,u=e.calculateVarint32(t);if(u>1){var l=n.slice(i,n.offset);i+=u-1,n.offset=i,n.append(l)}n.writeVarint32(t,i-u)}else for(d=0;d<o.length;d++)n.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(o[d],n)}else n.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(o,n)}catch(p){throw Error("Illegal value for "+this.toString(!0)+": "+o+" ("+p+")")}return n},l.prototype.encodeValue=function(o,n){if(null===o)return n;switch(this.type){case f.TYPES.int32:0>o?n.writeVarint64(o):n.writeVarint32(o);break;case f.TYPES.uint32:n.writeVarint32(o);break;case f.TYPES.sint32:n.writeVarint32ZigZag(o);break;case f.TYPES.fixed32:n.writeUint32(o);break;case f.TYPES.sfixed32:n.writeInt32(o);break;case f.TYPES.int64:case f.TYPES.uint64:n.writeVarint64(o);break;case f.TYPES.sint64:n.writeVarint64ZigZag(o);break;case f.TYPES.fixed64:n.writeUint64(o);break;case f.TYPES.sfixed64:n.writeInt64(o);break;case f.TYPES.bool:n.writeVarint32("string"==typeof o?"false"===o.toLowerCase()?0:!!o:o?1:0);break;case f.TYPES["enum"]:n.writeVarint32(o);break;case f.TYPES["float"]:n.writeFloat32(o);break;case f.TYPES["double"]:n.writeFloat64(o);break;case f.TYPES.string:n.writeVString(o);break;case f.TYPES.bytes:if(o.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+o.remaining()+" bytes remaining");var d=o.offset;n.writeVarint32(o.remaining()),n.append(o),o.offset=d;break;case f.TYPES.message:var i=(new e).LE();this.resolvedType.encode(o,i),n.writeVarint32(i.offset),n.append(i.flip());break;case f.TYPES.group:this.resolvedType.encode(o,n),n.writeVarint32(this.id<<3|f.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+o+" (unknown type)")}return n},l.prototype.calculate=function(o){if(o=this.verifyValue(o),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===o||this.repeated&&0==o.length)return 0;var n=0;try{if(this.repeated){var d,i;if(this.options.packed&&f.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(n+=e.calculateVarint32(this.id<<3|f.WIRE_TYPES.LDELIM),i=0,d=0;d<o.length;d++)i+=this.calculateValue(o[d]);n+=e.calculateVarint32(i),n+=i}else for(d=0;d<o.length;d++)n+=e.calculateVarint32(this.id<<3|this.type.wireType),n+=this.calculateValue(o[d])}else n+=e.calculateVarint32(this.id<<3|this.type.wireType),n+=this.calculateValue(o)}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+o+" ("+t+")")}return n},l.prototype.calculateValue=function(o){if(null===o)return 0;var n;switch(this.type){case f.TYPES.int32:return 0>o?e.calculateVarint64(o):e.calculateVarint32(o);case f.TYPES.uint32:return e.calculateVarint32(o);case f.TYPES.sint32:return e.calculateVarint32(e.zigZagEncode32(o));case f.TYPES.fixed32:case f.TYPES.sfixed32:case f.TYPES["float"]:return 4;case f.TYPES.int64:case f.TYPES.uint64:return e.calculateVarint64(o);case f.TYPES.sint64:return e.calculateVarint64(e.zigZagEncode64(o));case f.TYPES.fixed64:case f.TYPES.sfixed64:return 8;case f.TYPES.bool:return 1;case f.TYPES["enum"]:return e.calculateVarint32(o);case f.TYPES["double"]:return 8;case f.TYPES.string:return n=e.calculateUTF8Bytes(o),e.calculateVarint32(n)+n;case f.TYPES.bytes:if(o.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+o.remaining()+" bytes remaining");return e.calculateVarint32(o.remaining())+o.remaining();case f.TYPES.message:return n=this.resolvedType.calculate(o),e.calculateVarint32(n)+n;case f.TYPES.group:return n=this.resolvedType.calculate(o),n+e.calculateVarint32(this.id<<3|f.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+o+" (unknown type)")},l.prototype.decode=function(e,o,n){var d,i;if(e!=this.type.wireType&&(n||e!=f.WIRE_TYPES.LDELIM||!this.repeated))throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==f.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&f.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!n){i=o.readVarint32(),i=o.offset+i;for(var t=[];o.offset<i;)t.push(this.decode(this.type.wireType,o,!0));return t}switch(this.type){case f.TYPES.int32:return 0|o.readVarint32();case f.TYPES.uint32:return o.readVarint32()>>>0;case f.TYPES.sint32:return 0|o.readVarint32ZigZag();case f.TYPES.fixed32:return o.readUint32()>>>0;case f.TYPES.sfixed32:return 0|o.readInt32();case f.TYPES.int64:return o.readVarint64();case f.TYPES.uint64:return o.readVarint64().toUnsigned();case f.TYPES.sint64:return o.readVarint64ZigZag();case f.TYPES.fixed64:return o.readUint64();case f.TYPES.sfixed64:return o.readInt64();case f.TYPES.bool:return!!o.readVarint32();case f.TYPES["enum"]:return o.readVarint32();case f.TYPES["float"]:return o.readFloat();case f.TYPES["double"]:return o.readDouble();case f.TYPES.string:return o.readVString();case f.TYPES.bytes:if(i=o.readVarint32(),o.remaining()<i)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+i+" required but got only "+o.remaining());return d=o.clone(),d.limit=d.offset+i,o.offset+=i,d;case f.TYPES.message:return i=o.readVarint32(),this.resolvedType.decode(o,i);case f.TYPES.group:return this.resolvedType.decode(o,-1,this.id)}throw Error("[INTERNAL] Illegal wire type for "+this.toString(!0)+": "+e)},d.Message.Field=l;var p=function(e,f,o,n,d,i){l.call(this,e,f,o,n,d,i)};p.prototype=Object.create(l.prototype),d.Message.ExtensionField=p;var s=function(e,f,o){t.call(this,e,f,o),this.className="Enum",this.object=null};s.prototype=Object.create(t.prototype),s.prototype.build=function(){for(var e={},f=this.getChildren(s.Value),o=0;o<f.length;o++)e[f[o].name]=f[o].id;return Object.defineProperty&&Object.defineProperty(e,"$options",{value:this.buildOpt()}),this.object=e},d.Enum=s;var y=function(e,f,o){i.call(this,e,f),this.className="Enum.Value",this.id=o};y.prototype=Object.create(i.prototype),d.Enum.Value=y;var c=function(e,f,o){t.call(this,e,f,o),this.className="Service",this.clazz=null};c.prototype=Object.create(t.prototype),c.prototype.build=function(e){return this.clazz&&!e?this.clazz:this.clazz=function(e,f){var o=function(f){e.Builder.Service.call(this),this.rpcImpl=f||function(e,f,o){setTimeout(o.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}};o.prototype=Object.create(e.Builder.Service.prototype),Object.defineProperty&&(Object.defineProperty(o,"$options",{value:f.buildOpt()}),Object.defineProperty(o.prototype,"$options",{value:o.$options}));for(var n=f.getChildren(e.Reflect.Service.RPCMethod),d=0;d<n.length;d++)!function(e){o.prototype[e.name]=function(o,n){try{if(!(o&&o instanceof e.resolvedRequestType.clazz))return void setTimeout(n.bind(this,Error("Illegal request type provided to service method "+f.name+"#"+e.name)),0);this.rpcImpl(e.fqn(),o,function(o,d){if(o)return void n(o);try{d=e.resolvedResponseType.clazz.decode(d)}catch(i){}return d&&d instanceof e.resolvedResponseType.clazz?void n(null,d):void n(Error("Illegal response type received in service method "+f.name+"#"+e.name))})}catch(d){setTimeout(n.bind(this,d),0)}},o[e.name]=function(f,n,d){new o(f)[e.name](n,d)},Object.defineProperty&&(Object.defineProperty(o[e.name],"$options",{value:e.buildOpt()}),Object.defineProperty(o.prototype[e.name],"$options",{value:o[e.name].$options}))}(n[d]);return o}(f,this)},d.Service=c;var r=function(e,f,o){i.call(this,e,f),this.className="Service.Method",this.options=o||{}};r.prototype=Object.create(i.prototype),r.prototype.buildOpt=t.prototype.buildOpt,d.Service.Method=r;var a=function(e,f,o,n,d){r.call(this,e,f,d),this.className="Service.RPCMethod",this.requestName=o,this.responseName=n,this.resolvedRequestType=null,this.resolvedResponseType=null};return a.prototype=Object.create(r.prototype),d.Service.RPCMethod=a,d}(o),o.Builder=function(e,o,n){var d=function(){this.ns=new n.Namespace(null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null};return d.prototype.reset=function(){this.ptr=this.ns},d.prototype.define=function(e,f){if("string"!=typeof e||!o.TYPEREF.test(e))throw Error("Illegal package: "+e);var d,i=e.split(".");for(d=0;d<i.length;d++)if(!o.NAME.test(i[d]))throw Error("Illegal package: "+i[d]);for(d=0;d<i.length;d++)this.ptr.hasChild(i[d])||this.ptr.addChild(new n.Namespace(this.ptr,i[d],f)),this.ptr=this.ptr.getChild(i[d]);return this},d.isValidMessage=function(f){if("string"!=typeof f.name||!o.NAME.test(f.name))return!1;if("undefined"!=typeof f.values||"undefined"!=typeof f.rpc)return!1;var n;if("undefined"!=typeof f.fields){if(!e.Util.isArray(f.fields))return!1;var i,t=[];for(n=0;n<f.fields.length;n++){if(!d.isValidMessageField(f.fields[n]))return!1;if(i=parseInt(f.fields[n].id,10),t.indexOf(i)>=0)return!1;t.push(i)}t=null}if("undefined"!=typeof f.enums){if(!e.Util.isArray(f.enums))return!1;for(n=0;n<f.enums.length;n++)if(!d.isValidEnum(f.enums[n]))return!1}if("undefined"!=typeof f.messages){if(!e.Util.isArray(f.messages))return!1;for(n=0;n<f.messages.length;n++)if(!d.isValidMessage(f.messages[n])&&!d.isValidExtend(f.messages[n]))return!1}return"undefined"==typeof f.extensions||e.Util.isArray(f.extensions)&&2===f.extensions.length&&"number"==typeof f.extensions[0]&&"number"==typeof f.extensions[1]?!0:!1},d.isValidMessageField=function(e){if("string"!=typeof e.rule||"string"!=typeof e.name||"string"!=typeof e.type||"undefined"==typeof e.id)return!1;if(!(o.RULE.test(e.rule)&&o.NAME.test(e.name)&&o.TYPEREF.test(e.type)&&o.ID.test(""+e.id)))return!1;if("undefined"!=typeof e.options){if("object"!=typeof e.options)return!1;for(var f,n=Object.keys(e.options),d=0;d<n.length;d++)if("string"!=typeof(f=n[d])||"string"!=typeof e.options[f]&&"number"!=typeof e.options[f]&&"boolean"!=typeof e.options[f])return!1}return!0},d.isValidEnum=function(f){if("string"!=typeof f.name||!o.NAME.test(f.name))return!1;if("undefined"==typeof f.values||!e.Util.isArray(f.values)||0==f.values.length)return!1;for(var n=0;n<f.values.length;n++){if("object"!=typeof f.values[n])return!1;if("string"!=typeof f.values[n].name||"undefined"==typeof f.values[n].id)return!1;if(!o.NAME.test(f.values[n].name)||!o.NEGID.test(""+f.values[n].id))return!1}return!0},d.prototype.create=function(f){if(!f)return this;if(e.Util.isArray(f)||(f=[f]),0==f.length)return this;var o,i,t,u,l,p=[];for(p.push(f);p.length>0;){if(f=p.pop(),!e.Util.isArray(f))throw Error("Not a valid namespace: "+JSON.stringify(f));for(;f.length>0;){if(o=f.shift(),d.isValidMessage(o)){if(i=new n.Message(this.ptr,o.name,o.options,o.isGroup),o.fields&&o.fields.length>0)for(u=0;u<o.fields.length;u++){if(i.hasChild(o.fields[u].id))throw Error("Duplicate field id in message "+i.name+": "+o.fields[u].id);if(o.fields[u].options){for(t=Object.keys(o.fields[u].options),l=0;l<t.length;l++){if("string"!=typeof t[l])throw Error("Illegal field option name in message "+i.name+"#"+o.fields[u].name+": "+t[l]);if("string"!=typeof o.fields[u].options[t[l]]&&"number"!=typeof o.fields[u].options[t[l]]&&"boolean"!=typeof o.fields[u].options[t[l]])throw Error("Illegal field option value in message "+i.name+"#"+o.fields[u].name+"#"+t[l]+": "+o.fields[u].options[t[l]])}t=null}i.addChild(new n.Message.Field(i,o.fields[u].rule,o.fields[u].type,o.fields[u].name,o.fields[u].id,o.fields[u].options))}if(t=[],"undefined"!=typeof o.enums&&o.enums.length>0)for(u=0;u<o.enums.length;u++)t.push(o.enums[u]);if(o.messages&&o.messages.length>0)for(u=0;u<o.messages.length;u++)t.push(o.messages[u]);if(o.extensions&&(i.extensions=o.extensions,i.extensions[0]<e.ID_MIN&&(i.extensions[0]=e.ID_MIN),i.extensions[1]>e.ID_MAX&&(i.extensions[1]=e.ID_MAX)),this.ptr.addChild(i),t.length>0){p.push(f),f=t,t=null,this.ptr=i,i=null;continue}t=null,i=null}else if(d.isValidEnum(o)){for(i=new n.Enum(this.ptr,o.name,o.options),u=0;u<o.values.length;u++)i.addChild(new n.Enum.Value(i,o.values[u].name,o.values[u].id));this.ptr.addChild(i),i=null}else if(d.isValidService(o)){i=new n.Service(this.ptr,o.name,o.options);for(u in o.rpc)o.rpc.hasOwnProperty(u)&&i.addChild(new n.Service.RPCMethod(i,u,o.rpc[u].request,o.rpc[u].response,o.rpc[u].options));this.ptr.addChild(i),i=null}else{if(!d.isValidExtend(o))throw Error("Not a valid definition: "+JSON.stringify(o));if(i=this.ptr.resolve(o.ref))for(u=0;u<o.fields.length;u++){if(i.hasChild(o.fields[u].id))throw Error("Duplicate extended field id in message "+i.name+": "+o.fields[u].id);if(o.fields[u].id<i.extensions[0]||o.fields[u].id>i.extensions[1])throw Error("Illegal extended field id in message "+i.name+": "+o.fields[u].id+" ("+i.extensions.join(" to ")+" expected)");i.addChild(new n.Message.Field(i,o.fields[u].rule,o.fields[u].type,o.fields[u].name,o.fields[u].id,o.fields[u].options))}else if(!/\.?google\.protobuf\./.test(o.ref))throw Error("Extended message "+o.ref+" is not defined")
}o=null}f=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},d.prototype["import"]=function(o,n){if("string"==typeof n){if(e.Util.IS_NODE&&(n=f("path").resolve(n)),this.files[n]===!0)return this.reset(),this;this.files[n]=!0}if(o.imports&&o.imports.length>0){var d,i="/",t=!1;"object"==typeof n?(this.importRoot=n.root,t=!0,d=this.importRoot,n=n.file,(d.indexOf("\\")>=0||n.indexOf("\\")>=0)&&(i="\\")):"string"==typeof n?this.importRoot?d=this.importRoot:n.indexOf("/")>=0?(d=n.replace(/\/[^\/]*$/,""),""===d&&(d="/")):n.indexOf("\\")>=0?(d=n.replace(/\\[^\\]*$/,""),i="\\"):d=".":d=null;for(var u=0;u<o.imports.length;u++)if("string"==typeof o.imports[u]){if(!d)throw Error("Cannot determine import root: File name is unknown");var l=o.imports[u];if(/^google\/protobuf\//.test(l))continue;if(l=d+i+l,this.files[l]===!0)continue;/\.proto$/i.test(l)&&!e.DotProto&&(l=l.replace(/\.proto$/,".json"));var p=e.Util.fetch(l);if(null===p)throw Error("Failed to import '"+l+"' in '"+n+"': File not found");/\.json$/i.test(l)?this["import"](JSON.parse(p+""),l):this["import"](new e.DotProto.Parser(p+"").parse(),l)}else n?/\.(\w+)$/.test(n)?this["import"](o.imports[u],n.replace(/^(.+)\.(\w+)$/,function(e,f,o){return f+"_import"+u+"."+o})):this["import"](o.imports[u],n+"_import"+u):this["import"](o.imports[u]);t&&(this.importRoot=null)}return o.messages&&(o["package"]&&this.define(o["package"],o.options),this.create(o.messages),this.reset()),o.enums&&(o["package"]&&this.define(o["package"],o.options),this.create(o.enums),this.reset()),o.services&&(o["package"]&&this.define(o["package"],o.options),this.create(o.services),this.reset()),o["extends"]&&(o["package"]&&this.define(o["package"],o.options),this.create(o["extends"]),this.reset()),this},d.isValidService=function(e){return!("string"!=typeof e.name||!o.NAME.test(e.name)||"object"!=typeof e.rpc)},d.isValidExtend=function(f){if("string"!=typeof f.ref||!o.TYPEREF.test(f.ref))return!1;var n;if("undefined"!=typeof f.fields){if(!e.Util.isArray(f.fields))return!1;var i,t=[];for(n=0;n<f.fields.length;n++){if(!d.isValidMessageField(f.fields[n]))return!1;if(i=parseInt(f.id,10),t.indexOf(i)>=0)return!1;t.push(i)}t=null}return!0},d.prototype.resolveAll=function(){var f;if(null!=this.ptr&&"object"!=typeof this.ptr.type){if(this.ptr instanceof n.Namespace)for(var d=this.ptr.getChildren(),i=0;i<d.length;i++)this.ptr=d[i],this.resolveAll();else if(this.ptr instanceof n.Message.Field)if(o.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!o.TYPEREF.test(this.ptr.type))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(f=this.ptr.parent.resolve(this.ptr.type,!0),!f)throw Error("Unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=f,f instanceof n.Enum)this.ptr.type=e.TYPES["enum"];else{if(!(f instanceof n.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=f.isGroup?e.TYPES.group:e.TYPES.message}}else if(this.ptr instanceof e.Reflect.Enum.Value);else{if(!(this.ptr instanceof e.Reflect.Service.Method))throw Error("Illegal object in namespace: "+typeof this.ptr+":"+this.ptr);if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("Illegal service type in "+this.ptr.toString(!0));if(f=this.ptr.parent.resolve(this.ptr.requestName),!(f&&f instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=f,f=this.ptr.parent.resolve(this.ptr.responseName),!(f&&f instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=f}this.reset()}},d.prototype.build=function(e){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null==this.result&&(this.result=this.ns.build()),e){for(var f=e.split("."),o=this.result,n=0;n<f.length;n++){if(!o[f[n]]){o=null;break}o=o[f[n]]}return o}return this.result},d.prototype.lookup=function(e){return e?this.ns.resolve(e):this.ns},d.prototype.toString=function(){return"Builder"},d.Message=function(){},d.Service=function(){},d}(o,o.Lang,o.Reflect),o.loadProto=function(e,f,n){return("string"==typeof f||f&&"string"==typeof f.file&&"string"==typeof f.root)&&(n=f,f=null),o.loadJson(new o.DotProto.Parser(e).parse(),f,n)},o.protoFromString=o.loadProto,o.loadProtoFile=function(e,f,n){if(f&&"object"==typeof f?(n=f,f=null):f&&"function"==typeof f||(f=null),f)return o.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(d){if(null===d)return void f(Error("Failed to fetch file"));try{f(null,o.loadProto(d,n,e))}catch(i){f(i)}});var d=o.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===d?null:o.loadProto(d,n,e)},o.protoFromFile=o.loadProtoFile,o.newBuilder=function(e,f){var n=new o.Builder;return"undefined"!=typeof e&&null!==e&&n.define(e,f),n},o.loadJson=function(e,f,n){return("string"==typeof f||f&&"string"==typeof f.file&&"string"==typeof f.root)&&(n=f,f=null),f&&"object"==typeof f||(f=o.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),f["import"](e,n),f.resolveAll(),f.build(),f},o.loadJsonFile=function(e,f,n){if(f&&"object"==typeof f?(n=f,f=null):f&&"function"==typeof f||(f=null),f)return o.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(d){if(null===d)return void f(Error("Failed to fetch file"));try{f(null,o.loadJson(JSON.parse(d),n,e))}catch(i){f(i)}});var d=o.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===d?null:o.loadJson(JSON.parse(d),n,e)},o}"undefined"!=typeof o&&o.exports?o.exports=d(f("bytebuffer")):"function"==typeof e&&e.amd?e(["ByteBuffer"],d):(n.dcodeIO=n.dcodeIO||{}).ProtoBuf=d(n.dcodeIO.ByteBuffer)}(this)},{bytebuffer:19,fs:14,path:15}],18:[function(e,f){var o=e("./dist/ProtoBuf.js");f.exports=o},{"./dist/ProtoBuf.js":17}],19:[function(f,o){!function(n){function d(e){function f(e,n,d){if("undefined"==typeof e&&(e=f.DEFAULT_CAPACITY),"undefined"==typeof n&&(n=f.DEFAULT_ENDIAN),"undefined"==typeof d&&(d=f.DEFAULT_NOASSERT),!d){if(e|=0,0>e)throw new RangeError("Illegal capacity: 0 <= "+e);if("boolean"!=typeof n)throw new TypeError("Illegal littleEndian: Not a boolean");if("boolean"!=typeof d)throw new TypeError("Illegal noAssert: Not a boolean")}this.buffer=0===e?o:new ArrayBuffer(e),this.view=0===e?null:new DataView(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=e,this.littleEndian="undefined"!=typeof n?!!n:!1,this.noAssert=!!d}f.VERSION="3.1.0",f.LITTLE_ENDIAN=!0,f.BIG_ENDIAN=!1,f.DEFAULT_CAPACITY=16,f.DEFAULT_ENDIAN=f.BIG_ENDIAN,f.DEFAULT_NOASSERT=!1,f.Long=e||null;var o=new ArrayBuffer(0);f.allocate=function(e,o,n){return new f(e,o,n)},f.concat=function(e,o,n,d){("boolean"==typeof o||"string"!=typeof o)&&(d=n,n=o,o=void 0);for(var i,t=0,u=0,l=e.length;l>u;++u)f.isByteBuffer(e[u])||(e[u]=f.wrap(e[u],o)),i=e[u].limit-e[u].offset,i>0&&(t+=i);if(0===t)return new f(0,n,d);for(o=new f(t,n,d),d=new Uint8Array(o.buffer),u=0;l>u;)n=e[u++],i=n.limit-n.offset,0>=i||(d.set(new Uint8Array(n.buffer).subarray(n.offset,n.limit),o.offset),o.offset+=i);return o.limit=o.offset,o.offset=0,o},f.isByteBuffer=function(e){return e&&e instanceof f},f.type=function(){return ArrayBuffer},f.wrap=function(e,o,n,d){if("string"!=typeof o&&(d=n,n=o,o=void 0),"string"==typeof e)switch("undefined"==typeof o&&(o="utf8"),o){case"base64":return f.fromBase64(e,n);case"hex":return f.fromHex(e,n);case"binary":return f.fromBinary(e,n);case"utf8":return f.fromUTF8(e,n);case"debug":return f.fromDebug(e,n);default:throw new TypeError("Unsupported encoding: "+o)}if(null===e||"object"!=typeof e)throw new TypeError("Illegal buffer: null or non-object");if(f.isByteBuffer(e))return o=f.prototype.clone.call(e),o.markedOffset=-1,o;if(e instanceof Uint8Array)o=new f(0,n,d),0<e.length&&(o.buffer=e.buffer,o.offset=e.byteOffset,o.limit=e.byteOffset+e.length,o.view=0<e.length?new DataView(e.buffer):null);else if(e instanceof ArrayBuffer)o=new f(0,n,d),0<e.byteLength&&(o.buffer=e,o.offset=0,o.limit=e.byteLength,o.view=0<e.byteLength?new DataView(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Illegal buffer");for(o=new f(e.length,n,d),o.limit=e.length,i=0;i<e.length;++i)o.view.setUint8(i,e[i])}return o},f.prototype.writeInt8=function(e,f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+0) <= "+this.buffer.byteLength)}f+=1;var n=this.buffer.byteLength;return f>n&&this.resize((n*=2)>f?n:f),this.view.setInt8(f-1,e),o&&(this.offset+=1),this},f.prototype.writeByte=f.prototype.writeInt8,f.prototype.readInt8=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return e=this.view.getInt8(e),f&&(this.offset+=1),e},f.prototype.readByte=f.prototype.readInt8,f.prototype.writeUint8=function(e,f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+0) <= "+this.buffer.byteLength)}f+=1;var n=this.buffer.byteLength;return f>n&&this.resize((n*=2)>f?n:f),this.view.setUint8(f-1,e),o&&(this.offset+=1),this},f.prototype.readUint8=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return e=this.view.getUint8(e),f&&(this.offset+=1),e},f.prototype.writeInt16=function(e,f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+0) <= "+this.buffer.byteLength)}f+=2;var n=this.buffer.byteLength;return f>n&&this.resize((n*=2)>f?n:f),this.view.setInt16(f-2,e,this.littleEndian),o&&(this.offset+=2),this},f.prototype.writeShort=f.prototype.writeInt16,f.prototype.readInt16=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+2>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return e=this.view.getInt16(e,this.littleEndian),f&&(this.offset+=2),e},f.prototype.readShort=f.prototype.readInt16,f.prototype.writeUint16=function(e,f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+0) <= "+this.buffer.byteLength)}f+=2;var n=this.buffer.byteLength;return f>n&&this.resize((n*=2)>f?n:f),this.view.setUint16(f-2,e,this.littleEndian),o&&(this.offset+=2),this},f.prototype.readUint16=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+2>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return e=this.view.getUint16(e,this.littleEndian),f&&(this.offset+=2),e},f.prototype.writeInt32=function(e,f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+0) <= "+this.buffer.byteLength)}f+=4;var n=this.buffer.byteLength;return f>n&&this.resize((n*=2)>f?n:f),this.view.setInt32(f-4,e,this.littleEndian),o&&(this.offset+=4),this},f.prototype.writeInt=f.prototype.writeInt32,f.prototype.readInt32=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return e=this.view.getInt32(e,this.littleEndian),f&&(this.offset+=4),e},f.prototype.readInt=f.prototype.readInt32,f.prototype.writeUint32=function(e,f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+0) <= "+this.buffer.byteLength)}f+=4;var n=this.buffer.byteLength;return f>n&&this.resize((n*=2)>f?n:f),this.view.setUint32(f-4,e,this.littleEndian),o&&(this.offset+=4),this},f.prototype.readUint32=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return e=this.view.getUint32(e,this.littleEndian),f&&(this.offset+=4),e},e&&(f.prototype.writeInt64=function(f,o){var n="undefined"==typeof o;if(n&&(o=this.offset),!this.noAssert){if("number"==typeof f)f=e.fromNumber(f);else if(!(f&&f instanceof e))throw new TypeError("Illegal value: "+f+" (not an integer or Long)");if("number"!=typeof o||0!==o%1)throw new TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,0>o||o+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}"number"==typeof f&&(f=e.fromNumber(f)),o+=8;var d=this.buffer.byteLength;return o>d&&this.resize((d*=2)>o?d:o),o-=8,this.littleEndian?(this.view.setInt32(o,f.low,!0),this.view.setInt32(o+4,f.high,!0)):(this.view.setInt32(o,f.high,!1),this.view.setInt32(o+4,f.low,!1)),n&&(this.offset+=8),this},f.prototype.writeLong=f.prototype.writeInt64,f.prototype.readInt64=function(f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+8) <= "+this.buffer.byteLength)}return f=this.littleEndian?new e(this.view.getInt32(f,!0),this.view.getInt32(f+4,!0),!1):new e(this.view.getInt32(f+4,!1),this.view.getInt32(f,!1),!1),o&&(this.offset+=8),f},f.prototype.readLong=f.prototype.readInt64,f.prototype.writeUint64=function(f,o){var n="undefined"==typeof o;if(n&&(o=this.offset),!this.noAssert){if("number"==typeof f)f=e.fromNumber(f);else if(!(f&&f instanceof e))throw new TypeError("Illegal value: "+f+" (not an integer or Long)");if("number"!=typeof o||0!==o%1)throw new TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,0>o||o+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}"number"==typeof f&&(f=e.fromNumber(f)),o+=8;var d=this.buffer.byteLength;return o>d&&this.resize((d*=2)>o?d:o),o-=8,this.littleEndian?(this.view.setInt32(o,f.low,!0),this.view.setInt32(o+4,f.high,!0)):(this.view.setInt32(o,f.high,!1),this.view.setInt32(o+4,f.low,!1)),n&&(this.offset+=8),this},f.prototype.readUint64=function(f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+8) <= "+this.buffer.byteLength)}return f=this.littleEndian?new e(this.view.getInt32(f,!0),this.view.getInt32(f+4,!0),!0):new e(this.view.getInt32(f+4,!1),this.view.getInt32(f,!1),!0),o&&(this.offset+=8),f}),f.prototype.writeFloat32=function(e,f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof e)throw new TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+0) <= "+this.buffer.byteLength)}f+=4;var n=this.buffer.byteLength;return f>n&&this.resize((n*=2)>f?n:f),this.view.setFloat32(f-4,e,this.littleEndian),o&&(this.offset+=4),this},f.prototype.writeFloat=f.prototype.writeFloat32,f.prototype.readFloat32=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return e=this.view.getFloat32(e,this.littleEndian),f&&(this.offset+=4),e},f.prototype.readFloat=f.prototype.readFloat32,f.prototype.writeFloat64=function(e,f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof e)throw new TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+0) <= "+this.buffer.byteLength)}f+=8;var n=this.buffer.byteLength;return f>n&&this.resize((n*=2)>f?n:f),this.view.setFloat64(f-8,e,this.littleEndian),o&&(this.offset+=8),this},f.prototype.writeDouble=f.prototype.writeFloat64,f.prototype.readFloat64=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}return e=this.view.getFloat64(e,this.littleEndian),f&&(this.offset+=8),e},f.prototype.readDouble=f.prototype.readFloat64,f.MAX_VARINT32_BYTES=5,f.calculateVarint32=function(e){return e>>>=0,128>e?1:16384>e?2:2097152>e?3:268435456>e?4:5},f.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},f.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},f.prototype.writeVarint32=function(e,o){var n="undefined"==typeof o;if(n&&(o=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof o||0!==o%1)throw new TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,0>o||o+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}var d=f.calculateVarint32(e);o+=d;var i=this.buffer.byteLength;return o>i&&this.resize((i*=2)>o?i:o),o-=d,this.view.setUint8(o,d=128|e),e>>>=0,e>=128?(d=e>>7|128,this.view.setUint8(o+1,d),e>=16384?(d=e>>14|128,this.view.setUint8(o+2,d),e>=2097152?(d=e>>21|128,this.view.setUint8(o+3,d),e>=268435456?(this.view.setUint8(o+4,e>>28&15),d=5):(this.view.setUint8(o+3,127&d),d=4)):(this.view.setUint8(o+2,127&d),d=3)):(this.view.setUint8(o+1,127&d),d=2)):(this.view.setUint8(o,127&d),d=1),n?(this.offset+=d,this):d},f.prototype.writeVarint32ZigZag=function(e,o){return this.writeVarint32(f.zigZagEncode32(e),o)},f.prototype.readVarint32=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var o,n=0,d=0;do o=this.view.getUint8(e+n),5>n&&(d|=(127&o)<<7*n>>>0),++n;while(128===(128&o));return d|=0,f?(this.offset+=n,d):{value:d,length:n}},f.prototype.readVarint32ZigZag=function(e){return e=this.readVarint32(e),"object"==typeof e?e.value=f.zigZagDecode32(e.value):e=f.zigZagDecode32(e),e},e&&(f.MAX_VARINT64_BYTES=10,f.calculateVarint64=function(f){"number"==typeof f&&(f=e.fromNumber(f));var o=f.toInt()>>>0,n=f.shiftRightUnsigned(28).toInt()>>>0;return f=f.shiftRightUnsigned(56).toInt()>>>0,0==f?0==n?16384>o?128>o?1:2:2097152>o?3:4:16384>n?128>n?5:6:2097152>n?7:8:128>f?9:10},f.zigZagEncode64=function(f){return"number"==typeof f?f=e.fromNumber(f,!1):!1!==f.unsigned&&(f=f.toSigned()),f.shiftLeft(1).xor(f.shiftRight(63)).toUnsigned()},f.zigZagDecode64=function(f){return"number"==typeof f?f=e.fromNumber(f,!1):!1!==f.unsigned&&(f=f.toSigned()),f.shiftRightUnsigned(1).xor(f.and(e.ONE).toSigned().negate()).toSigned()},f.prototype.writeVarint64=function(o,n){var d="undefined"==typeof n;if(d&&(n=this.offset),!this.noAssert){if("number"==typeof o)o=e.fromNumber(o);else if(!(o&&o instanceof e))throw new TypeError("Illegal value: "+o+" (not an integer or Long)");if("number"!=typeof n||0!==n%1)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof o?o=e.fromNumber(o,!1):!1!==o.unsigned&&(o=o.toSigned());var i=f.calculateVarint64(o),t=o.toInt()>>>0,u=o.shiftRightUnsigned(28).toInt()>>>0,l=o.shiftRightUnsigned(56).toInt()>>>0;n+=i;var p=this.buffer.byteLength;switch(n>p&&this.resize((p*=2)>n?p:n),n-=i,i){case 10:this.view.setUint8(n+9,l>>>7&1);case 9:this.view.setUint8(n+8,9!==i?128|l:127&l);case 8:this.view.setUint8(n+7,8!==i?u>>>21|128:u>>>21&127);case 7:this.view.setUint8(n+6,7!==i?u>>>14|128:u>>>14&127);case 6:this.view.setUint8(n+5,6!==i?u>>>7|128:u>>>7&127);case 5:this.view.setUint8(n+4,5!==i?128|u:127&u);case 4:this.view.setUint8(n+3,4!==i?t>>>21|128:t>>>21&127);case 3:this.view.setUint8(n+2,3!==i?t>>>14|128:t>>>14&127);case 2:this.view.setUint8(n+1,2!==i?t>>>7|128:t>>>7&127);case 1:this.view.setUint8(n,1!==i?128|t:127&t)}return d?(this.offset+=i,this):i},f.prototype.writeVarint64ZigZag=function(e,o){return this.writeVarint64(f.zigZagEncode64(e),o)},f.prototype.readVarint64=function(f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+1) <= "+this.buffer.byteLength)}var n=f,d=0,i=0,t=0,u=0,u=this.view.getUint8(f++),d=127&u;if(128&u&&(u=this.view.getUint8(f++),d|=(127&u)<<7,128&u&&(u=this.view.getUint8(f++),d|=(127&u)<<14,128&u&&(u=this.view.getUint8(f++),d|=(127&u)<<21,128&u&&(u=this.view.getUint8(f++),i=127&u,128&u&&(u=this.view.getUint8(f++),i|=(127&u)<<7,128&u&&(u=this.view.getUint8(f++),i|=(127&u)<<14,128&u&&(u=this.view.getUint8(f++),i|=(127&u)<<21,128&u&&(u=this.view.getUint8(f++),t=127&u,128&u&&(u=this.view.getUint8(f++),t|=(127&u)<<7,128&u))))))))))throw Error("Data must be corrupt: Buffer overrun");return d=e.from28Bits(d,i,t,!1),o?(this.offset=f,d):{value:d,length:f-n}},f.prototype.readVarint64ZigZag=function(o){return(o=this.readVarint64(o))&&o.value instanceof e?o.value=f.zigZagDecode64(o.value):o=f.zigZagDecode64(o),o}),f.prototype.writeCString=function(e,f){var o="undefined"==typeof f;o&&(f=this.offset);var n,i=e.length;if(!this.noAssert){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");for(n=0;i>n;++n)if(0===e.charCodeAt(n))throw new RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+0) <= "+this.buffer.byteLength)}n=f,i=d.b(d.a(e))[1],f+=i+1;var t=this.buffer.byteLength;return f>t&&this.resize((t*=2)>f?t:f),f-=i+1,d.e(d.a(e),function(e){this.view.setUint8(f++,e)}.bind(this)),this.view.setUint8(f++,0),o?(this.offset=f-n,this):i},f.prototype.readCString=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var o,n=e,i=-1;return d.d(function(){if(0===i)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(i=this.view.getUint8(e++))?null:i}.bind(this),o=d.c(),!0),f?(this.offset=e,o()):{string:o(),length:e-n}},f.prototype.writeIString=function(e,f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if("number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+0) <= "+this.buffer.byteLength)}var n,i=f;n=d.b(d.a(e),this.noAssert)[1],f+=4+n;var t=this.buffer.byteLength;if(f>t&&this.resize((t*=2)>f?t:f),f-=4+n,this.view.setUint32(f,n,this.littleEndian),f+=4,d.e(d.a(e),function(e){this.view.setUint8(f++,e)}.bind(this)),f!==i+4+n)throw new RangeError("Illegal range: Truncated data, "+f+" == "+(f+4+n));return o?(this.offset=f,this):f-i},f.prototype.readIString=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var o=0,n=e,o=this.view.getUint32(e,this.littleEndian);e+=4;var i=e+o;return d.d(function(){return i>e?this.view.getUint8(e++):null}.bind(this),o=d.c(),this.noAssert),o=o(),f?(this.offset=e,o):{string:o,length:e-n}},f.METRICS_CHARS="c",f.METRICS_BYTES="b",f.prototype.writeUTF8String=function(e,f){var o="undefined"==typeof f;if(o&&(f=this.offset),!this.noAssert){if("number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: "+f+" (not an integer)");if(f>>>=0,0>f||f+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+f+" (+0) <= "+this.buffer.byteLength)}var n,i=f;n=d.b(d.a(e))[1],f+=n;var t=this.buffer.byteLength;return f>t&&this.resize((t*=2)>f?t:f),f-=n,d.e(d.a(e),function(e){this.view.setUint8(f++,e)}.bind(this)),o?(this.offset=f,this):f-i},f.prototype.writeString=f.prototype.writeUTF8String,f.calculateUTF8Chars=function(e){return d.b(d.a(e))[0]},f.calculateUTF8Bytes=function(e){return d.b(d.a(e))[1]},f.prototype.readUTF8String=function(e,o,n){"number"==typeof o&&(n=o,o=void 0);var i="undefined"==typeof n;if(i&&(n=this.offset),"undefined"==typeof o&&(o=f.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof n||0!==n%1)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var t,u=0,l=n;if(o===f.METRICS_CHARS){if(t=d.c(),d.i(function(){return e>u&&n<this.limit?this.view.getUint8(n++):null}.bind(this),function(e){++u,d.g(e,t)}.bind(this)),u!==e)throw new RangeError("Illegal range: Truncated data, "+u+" == "+e);return i?(this.offset=n,t()):{string:t(),length:n-l}}if(o===f.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof n||0!==n%1)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+e>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+"+e+") <= "+this.buffer.byteLength)}var p=n+e;if(d.d(function(){return p>n?this.view.getUint8(n++):null}.bind(this),t=d.c(),this.noAssert),n!==p)throw new RangeError("Illegal range: Truncated data, "+n+" == "+p);return i?(this.offset=n,t()):{string:t(),length:n-l}}throw new TypeError("Unsupported metrics: "+o)},f.prototype.readString=f.prototype.readUTF8String,f.prototype.writeVString=function(e,o){var n="undefined"==typeof o;if(n&&(o=this.offset),!this.noAssert){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if("number"!=typeof o||0!==o%1)throw new TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,0>o||o+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}var i,t,u=o;i=d.b(d.a(e),this.noAssert)[1],t=f.calculateVarint32(i),o+=t+i;var l=this.buffer.byteLength;if(o>l&&this.resize((l*=2)>o?l:o),o-=t+i,o+=this.writeVarint32(i,o),d.e(d.a(e),function(e){this.view.setUint8(o++,e)}.bind(this)),o!==u+i+t)throw new RangeError("Illegal range: Truncated data, "+o+" == "+(o+i+t));return n?(this.offset=o,this):o-u},f.prototype.readVString=function(e){var f="undefined"==typeof e;if(f&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var o=this.readVarint32(e),n=e;e+=o.length;var o=o.value,i=e+o,o=d.c();return d.d(function(){return i>e?this.view.getUint8(e++):null}.bind(this),o,this.noAssert),o=o(),f?(this.offset=e,o):{string:o,length:e-n}},f.prototype.append=function(e,o,n){("number"==typeof o||"string"!=typeof o)&&(n=o,o=void 0);var d="undefined"==typeof n;if(d&&(n=this.offset),!this.noAssert){if("number"!=typeof n||0!==n%1)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(e instanceof f||(e=f.wrap(e,o)),o=e.limit-e.offset,0>=o)return this;n+=o;var i=this.buffer.byteLength;return n>i&&this.resize((i*=2)>n?i:n),new Uint8Array(this.buffer,n-o).set(new Uint8Array(e.buffer).subarray(e.offset,e.limit)),e.offset+=o,d&&(this.offset+=o),this},f.prototype.appendTo=function(e,f){return e.append(this,f),this},f.prototype.assert=function(e){return this.noAssert=!e,this},f.prototype.capacity=function(){return this.buffer.byteLength},f.prototype.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},f.prototype.clone=function(e){var o=new f(0,this.littleEndian,this.noAssert);return e?(e=new ArrayBuffer(this.buffer.byteLength),new Uint8Array(e).set(this.buffer),o.buffer=e,o.view=new DataView(e)):(o.buffer=this.buffer,o.view=this.view),o.offset=this.offset,o.markedOffset=this.markedOffset,o.limit=this.limit,o},f.prototype.compact=function(e,f){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof f&&(f=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal end: Not an integer");if(f>>>=0,0>e||e>f||f>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+f+" <= "+this.buffer.byteLength)}if(0===e&&f===this.buffer.byteLength)return this;var n=f-e;if(0===n)return this.buffer=o,this.view=null,0<=this.markedOffset&&(this.markedOffset-=e),this.limit=this.offset=0,this;var d=new ArrayBuffer(n);return new Uint8Array(d).set(new Uint8Array(this.buffer).subarray(e,f)),this.buffer=d,this.view=new DataView(d),0<=this.markedOffset&&(this.markedOffset-=e),this.offset=0,this.limit=n,this},f.prototype.copy=function(e,o){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof o&&(o=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");
if(e>>>=0,"number"!=typeof o||0!==o%1)throw new TypeError("Illegal end: Not an integer");if(o>>>=0,0>e||e>o||o>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+o+" <= "+this.buffer.byteLength)}if(e===o)return new f(0,this.littleEndian,this.noAssert);var n=o-e,d=new f(n,this.littleEndian,this.noAssert);return d.offset=0,d.limit=n,0<=d.markedOffset&&(d.markedOffset-=e),this.copyTo(d,0,e,o),d},f.prototype.copyTo=function(e,o,n,d){var i,t;if(!this.noAssert&&!f.isByteBuffer(e))throw new TypeError("Illegal target: Not a ByteBuffer");if(o=(t="undefined"==typeof o)?e.offset:0|o,n=(i="undefined"==typeof n)?this.offset:0|n,d="undefined"==typeof d?this.limit:0|d,0>o||o>e.buffer.byteLength)throw new RangeError("Illegal target range: 0 <= "+o+" <= "+e.buffer.byteLength);if(0>n||d>this.buffer.byteLength)throw new RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);var u=d-n;return 0===u?e:(e.ensureCapacity(o+u),new Uint8Array(e.buffer).set(new Uint8Array(this.buffer).subarray(n,d),o),i&&(this.offset+=u),t&&(e.offset+=u),this)},f.prototype.ensureCapacity=function(e){var f=this.buffer.byteLength;return e>f?this.resize((f*=2)>e?f:e):this},f.prototype.fill=function(e,f,o){var n="undefined"==typeof f;if(n&&(f=this.offset),"string"==typeof e&&0<e.length&&(e=e.charCodeAt(0)),"undefined"==typeof f&&(f=this.offset),"undefined"==typeof o&&(o=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal begin: Not an integer");if(f>>>=0,"number"!=typeof o||0!==o%1)throw new TypeError("Illegal end: Not an integer");if(o>>>=0,0>f||f>o||o>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+f+" <= "+o+" <= "+this.buffer.byteLength)}if(f>=o)return this;for(;o>f;)this.view.setUint8(f++,e);return n&&(this.offset=f),this},f.prototype.flip=function(){return this.limit=this.offset,this.offset=0,this},f.prototype.mark=function(e){if(e="undefined"==typeof e?this.offset:e,!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},f.prototype.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw new TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},f.prototype.LE=function(e){return this.littleEndian="undefined"!=typeof e?!!e:!0,this},f.prototype.BE=function(e){return this.littleEndian="undefined"!=typeof e?!e:!1,this},f.prototype.prepend=function(e,o,n){("number"==typeof o||"string"!=typeof o)&&(n=o,o=void 0);var d="undefined"==typeof n;if(d&&(n=this.offset),!this.noAssert){if("number"!=typeof n||0!==n%1)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(e instanceof f||(e=f.wrap(e,o)),o=e.limit-e.offset,0>=o)return this;var i,t=o-n;if(t>0){var u=new ArrayBuffer(this.buffer.byteLength+t);i=new Uint8Array(u),i.set(new Uint8Array(this.buffer).subarray(n,this.buffer.byteLength),o),this.buffer=u,this.view=new DataView(u),this.offset+=t,0<=this.markedOffset&&(this.markedOffset+=t),this.limit+=t,n+=t}else i=new Uint8Array(this.buffer);return i.set(new Uint8Array(e.buffer).subarray(e.offset,e.limit),n-o),e.offset=e.limit,d&&(this.offset-=o),this},f.prototype.prependTo=function(e,f){return e.prepend(this,f),this},f.prototype.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},f.prototype.remaining=function(){return this.limit-this.offset},f.prototype.reset=function(){return 0<=this.markedOffset?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},f.prototype.resize=function(e){if(!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal capacity: "+e+" (not an integer)");if(e|=0,0>e)throw new RangeError("Illegal capacity: 0 <= "+e)}return this.buffer.byteLength<e&&(e=new ArrayBuffer(e),new Uint8Array(e).set(new Uint8Array(this.buffer)),this.buffer=e,this.view=new DataView(e)),this},f.prototype.reverse=function(e,f){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof f&&(f=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal end: Not an integer");if(f>>>=0,0>e||e>f||f>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+f+" <= "+this.buffer.byteLength)}return e===f?this:(Array.prototype.reverse.call(new Uint8Array(this.buffer).subarray(e,f)),this.view=new DataView(this.buffer),this)},f.prototype.skip=function(e){if(!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal length: "+e+" (not an integer)");e|=0}var f=this.offset+e;if(!this.noAssert&&(0>f||f>this.buffer.byteLength))throw new RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=f,this},f.prototype.slice=function(e,f){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof f&&(f=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal end: Not an integer");if(f>>>=0,0>e||e>f||f>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+f+" <= "+this.buffer.byteLength)}var o=this.clone();return o.offset=e,o.limit=f,o},f.prototype.toBuffer=function(e){var f=this.offset,n=this.limit;if(f>n)var d=f,f=n,n=d;if(!this.noAssert){if("number"!=typeof f||0!==f%1)throw new TypeError("Illegal offset: Not an integer");if(f>>>=0,"number"!=typeof n||0!==n%1)throw new TypeError("Illegal limit: Not an integer");if(n>>>=0,0>f||f>n||n>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+f+" <= "+n+" <= "+this.buffer.byteLength)}return e||0!==f||n!==this.buffer.byteLength?f===n?o:(e=new ArrayBuffer(n-f),new Uint8Array(e).set(new Uint8Array(this.buffer).subarray(f,n),0),e):this.buffer},f.prototype.toArrayBuffer=f.prototype.toBuffer,f.prototype.toString=function(e){if("undefined"==typeof e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch(e){case"utf8":return this.toUTF8();case"base64":return this.toBase64();case"hex":return this.toHex();case"binary":return this.toBinary();case"debug":return this.toDebug();case"columns":return this.o();default:throw Error("Unsupported encoding: "+e)}};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=n+"";f.prototype.toBase64=function(e,f){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof f&&(f=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal end: Not an integer");if(f>>>=0,0>e||e>f||f>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+f+" <= "+this.buffer.byteLength)}if(e===f)return"";for(var o,d,i,t,u,l,p="";f>e;)o=this.view.getUint8(e++),d=(t=f>e)?this.view.getUint8(e++):0,i=(u=f>e)?this.view.getUint8(e++):0,l=o>>2,o=(3&o)<<4|d>>4,d=(15&d)<<2|i>>6,i&=63,u||(i=64,t||(d=64)),p+=n.charAt(l)+n.charAt(o)+n.charAt(d)+n.charAt(i);return p},f.fromBase64=function(e,o,d){if(!d){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if(0!==e.length%4)throw new TypeError("Illegal str: Length not a multiple of 4")}var i,t=e.length,u=0;for(i=e.length-1;i>=0&&"="===e.charAt(i);--i)u++;if(u>2)throw new TypeError("Illegal str: Suffix is too large");if(0===t)return new f(0,o,d);var l,p,s,y=new f(t/4*3-u,o,d);for(o=i=0;t>i;){if(u=n.indexOf(e.charAt(i++)),l=t>i?n.indexOf(e.charAt(i++)):0,p=t>i?n.indexOf(e.charAt(i++)):0,s=t>i?n.indexOf(e.charAt(i++)):0,!d&&(0>u||0>l||0>p||0>s))throw new TypeError("Illegal str: Contains non-base64 characters");y.view.setUint8(o++,u<<2|l>>4),64!==p&&(y.view.setUint8(o++,l<<4&240|p>>2,o),64!==s&&y.view.setUint8(o++,p<<6&192|s))}return y.limit=o,y},f.btoa=function(e){return f.fromBinary(e).toBase64()},f.atob=function(e){return f.fromBase64(e).toBinary()},f.prototype.toBinary=function(e,f){if(e="undefined"==typeof e?this.offset:e,f="undefined"==typeof f?this.limit:f,!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal end: Not an integer");if(f>>>=0,0>e||e>f||f>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+f+" <= "+this.buffer.byteLength)}if(e===f)return"";for(var o=[];f>e;)o.push(this.view.getUint8(e++));return String.fromCharCode.apply(String,o)},f.fromBinary=function(e,o,n){if(!n&&"string"!=typeof e)throw new TypeError("Illegal str: Not a string");for(var d=0,i=e.length,t=new f(i,o,n);i>d;){if(o=e.charCodeAt(d),!n&&o>255)throw new TypeError("Illegal charCode at "+d+": 0 <= "+o+" <= 255");t.view.setUint8(d++,o)}return t.limit=i,t},f.prototype.toDebug=function(e){for(var f,o=-1,n=this.buffer.byteLength,d="",i="",t="";n>o;){if(-1!==o&&(f=this.view.getUint8(o),d=16>f?d+("0"+f.toString(16).toUpperCase()):d+f.toString(16).toUpperCase(),e&&(i+=f>32&&127>f?String.fromCharCode(f):".")),++o,e&&o>0&&0===o%16&&o!==n){for(;51>d.length;)d+=" ";t+=d+i+"\n",d=i=""}d=o===this.offset&&o===this.limit?d+(o===this.markedOffset?"!":"|"):o===this.offset?d+(o===this.markedOffset?"[":"<"):o===this.limit?d+(o===this.markedOffset?"]":">"):d+(o===this.markedOffset?"'":e||0!==o&&o!==n?" ":"")}if(e&&" "!==d){for(;51>d.length;)d+=" ";t+=d+i+"\n"}return e?t:d},f.fromDebug=function(e,o,n){var d=e.length;o=new f((d+1)/3|0,o,n);for(var i,t=0,u=0,l=!1,p=!1,s=!1,y=!1,c=!1;d>t;){switch(i=e.charAt(t++)){case"!":if(!n){if(p||s||y){c=!0;break}p=s=y=!0}o.offset=o.markedOffset=o.limit=u,l=!1;break;case"|":if(!n){if(p||y){c=!0;break}p=y=!0}o.offset=o.limit=u,l=!1;break;case"[":if(!n){if(p||s){c=!0;break}p=s=!0}o.offset=o.markedOffset=u,l=!1;break;case"<":if(!n){if(p){c=!0;break}p=!0}o.offset=u,l=!1;break;case"]":if(!n){if(y||s){c=!0;break}y=s=!0}o.limit=o.markedOffset=u,l=!1;break;case">":if(!n){if(y){c=!0;break}y=!0}o.limit=u,l=!1;break;case"'":if(!n){if(s){c=!0;break}s=!0}o.markedOffset=u,l=!1;break;case" ":l=!1;break;default:if(!n&&l){c=!0;break}if(i=parseInt(i+e.charAt(t++),16),!n&&(isNaN(i)||0>i||i>255))throw new TypeError("Illegal str: Not a debug encoded string");o.view.setUint8(u++,i),l=!0}if(c)throw new TypeError("Illegal str: Invalid symbol at "+t)}if(!n){if(!p||!y)throw new TypeError("Illegal str: Missing offset or limit");if(u<o.buffer.byteLength)throw new TypeError("Illegal str: Not a debug encoded string (is it hex?) "+u+" < "+d)}return o},f.prototype.toHex=function(e,f){if(e="undefined"==typeof e?this.offset:e,f="undefined"==typeof f?this.limit:f,!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal end: Not an integer");if(f>>>=0,0>e||e>f||f>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+f+" <= "+this.buffer.byteLength)}for(var o,n=Array(f-e);f>e;)o=this.view.getUint8(e++),16>o?n.push("0",o.toString(16)):n.push(o.toString(16));return n.join("")},f.fromHex=function(e,o,n){if(!n){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if(0!==e.length%2)throw new TypeError("Illegal str: Length not a multiple of 2")}var d=e.length;o=new f(d/2|0,o);for(var i,t=0,u=0;d>t;t+=2){if(i=parseInt(e.substring(t,t+2),16),!n&&(!isFinite(i)||0>i||i>255))throw new TypeError("Illegal str: Contains non-hex characters");o.view.setUint8(u++,i)}return o.limit=u,o};var d=function(){var e={j:function(e,f){var o=null;for("number"==typeof e&&(o=e,e=function(){return null});null!==o||null!==(o=e());)128>o?f(127&o):(2048>o?f(o>>6&31|192):(65536>o?f(o>>12&15|224):(f(o>>18&7|240),f(o>>12&63|128)),f(o>>6&63|128)),f(63&o|128)),o=null},i:function(e,f){function o(e){e=e.slice(0,e.indexOf(null));var f=Error(e.toString());throw f.name="TruncatedError",f.bytes=e,f}for(var n,d,i,t;null!==(n=e());)if(0===(128&n))f(n);else if(192===(224&n))null===(d=e())&&o([n,d]),f((31&n)<<6|63&d);else if(224===(240&n))null!==(d=e())&&null!==(i=e())||o([n,d,i]),f((15&n)<<12|(63&d)<<6|63&i);else{if(240!==(248&n))throw RangeError("Illegal starting byte: "+n);null!==(d=e())&&null!==(i=e())&&null!==(t=e())||o([n,d,i,t]),f((7&n)<<18|(63&d)<<12|(63&i)<<6|63&t)}},f:function(e,f){for(var o,n=null;null!==(o=null!==n?n:e());)o>=55296&&57343>=o&&null!==(n=e())&&n>=56320&&57343>=n?(f(1024*(o-55296)+n-56320+65536),n=null):f(o);null!==n&&f(n)},g:function(e,f){var o=null;for("number"==typeof e&&(o=e,e=function(){return null});null!==o||null!==(o=e());)65535>=o?f(o):(o-=65536,f((o>>10)+55296),f(o%1024+56320)),o=null},e:function(f,o){e.f(f,function(f){e.j(f,o)})},d:function(f,o){e.i(f,function(f){e.g(f,o)})},k:function(e){if("number"!=typeof e||e!==e)throw TypeError("Illegal byte: "+typeof e);if(-128>e||e>255)throw RangeError("Illegal byte: "+e);return e},l:function(e){if("number"!=typeof e||e!==e)throw TypeError("Illegal char code: "+typeof e);if(0>e||e>65535)throw RangeError("Illegal char code: "+e);return e},m:function(e){if("number"!=typeof e||e!==e)throw TypeError("Illegal code point: "+typeof e);if(0>e||e>1114111)throw RangeError("Illegal code point: "+e);return e},h:function(e){return 128>e?1:2048>e?2:65536>e?3:4},n:function(f){for(var o,n=0;null!==(o=f());)n+=e.h(o);return n},b:function(f){var o=0,n=0;return e.f(f,function(f){++o,n+=e.h(f)}),[o,n]}};return e}(),t=String.fromCharCode;return d.a=function(e){var f=0;return function(){return f<e.length?e.charCodeAt(f++):null}},d.c=function(){var e=[],f=[];return function(){return 0===arguments.length?f.join("")+t.apply(String,e):(1024<e.length+arguments.length&&(f.push(t.apply(String,e)),e.length=0),void Array.prototype.push.apply(e,arguments))}},f.prototype.toUTF8=function(e,f){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof f&&(f=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof f||0!==f%1)throw new TypeError("Illegal end: Not an integer");if(f>>>=0,0>e||e>f||f>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+f+" <= "+this.buffer.byteLength)}var o,n=this;try{d.d(function(){return f>e?n.view.getUint8(e++):null},o=d.c())}catch(i){if(e!==f)throw new RangeError("Illegal range: Truncated data, "+e+" != "+f)}return o()},f.fromUTF8=function(e,o,n){if(!n&&"string"!=typeof e)throw new TypeError("Illegal str: Not a string");var i=new f(d.b(d.a(e),!0)[1],o,n),t=0;return d.e(d.a(e),function(e){i.view.setUint8(t++,e)}),i.limit=t,i},f}"undefined"!=typeof o&&o.exports?o.exports=d(f("long")):"undefined"!=typeof e&&e.amd?e("ByteBuffer",["Math/Long"],function(e){return d(e)}):(n.dcodeIO||(n.dcodeIO={}),n.dcodeIO.ByteBuffer=d(n.dcodeIO.Long))}(this)},{"long":21}],20:[function(f,o){!function(f){"use strict";var n=function(e,f,o){e&&"object"==typeof e&&(f=e.high,o=e.unsigned,e=e.low),this.low=0|e,this.high=0|f,this.unsigned=!!o},d={},i={};n.fromInt=function(e,f){var o,t;return f?(e>>>=0,e>=0&&256>e&&(t=i[e])?t:(o=new n(e,0>(0|e)?-1:0,!0),e>=0&&256>e&&(i[e]=o),o)):(e=0|e,e>=-128&&128>e&&(t=d[e])?t:(o=new n(e,0>e?-1:0,!1),e>=-128&&128>e&&(d[e]=o),o))},n.fromNumber=function(e,f){return f=!!f,isNaN(e)||!isFinite(e)?n.ZERO:!f&&-p>=e?n.MIN_SIGNED_VALUE:f&&0>=e?n.MIN_UNSIGNED_VALUE:!f&&e+1>=p?n.MAX_SIGNED_VALUE:f&&e>=l?n.MAX_UNSIGNED_VALUE:0>e?n.fromNumber(-e,!1).negate():new n(e%u|0,e/u|0,f)},n.fromBits=function(e,f,o){return new n(e,f,o)},n.from28Bits=function(e,f,o,d){return n.fromBits(e|f<<28,f>>>4|o<<24,d)},n.fromString=function(e,f,o){if(0==e.length)throw new Error("number format error: empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return n.ZERO;if("number"==typeof f&&(o=f,f=!1),o=o||10,2>o||o>36)throw new Error("radix out of range: "+o);if("-"==e.charAt(0))return n.fromString(e.substring(1),f,o).negate();if(e.indexOf("-")>=0)throw new Error('number format error: interior "-" character: '+e);for(var d=n.fromNumber(Math.pow(o,8)),i=n.ZERO,t=0;t<e.length;t+=8){var u=Math.min(8,e.length-t),l=parseInt(e.substring(t,t+u),o);if(8>u){var p=n.fromNumber(Math.pow(o,u));i=i.multiply(p).add(n.fromNumber(l))}else i=i.multiply(d),i=i.add(n.fromNumber(l))}return i.unsigned=f,i};var t=65536,u=t*t,l=u*u,p=l/2,s=n.fromInt(1<<24);n.ZERO=n.fromInt(0),n.UZERO=n.fromInt(0,!0),n.ONE=n.fromInt(1),n.UONE=n.fromInt(1,!0),n.NEG_ONE=n.fromInt(-1),n.MAX_SIGNED_VALUE=n.fromBits(-1,2147483647,!1),n.MAX_UNSIGNED_VALUE=n.fromBits(-1,-1,!0),n.MAX_VALUE=n.MAX_SIGNED_VALUE,n.MIN_SIGNED_VALUE=n.fromBits(0,-2147483648,!1),n.MIN_UNSIGNED_VALUE=n.fromBits(0,0,!0),n.MIN_VALUE=n.MIN_SIGNED_VALUE,n.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},n.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*u+(this.low>>>0):this.high*u+(this.low>>>0)},n.prototype.toString=function(e){if(e=e||10,2>e||e>36)throw new Error("radix out of range: "+e);if(this.isZero())return"0";var f;if(this.isNegative()){if(this.equals(n.MIN_SIGNED_VALUE)){var o=n.fromNumber(e),d=this.div(o);return f=d.multiply(o).subtract(this),d.toString(e)+f.toInt().toString(e)}return"-"+this.negate().toString(e)}var i=n.fromNumber(Math.pow(e,6));f=this;for(var t="";;){var u=f.div(i),l=f.subtract(u.multiply(i)).toInt(),p=l.toString(e);if(f=u,f.isZero())return p+t;for(;p.length<6;)p="0"+p;t=""+p+t}},n.prototype.getHighBits=function(){return this.high},n.prototype.getHighBitsUnsigned=function(){return this.high>>>0},n.prototype.getLowBits=function(){return this.low},n.prototype.getLowBitsUnsigned=function(){return this.low>>>0},n.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(n.MIN_SIGNED_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,f=31;f>0&&0==(e&1<<f);f--);return 0!=this.high?f+33:f+1},n.prototype.isZero=function(){return 0==this.high&&0==this.low},n.prototype.isNegative=function(){return!this.unsigned&&this.high<0},n.prototype.isOdd=function(){return 1==(1&this.low)},n.prototype.isEven=function(){return 0==(1&this.low)},n.prototype.equals=function(e){return this.unsigned!=e.unsigned&&this.high>>>31!=e.high>>>31?!1:this.high==e.high&&this.low==e.low},n.prototype.notEquals=function(e){return!this.equals(e)},n.prototype.lessThan=function(e){return this.compare(e)<0},n.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},n.prototype.greaterThan=function(e){return this.compare(e)>0},n.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},n.prototype.compare=function(e){if(this.equals(e))return 0;var f=this.isNegative(),o=e.isNegative();return f&&!o?-1:!f&&o?1:this.unsigned?e.high>>>0>this.high>>>0||e.high==this.high&&e.low>>>0>this.low>>>0?-1:1:this.subtract(e).isNegative()?-1:1},n.prototype.negate=function(){return!this.unsigned&&this.equals(n.MIN_SIGNED_VALUE)?n.MIN_SIGNED_VALUE:this.not().add(n.ONE)},n.prototype.add=function(e){var f=this.high>>>16,o=65535&this.high,d=this.low>>>16,i=65535&this.low,t=e.high>>>16,u=65535&e.high,l=e.low>>>16,p=65535&e.low,s=0,y=0,c=0,r=0;return r+=i+p,c+=r>>>16,r&=65535,c+=d+l,y+=c>>>16,c&=65535,y+=o+u,s+=y>>>16,y&=65535,s+=f+t,s&=65535,n.fromBits(c<<16|r,s<<16|y,this.unsigned)},n.prototype.subtract=function(e){return this.add(e.negate())},n.prototype.multiply=function(e){if(this.isZero())return n.ZERO;if(e.isZero())return n.ZERO;if(this.equals(n.MIN_VALUE))return e.isOdd()?n.MIN_VALUE:n.ZERO;if(e.equals(n.MIN_VALUE))return this.isOdd()?n.MIN_VALUE:n.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(s)&&e.lessThan(s))return n.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var f=this.high>>>16,o=65535&this.high,d=this.low>>>16,i=65535&this.low,t=e.high>>>16,u=65535&e.high,l=e.low>>>16,p=65535&e.low,y=0,c=0,r=0,a=0;return a+=i*p,r+=a>>>16,a&=65535,r+=d*p,c+=r>>>16,r&=65535,r+=i*l,c+=r>>>16,r&=65535,c+=o*p,y+=c>>>16,c&=65535,c+=d*l,y+=c>>>16,c&=65535,c+=i*u,y+=c>>>16,c&=65535,y+=f*p+o*l+d*u+i*t,y&=65535,n.fromBits(r<<16|a,y<<16|c,this.unsigned)},n.prototype.div=function(e){if(e.isZero())throw new Error("division by zero");if(this.isZero())return this.unsigned?n.UZERO:n.ZERO;var f,o,d;if(this.equals(n.MIN_SIGNED_VALUE)){if(e.equals(n.ONE)||e.equals(n.NEG_ONE))return n.MIN_SIGNED_VALUE;if(e.equals(n.MIN_SIGNED_VALUE))return n.ONE;var i=this.shiftRight(1);return f=i.div(e).shiftLeft(1),f.equals(n.ZERO)?e.isNegative()?n.ONE:n.NEG_ONE:(o=this.subtract(e.multiply(f)),d=f.add(o.div(e)))}if(e.equals(n.MIN_SIGNED_VALUE))return this.unsigned?n.UZERO:n.ZERO;if(this.isNegative())return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate();if(e.isNegative())return this.div(e.negate()).negate();for(d=n.ZERO,o=this;o.greaterThanOrEqual(e);){f=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var t=Math.ceil(Math.log(f)/Math.LN2),u=48>=t?1:Math.pow(2,t-48),l=n.fromNumber(f,this.unsigned),p=l.multiply(e);p.isNegative()||p.greaterThan(o);)f-=u,l=n.fromNumber(f,this.unsigned),p=l.multiply(e);l.isZero()&&(l=n.ONE),d=d.add(l),o=o.subtract(p)}return d},n.prototype.modulo=function(e){return this.subtract(this.div(e).multiply(e))},n.prototype.not=function(){return n.fromBits(~this.low,~this.high,this.unsigned)},n.prototype.and=function(e){return n.fromBits(this.low&e.low,this.high&e.high,this.unsigned)},n.prototype.or=function(e){return n.fromBits(this.low|e.low,this.high|e.high,this.unsigned)},n.prototype.xor=function(e){return n.fromBits(this.low^e.low,this.high^e.high,this.unsigned)},n.prototype.shiftLeft=function(e){if(e&=63,0==e)return this;var f=this.low;if(32>e){var o=this.high;return n.fromBits(f<<e,o<<e|f>>>32-e,this.unsigned)}return n.fromBits(0,f<<e-32,this.unsigned)},n.prototype.shiftRight=function(e){if(e&=63,0==e)return this;var f=this.high;if(32>e){var o=this.low;return n.fromBits(o>>>e|f<<32-e,f>>e,this.unsigned)}return n.fromBits(f>>e-32,f>=0?0:-1,this.unsigned)},n.prototype.shiftRightUnsigned=function(e){if(e&=63,0==e)return this;var f=this.high;if(32>e){var o=this.low;return n.fromBits(o>>>e|f<<32-e,f>>>e,this.unsigned)}return 32==e?n.fromBits(f,0,this.unsigned):n.fromBits(f>>>e-32,0,this.unsigned)},n.prototype.toSigned=function(){var e=this.clone();return e.unsigned=!1,e},n.prototype.toUnsigned=function(){var e=this.clone();return e.unsigned=!0,e},n.prototype.clone=function(){return new n(this.low,this.high,this.unsigned)},"undefined"!=typeof o&&o.exports?o.exports=n:"undefined"!=typeof e&&e.amd?e("Math/Long",[],function(){return n}):(f.dcodeIO||(f.dcodeIO={}),f.dcodeIO.Long=n)}(this)},{}],21:[function(e,f){f.exports=e("./dist/Long.js")},{"./dist/Long.js":20}]},{},[6])(6)});